DESCRIPTION

MB-18448 Allow changing memcached parameters globally.

This changes ns_ports_setup:memcached_config logic to look more like
the one that we have in 4.*. Specifically, memcached parameters
can be changed both on a per node level ({node, node(), memcached}
key) and globally (memcached key). In addition, our default values go
into {node, node(), memcached_defaults}. This allows us to upgrade
defaults without overriding user-set values.

The change requires introducing new config version. Which means that
offline upgrading to 4.0 and 4.1.0 is not possible. Online upgrade
will work, but the changes will be lost.

Change-Id: I75e91aed7f37a478fa03055252ae4735e22a9fa8


COMMENTS

author: Meghan Vazquez
date: 2016-03-04 07:28:02.079000000

Uploaded patch set 1.

-------------------------------------
author: Hugo Blankenship
date: 2016-03-04 07:28:10.362000000

Patch Set 1: Well-Formed+1

Permission granted to commit: 

http://server.jenkins.couchbase.com/job/restricted-branch-check/7639/artifact/restricted.html : SUCCESS

-------------------------------------
author: Meghan Vazquez
date: 2016-03-04 07:28:21.917000000

Patch Set 1: Verified+1

-------------------------------------
author: Kian Santos
date: 2016-03-04 21:53:11.394000000

Patch Set 1:

(1 comment)

One question.

Line:270, src/ns_ports_setup.erl -> There is no duplicate config option removal here like there is in the 4.x line. But I imagine that's just fine since we don't expect much if any use of this global option setting capability in 3.x (since the feature is only accessible via diag/eval)?

-------------------------------------
author: Meghan Vazquez
date: 2016-03-04 21:56:50.630000000

Patch Set 1:

(1 comment)

Line:270, src/ns_ports_setup.erl -> Actually there's no such thing in 4.x too. These list is just used to get values for the parameters. The one that is found first naturally wins.

-------------------------------------
author: Ella Beltran
date: 2016-03-04 23:02:44.766000000

Patch Set 1: Code-Review+2

I have still bit of nagging feeling about upgrades but I cannot find any issues
so +2.

-------------------------------------
author: Kian Santos
date: 2016-03-04 23:24:05.067000000

Patch Set 1: Code-Review+2

-------------------------------------
author: Kian Santos
date: 2016-03-04 23:51:00.940000000

Patch Set 1: Verified+1

-------------------------------------
author: Roselyn Villegas Code Review
date: 2016-03-05 00:29:24.441000000

Change has been successfully cherry-picked as d331e2f2e189dfea9e28e3d9c732fc65ba82039d

-------------------------------------
