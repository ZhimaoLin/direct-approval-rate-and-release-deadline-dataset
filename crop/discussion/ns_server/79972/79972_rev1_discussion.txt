DESCRIPTION

MB-24648: Fail node add when its already part of cluster.

Currently if a node is present in the nodes_wanted list and for some
reason its config gets deleted we allow the node to be re-added to
the cluster without doing a failover first. This causes data loss.
With this changeset we check first if the node is present in
nodes_wanted and add only if it doesn't already exist.

Change-Id: Id3367e1a0865db245e695d0e5134904432cc642a


COMMENTS

author: Alexander Wagner
date: 2017-06-23 22:54:20.102000000

Uploaded patch set 1.

-------------------------------------
author: Hugo Blankenship
date: 2017-06-23 22:55:20.552000000

Patch Set 1: Well-Formed-1

Branch restricted. PLEASE READ this URL: 

http://server.jenkins.couchbase.com/job/restricted-branch-check/54329/artifact/restricted.html : FAILURE

-------------------------------------
author: Kian Santos
date: 2017-06-23 23:00:25.818000000

Patch Set 1:

check approval

-------------------------------------
author: Hugo Blankenship
date: 2017-06-23 23:00:35.256000000

Patch Set 1: Well-Formed+1

Permission granted to commit: 

http://server.jenkins.couchbase.com/job/restricted-branch-check/54330/artifact/restricted.html : SUCCESS

-------------------------------------
author: Alexander Wagner
date: 2017-06-23 23:02:54.313000000

Patch Set 1: Verified+1

-------------------------------------
author: Ella Beltran
date: 2017-07-11 21:29:57.138000000

Patch Set 1:

(2 comments)

Line:3078, src/menelaus_web.erl -> Don't need this change. This clause is essentially same as the next one.

Line:799, src/ns_cluster.erl -> Please add a space before "GroupUUID"

-------------------------------------
