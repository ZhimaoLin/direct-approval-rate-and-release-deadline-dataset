DESCRIPTION

Set new cookie asap when leaving cluster.

If ns_server shutdown takes considerable amount of time, the node will
continue to communicate to the cluster. This might lead to obscure
problems (see CBSE-2951).

This change doesn't fix the problem entirely, but it narrows the window
significantly.

Change-Id: I5f86b3adc29cbfd793b6200421a876b4cc21e877


COMMENTS

author: Meghan Vazquez
date: 2016-10-19 22:44:06.083000000

Uploaded patch set 1.

-------------------------------------
author: Meghan Vazquez
date: 2016-10-19 23:13:57.043000000

Patch Set 1: Verified+1

Verified, but waiting for the approval to merge into 4.6.

-------------------------------------
author: Kian Santos
date: 2016-10-19 23:32:20.567000000

Patch Set 1:

(1 comment)

Line:210, src/ns_cluster.erl -> suggest: "first thing we do after setting a new cookie"

-------------------------------------
author: Kian Santos
date: 2016-10-19 23:56:25.571000000

Patch Set 1: Code-Review+2

-------------------------------------
author: Meghan Vazquez
date: 2016-10-20 00:02:36.367000000

Patch Set 1: Code-Review-1

-------------------------------------
author: Meghan Vazquez
date: 2016-10-20 00:26:37.293000000

Abandoned

Because ns_config continues to replicate if ns_server is not stopped, this actually introduces new races.

-------------------------------------
