DESCRIPTION

MB-18024: fix head frag inclusion code under multiple docroots

Previously the code blew up trying to filename:join() a
{multiple_roots, ...} tuple to "head.frag.html". This fix
searches for the file in the list of doc roots first
(in the case of multiple docroots only) before continuing with
the existing path of reading and including the file contents.

Change-Id: I466f0c08b56b44b8b2f080d4b36d3c04ca7b2c3a


COMMENTS

author: Kian Santos
date: 2016-02-10 18:36:29.773000000

Uploaded patch set 1.

-------------------------------------
author: Kian Santos
date: 2016-02-10 18:37:40.790000000

Patch Set 1: Verified+1

-------------------------------------
author: Kian Santos
date: 2016-02-10 18:44:21.471000000

Patch Set 1:

To test this, you can create a file called: pluggable-ui-fts.cluster_run.json in cluster_run_ui_plugins directory under build with the following content:

{
  "service": "fts",
  "proxy-strategy": "local",
  "rest-api-prefix": "fts",
  "doc-root": [
    "your-repo-home/godeps/src/github.com/blevesearch/bleve-mapping-ui",
    "your-repo-home/goproj/src/github.com/couchbase/cbgt/rest",
    "your-repo-home/goproj/src/github.com/couchbase/cbft/staticx",
    "your-repo-home/goproj/src/github.com/couchbase/cbft/ns_server_static/fts"
  ]
}

-------------------------------------
author: Leah Mcdaniel
date: 2016-02-10 21:06:05.836000000

Patch Set 1:

Thinking a little about this, if there are multiple docroots, wouldn't it be useful to let each docroot contain a head fragment?

-------------------------------------
author: Kian Santos
date: 2016-02-10 21:59:44.668000000

Patch Set 1:

Wow, yeah, nice idea. Want to pick up this change and modify it to do that?

-------------------------------------
author: Leah Mcdaniel
date: 2016-02-10 22:10:20.977000000

Patch Set 1:

I can do that

-------------------------------------
author: Roselyn Villegas Code Review
date: 2016-02-17 04:51:55.708000000

Change has been successfully cherry-picked as 5a4dd23ea70b202b6fc3ae17dab2b07964dd5b11

-------------------------------------
