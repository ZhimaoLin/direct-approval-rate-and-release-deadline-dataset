DESCRIPTION

Correct sync info calculation for folders

The folder handling in the git "Team synchonization" support was wrong
since commit f46237a (bug 516426). That commit considered folders as
supervised -- which is correct since otherwise some changes may be
missed. It also tried to compensate for folders without changes showing
up in the synchronize view by setting their sync state to IN_SYNC if
they had only IN_SYNC descendants.

That broke the display of "compacted folders" in the synchronize view.
If a file is not IN_SYNC, the synchronize view is able to handle its
parent containers fine without needing any SyncInfo for them. When we
do supply sync info, the parent containers will be considered changed
themselves, and will show up explicitly in the synchronize view.

Therefore, simply return IN_SYNC for folders. The state recorded in the
GitSyncObjCache is bogus anyway.

Bug: 518646
Change-Id: I2970a50b2d11403b84dc1b9a000021f61ca92f90
Signed-off-by: Alayna Houston xxx@xxx.xxx

COMMENTS

author: Alayna Houston
date: 2017-06-22 21:17:58.000000000

Uploaded patch set 1.

-------------------------------------
author: Brenden Conley
date: 2017-06-22 21:18:04.000000000

Patch Set 1:

Build Started https://hudson.eclipse.org/egit/job/egit.gerrit/9967/

-------------------------------------
author: Brenden Conley
date: 2017-06-22 21:46:32.000000000

Patch Set 1: Code-Review-1

Build Unstable 

https://hudson.eclipse.org/egit/job/egit.gerrit/9967/ : UNSTABLE

-------------------------------------
author: Brenden Conley
date: 2017-06-22 21:47:11.000000000

Patch Set 1: -Code-Review

Build Started https://hudson.eclipse.org/egit/job/egit.gerrit/9968/

-------------------------------------
author: Brenden Conley
date: 2017-06-22 22:16:44.000000000

Patch Set 1: Code-Review-1

Build Unstable 

https://hudson.eclipse.org/egit/job/egit.gerrit/9968/ : UNSTABLE

-------------------------------------
author: Alayna Houston
date: 2017-06-22 22:20:53.000000000

Patch Set 1:

Hudson failure appears to be unrelated. When that test is run locally, it succeeds for me. Seems to me our tests are a bit more unstable than they used to be since we switched away from the (gone?) ramdisk.

-------------------------------------
author: Brenden Conley
date: 2017-06-23 05:38:01.000000000

Patch Set 1: -Code-Review

Build Started https://hudson.eclipse.org/egit/job/egit.gerrit/9969/

-------------------------------------
author: Brenden Conley
date: 2017-06-23 05:45:39.000000000

Patch Set 1: Verified-1

Build Failed 

https://hudson.eclipse.org/egit/job/egit.gerrit/9969/ : FAILURE

-------------------------------------
author: Brenden Conley
date: 2017-06-23 05:47:24.000000000

Patch Set 1: -Verified

Build Started https://hudson.eclipse.org/egit/job/egit.gerrit/9970/

-------------------------------------
author: Brenden Conley
date: 2017-06-23 05:54:36.000000000

Patch Set 1: Verified-1

Build Failed 

https://hudson.eclipse.org/egit/job/egit.gerrit/9970/ : FAILURE

-------------------------------------
author: Alayna Houston
date: 2017-06-23 05:55:50.000000000

Patch Set 1:

Hudson appears to be completely unstable right now.

-------------------------------------
author: Brenden Conley
date: 2017-06-23 06:10:45.000000000

Patch Set 1: -Verified

Build Started https://hudson.eclipse.org/egit/job/egit.gerrit/9971/

-------------------------------------
author: Brenden Conley
date: 2017-06-23 06:35:04.000000000

Patch Set 1: Verified+1

Build Successful 

https://hudson.eclipse.org/egit/job/egit.gerrit/9971/ : SUCCESS

-------------------------------------
author: Alayna Houston
date: 2017-06-23 06:43:00.000000000

Patch Set 1:

Switched the job back to use the ramdisk.

-------------------------------------
author: Douglas Trujillo
date: 2017-06-23 07:07:03.000000000

Patch Set 1:

this could go to stable-4.8 so we can release it with the next service release

-------------------------------------
author: Sebastian Porter
date: 2017-06-23 07:47:34.000000000

Patch Set 1: Verified+1

I verified that it fixes the issue and that bug 516426 is still fixed.

-------------------------------------
author: Alayna Houston
date: 2017-06-23 07:54:24.000000000

Patch Set 1:

> I verified that it fixes the issue and that bug 516426 is still
 > fixed.

So did I :-)

Will push this onto stable-4.8 soon, then abandon this one.

-------------------------------------
author: Alayna Houston
date: 2017-06-23 08:02:16.000000000

Abandoned

moved to stable-4.8: https://git.eclipse.org/r/#/c/99933/

-------------------------------------
