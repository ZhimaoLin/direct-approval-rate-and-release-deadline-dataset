DESCRIPTION

Bug 467931 - adapt proxy to changes in o.e.remote and PTP

Following o.e.remote and PTP changes have broken remote proxy:
- rdt and remotetools no longer supported in PTP
- o.e.remote implements OSGi services now

Also updated PTP/remote build target to Mars milestones

Change-Id: Iab26eda77dee809bd4122f9001184c5fe4d4dd81
Signed-off-by: Logan Yoder xxx@xxx.xxx


COMMENTS

author: Logan Yoder
date: 2015-05-25 17:20:44.000000000

Uploaded patch set 5.

-------------------------------------
author: Brenden Conley
date: 2015-05-25 17:20:50.000000000

Patch Set 5:

Build Started https://hudson.eclipse.org/linuxtools/job/linuxtools-gerrit/9553/

-------------------------------------
author: Logan Yoder
date: 2015-05-25 17:21:44.000000000

Patch Set 5:

Patch set #5 only rebase the change due https://git.eclipse.org/r/#/c/48550/

-------------------------------------
author: Brenden Conley
date: 2015-05-25 17:36:19.000000000

Patch Set 5: Verified+1

Build Successful 

https://hudson.eclipse.org/linuxtools/job/linuxtools-gerrit/9553/ : SUCCESS

-------------------------------------
author: Kaylin Maxwell
date: 2015-05-25 23:19:26.000000000

Patch Set 5: Code-Review-1

Why are you changing the scheme?  The scheme is used to determine which proxy to use and there is already an ssh scheme provided by the ssh proxy.  See RemoteProxyManager.java (e.g. getFileProxy()) or RemoteProxyNatureMapping.java.  The other thing to think of is profiling launch configurations with saved URIs.  They will have the old remotetools scheme.  They won't be able to find a proxy.  I think you need to either create a new plugin with a new scheme and then change the remote proxy to give an error or keep the same scheme and fix the code to use the new remote API.

-------------------------------------
author: Logan Yoder
date: 2015-05-26 01:17:10.000000000

Patch Set 5:

> Why are you changing the scheme?  The scheme is used to determine
 > which proxy to use and there is already an ssh scheme provided by
 > the ssh proxy.  See RemoteProxyManager.java (e.g. getFileProxy())
 > or RemoteProxyNatureMapping.java.  

I had to replace "remotetools" with "ssh" scheme because former is no longer implemented by o.e.remote. Moreover, o.e.remote implements remote ssh with Jsch, which in turn recognize only the "ssh" schema.

In my tests, "ssh" schema does not resolve in LT ssh proxy, rather it fall into o.e.remote Jsch implementation. 

 > The other thing to think of is
 > profiling launch configurations with saved URIs.  They will have
 > the old remotetools scheme.  They won't be able to find a proxy.  I
 > think you need to either create a new plugin with a new scheme and
 > then change the remote proxy to give an error or keep the same
 > scheme and fix the code to use the new remote API.

I will check with o.e.remote developers about the backward compatibility. My understanding is that it will break in old projects (i.e. with "remotetools" URI).

-------------------------------------
author: Logan Yoder
date: 2015-05-28 20:21:20.000000000

Patch Set 5:

I'm working on automated tests to check it works fine (or not). I've already found some issues.

-------------------------------------
author: Kaylin Maxwell
date: 2015-05-28 21:22:26.000000000

Patch Set 5:

After thinking about it.  I think the right thing to do is to remove the remotetools proxy from Linux Tools as it is no longer supported and this is a major release.  The Remote browser should switch to use ssh and see if the current ssh proxy fills the bill.  If yes, then use it.  Otherwise, augment the ssh proxy as needed to satisfy the needs of the UI file/directory browser.

Users using remotetools configurations will have to change over to use ssh.

Does that seem reasonable?

-------------------------------------
