DESCRIPTION

TMF: Export trace to text

Add a command to export traces to text.
If a filter is applied, only filtered elements are exported.

Change-Id: Ie213eda715f68104572704cb3c08226aa5c52a85
Signed-off-by: Bryce Kline xxx@xxx.xxx


COMMENTS

author: Bryce Kline
date: 2013-11-13 16:46:24.000000000

Uploaded patch set 3.

-------------------------------------
author: Brenden Conley
date: 2013-11-13 16:46:30.000000000

Patch Set 3:

Build Started https://hudson.eclipse.org/linuxtools/job/linuxtools-gerrit/3909/

-------------------------------------
author: Brenden Conley
date: 2013-11-13 17:30:03.000000000

Patch Set 3: Verified+1

Build Successful 

https://hudson.eclipse.org/linuxtools/job/linuxtools-gerrit/3909/ : SUCCESS

-------------------------------------
author: Ricky Reeves
date: 2013-11-13 18:51:11.000000000

Patch Set 3: Code-Review-1

(12 comments)

Thanks for implementing my change request for considering the table header. Your changes are working in principle. I tried it with several different trace types. However, a few things need to be fixed.

Line:94, lttng/org.eclipse.linuxtools.tmf.ui/plugin.properties -> Please change to "Export To Text..."

Line:36, lttng/org.eclipse.linuxtools.tmf.ui/src/org/eclipse/linuxtools/internal/tmf/ui/commands/ExportToTextCommandHandler.java -> Add java-doc for public constants

Line:37, lttng/org.eclipse.linuxtools.tmf.ui/src/org/eclipse/linuxtools/internal/tmf/ui/commands/ExportToTextCommandHandler.java -> Add java-doc for public constants

Line:66, lttng/org.eclipse.linuxtools.tmf.ui/src/org/eclipse/linuxtools/internal/tmf/ui/messages.properties -> Please change to "Export To Text..." to be consistent with other action names in TMF

Line:55, lttng/org.eclipse.linuxtools.tmf.ui/src/org/eclipse/linuxtools/internal/tmf/ui/commands/ExportToTextJob.java -> @param table xxx@xxx.xxx header are missing

Line:88, lttng/org.eclipse.linuxtools.tmf.ui/src/org/eclipse/linuxtools/internal/tmf/ui/commands/ExportToTextJob.java -> When I tested it then a line break is missing after the header please add

Line:275, lttng/org.eclipse.linuxtools.tmf.core/src/org/eclipse/linuxtools/tmf/core/trace/TmfTraceManager.java xxx@xxx.xxx annotation is missing

Line:175, lttng/org.eclipse.linuxtools.tmf.ui/src/org/eclipse/linuxtools/tmf/ui/viewers/events/TmfEventsTable.java -> add a java-doc comment for public constant, xxx@xxx.xxx annotation

Line:1854, lttng/org.eclipse.linuxtools.tmf.ui/src/org/eclipse/linuxtools/tmf/ui/viewers/events/TmfEventsTable.java -> This is actually an API breaking change. This would mean all classes extending TmfEventsTable have to change for that (There are many in my company). I suggest to keep this method (extractItemFields()) protected and add a public method that calls extractItemFields().

Something like that:

    public final ITmfEventField[] getItemsField(final ITmfEvent event) {
        return extractItemFields(event);
    }

(final method so that nobody is tempted to overwrite it)

Line:40, lttng/org.eclipse.linuxtools.tmf.ui/src/org/eclipse/linuxtools/internal/tmf/ui/commands/ExportToTextRequest.java xxx@xxx.xxx table is missing -> compiler warnings

Line:72, lttng/org.eclipse.linuxtools.tmf.ui/src/org/eclipse/linuxtools/internal/tmf/ui/commands/ExportToTextRequest.java -> I have a trace with fields where field.getValue() returns null. Please add a null check for it. if it is null just write an empty string.

fWriter.write((field.getValue() != null) ? field.getValue().toString() : ""); //$NON-NLS-1$

Line:85, lttng/org.eclipse.linuxtools.tmf.ui/src/org/eclipse/linuxtools/internal/tmf/ui/commands/ExportToTextRequest.java -> getFormattedValue() calls in getValue().getFormattedValue() and in some cases it getValue() can return null. We need to have protection for that. Maybe we should have do something similar than it is done in the toString() method of TmfEventField

-------------------------------------
author: Bryce Kline
date: 2013-11-14 11:35:40.000000000

Patch Set 3:

(1 comment)

Hi Meredith Scott,

Ok for all your suggestions, but one.
How to manage null values when exporting traces ?
(see my comment below)

Line:72, lttng/org.eclipse.linuxtools.tmf.ui/src/org/eclipse/linuxtools/internal/tmf/ui/commands/ExportToTextRequest.java -> Exporting trace is often used to process them with tools like awk/sed, or to import it in Excel.

If you skip a field, you may have two consecutive tabs, and it may be confusing for these tools (awk/sed/excel...)

So, I would like to be sure before proceeding.
What do you prefer:
- empty string (eg "")
- quoted empty string (eg "\"\"")
- null string (eg "null")

-------------------------------------
