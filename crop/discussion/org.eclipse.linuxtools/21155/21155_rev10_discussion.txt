DESCRIPTION

tmf : queryHistoryRange performance fix

This patch removes unnecessary loops for small resolutions,
which increases the performance.

Benchmark :

Before :
Query resolution 1022444670: 0.245
Query resolution 102244467: 1.167
Query resolution 10224446: 3.390s
Query resolution 1022444: 4.028s
Query resolution 102244: 4.285s
Query resolution 10224: 5.451s
Query resolution 1022: 10.970s
Query resolution 102: 37.396s
Query resolution 10: 306.308s

After :
Query resolution 1022444670: 0.278s
Query resolution 102244467: 1.138s
Query resolution 10224446: 3.373s
Query resolution 1022444: 3.976s
Query resolution 102244: 4.329s
Query resolution 10224: 5.309s
Query resolution 1022: 8.001s
Query resolution 102: 8.145s
Query resolution 10: 8.231s

Reference :
Performance with queryHistoryRange without resolution : 8.414s

Change-Id: I6022dc6c562d994310f9419c362dd1f06a414036
Signed-off-by: Ayanna Reed xxx@xxx.xxx
Signed-off-by: Braxton Mccarthy xxx@xxx.xxx


COMMENTS

author: Brenden Conley
date: 2014-04-11 00:58:59.000000000

Patch Set 10:

Build Started https://hudson.eclipse.org/linuxtools/job/linuxtools-gerrit/6348/

-------------------------------------
author: Brenden Conley
date: 2014-04-11 01:47:50.000000000

Patch Set 10: Verified+1

Build Successful 

https://hudson.eclipse.org/linuxtools/job/linuxtools-gerrit/6348/ : SUCCESS

-------------------------------------
author: Ayanna Reed
date: 2014-04-11 01:50:41.000000000

Patch Set 10: Code-Review+1

ltgm ! Just merge this patch !

-------------------------------------
author: Luciana Barry
date: 2014-04-11 15:36:13.000000000

Patch Set 10: Code-Review-1

(1 comment)

Line:722, lttng/org.eclipse.linuxtools.tmf.core/src/org/eclipse/linuxtools/internal/tmf/core/statesystem/StateSystem.java -> Possibly missing the interval at t2? Should keep those lines from base code.

-------------------------------------
author: Ayanna Reed
date: 2014-04-11 15:47:41.000000000

Patch Set 10:

(1 comment)

Line:722, lttng/org.eclipse.linuxtools.tmf.core/src/org/eclipse/linuxtools/internal/tmf/core/statesystem/StateSystem.java -> At this point we are sure that ts > tEnd, so we are sure that currentInterval.getEndTime() >= ts > tEnd.
The condition if (currentInterval.getEndTime() < tEnd) is useless.

-------------------------------------
author: Luciana Barry
date: 2014-04-11 18:40:35.000000000

Patch Set 10:

(1 comment)

Line:722, lttng/org.eclipse.linuxtools.tmf.core/src/org/eclipse/linuxtools/internal/tmf/core/statesystem/StateSystem.java -> If we do a query from [0,250] with resolution 100, we will get the intervals at 0, 100, 200. If that last interval is [195,205], then we don't get the interval at tEnd=250 because ts=300.

-------------------------------------
author: Ayanna Reed
date: 2014-04-11 19:00:30.000000000

Patch Set 10:

(1 comment)

Line:722, lttng/org.eclipse.linuxtools.tmf.core/src/org/eclipse/linuxtools/internal/tmf/core/statesystem/StateSystem.java -> Done

-------------------------------------
