DESCRIPTION

tmf : queryHistoryRange performance fix

This patch removes unnecessary loops for small resolutions,
which increases the performance.

Benchmark :

Before :
Query resolution 1022444670: 0.245
Query resolution 102244467: 1.167
Query resolution 10224446: 3.390s
Query resolution 1022444: 4.028s
Query resolution 102244: 4.285s
Query resolution 10224: 5.451s
Query resolution 1022: 10.970s
Query resolution 102: 37.396s
Query resolution 10: 306.308s

After :
Query resolution 1022444670: 0.278s
Query resolution 102244467: 1.138s
Query resolution 10224446: 3.373s
Query resolution 1022444: 3.976s
Query resolution 102244: 4.329s
Query resolution 10224: 5.309s
Query resolution 1022: 8.001s
Query resolution 102: 8.145s
Query resolution 10: 8.231s

Reference :
Performance with queryHistoryRange without resolution : 8.414s

Change-Id: I6022dc6c562d994310f9419c362dd1f06a414036
Signed-off-by: Ayanna Reed xxx@xxx.xxx
Signed-off-by: Braxton Mccarthy xxx@xxx.xxx


COMMENTS

author: Braxton Mccarthy
date: 2014-04-03 20:37:39.000000000

Uploaded patch set 8.

-------------------------------------
author: Brenden Conley
date: 2014-04-03 20:37:44.000000000

Patch Set 8:

Build Started https://hudson.eclipse.org/linuxtools/job/linuxtools-gerrit/6227/

-------------------------------------
author: Braxton Mccarthy
date: 2014-04-03 20:40:07.000000000

Patch Set 8: Code-Review+1

Ok after much deliberation, the version we prefer is the one from PS1, but with the check for endTime != -1 removed, since it cannot return -1 anymore (which was very bad).

I'm not sure if the benchmark results are correct though, but if the order of magnitude is the same tbh it doesn't really matter.

-------------------------------------
author: Ayanna Reed
date: 2014-04-03 20:55:01.000000000

Patch Set 8: Code-Review+1

-------------------------------------
author: Ayanna Reed
date: 2014-04-03 20:58:21.000000000

Patch Set 8:

(2 comments)

Unnecessary code. We can remove theses 6 lignes or not.

Line:711, lttng/org.eclipse.linuxtools.tmf.core/src/org/eclipse/linuxtools/internal/tmf/core/statesystem/StateSystem.java -> Unnecessary

Line:729, lttng/org.eclipse.linuxtools.tmf.core/src/org/eclipse/linuxtools/internal/tmf/core/statesystem/StateSystem.java -> Unnecessary

-------------------------------------
author: Brenden Conley
date: 2014-04-03 21:05:27.000000000

Patch Set 8: Verified-1

Build Failed 

https://hudson.eclipse.org/linuxtools/job/linuxtools-gerrit/6227/ : FAILURE

-------------------------------------
author: Braxton Mccarthy
date: 2014-04-03 21:06:13.000000000

Patch Set 8: Code-Review-1

(2 comments)

Line:711, lttng/org.eclipse.linuxtools.tmf.core/src/org/eclipse/linuxtools/internal/tmf/core/statesystem/StateSystem.java -> humm, but we do have to instantiate the array at some point, don't we?

Hey btw, this should be a linked list, not an array list! inb4 GeneviÃ¨ve ;)

Line:729, lttng/org.eclipse.linuxtools.tmf.core/src/org/eclipse/linuxtools/internal/tmf/core/statesystem/StateSystem.java -> true, this will always be included now

-------------------------------------
author: Ayanna Reed
date: 2014-04-03 21:10:09.000000000

Patch Set 8:

(2 comments)

Line:688, lttng/org.eclipse.linuxtools.tmf.core/src/org/eclipse/linuxtools/internal/tmf/core/statesystem/StateSystem.java -> We can initialize intervals here

Line:711, lttng/org.eclipse.linuxtools.tmf.core/src/org/eclipse/linuxtools/internal/tmf/core/statesystem/StateSystem.java -> Okay. but the case t1 is the 1st in the loop

-------------------------------------
author: Luciana Barry
date: 2014-04-04 19:12:40.000000000

Patch Set 8: Code-Review+1

(1 comment)

Line:729, lttng/org.eclipse.linuxtools.tmf.core/src/org/eclipse/linuxtools/internal/tmf/core/statesystem/StateSystem.java -> I think it's still necessary if we want the interval at t2?

-------------------------------------
