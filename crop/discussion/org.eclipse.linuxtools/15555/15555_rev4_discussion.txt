DESCRIPTION

tmf : Update the histogram to handle lost events correctly

Add a checkbox to toggle displaying the lost events
Display the lost event's bars in the histogram

Change-Id: Iba72f479455cadc4150efadf695f943a6572f3d2
Signed-off-by: Liana Berg xxx@xxx.xxx
Signed-off-by: Kelsie Blackwell xxx@xxx.xxx
Signed-off-by: Ivy Mitchell xxx@xxx.xxx


COMMENTS

author: Ivy Mitchell
date: 2013-08-23 20:04:34.000000000

Uploaded patch set 4.

-------------------------------------
author: Brenden Conley
date: 2013-08-23 20:04:40.000000000

Patch Set 4:

Build Started https://hudson.eclipse.org/sandbox/job/linuxtools/3265/

-------------------------------------
author: Brenden Conley
date: 2013-08-23 20:25:17.000000000

Patch Set 4: Verified+1

Build Successful 

https://hudson.eclipse.org/sandbox/job/linuxtools/3265/ : SUCCESS

-------------------------------------
author: Ivy Mitchell
date: 2013-08-28 21:20:04.000000000

Patch Set 4: Code-Review+1 IP-Clean+1

Code looks good.

-------------------------------------
author: Ivy Mitchell
date: 2013-08-28 21:31:42.000000000

Patch Set 4: Verified+1

Fucntions well, would like a second +1 on this one

-------------------------------------
author: Luciana Barry
date: 2013-08-28 22:12:08.000000000

Patch Set 4: Code-Review-1

(8 comments)

Line:41, lttng/org.eclipse.linuxtools.tmf.ui/src/org/eclipse/linuxtools/tmf/ui/views/histogram/Messages.java -> tabs

Line:58, lttng/org.eclipse.linuxtools.tmf.ui/src/org/eclipse/linuxtools/tmf/ui/views/histogram/HistogramDataModel.java -> might no longer be the timestamp of an event

Line:504, lttng/org.eclipse.linuxtools.tmf.ui/src/org/eclipse/linuxtools/tmf/ui/views/histogram/HistogramDataModel.java -> should be >= ?

Line:509, lttng/org.eclipse.linuxtools.tmf.ui/src/org/eclipse/linuxtools/tmf/ui/views/histogram/HistogramDataModel.java -> The number of buckets and the lost events per bucket should not be affected by the discarded events (when fullRange=false).
They should, however, be affected by the merging of buckets (when fullRange=true).

Line:634, lttng/org.eclipse.linuxtools.tmf.ui/src/org/eclipse/linuxtools/tmf/ui/views/histogram/HistogramDataModel.java -> spaces around -

Line:636, lttng/org.eclipse.linuxtools.tmf.ui/src/org/eclipse/linuxtools/tmf/ui/views/histogram/Histogram.java -> I believe this would draw one extra pixel at y-coordinate 'height', however since this pixel is out of bounds it does not draw. So ok?

Line:641, lttng/org.eclipse.linuxtools.tmf.ui/src/org/eclipse/linuxtools/tmf/ui/views/histogram/Histogram.java -> I believe this will overwrite one pixel of the normal event line. Should it end at height - value - 1? But should check if drawLine draws something when point1 = point2. Also, it should not draw the line if lostEventValue = 0.

Line:780, lttng/org.eclipse.linuxtools.tmf.ui/src/org/eclipse/linuxtools/tmf/ui/views/histogram/Histogram.java -> suggestion: append only if the number is > 0 ?

-------------------------------------
author: Ivy Mitchell
date: 2013-08-30 01:40:44.000000000

Patch Set 4:

(2 comments)

Rebuttal. Hehehe REbuttAL

Line:509, lttng/org.eclipse.linuxtools.tmf.ui/src/org/eclipse/linuxtools/tmf/ui/views/histogram/HistogramDataModel.java -> I agree in theory, but I tested it and it looks correct with this algo. which is weird.

Line:780, lttng/org.eclipse.linuxtools.tmf.ui/src/org/eclipse/linuxtools/tmf/ui/views/histogram/Histogram.java -> I prefer it like this, but if you prefer, we can do that.

-------------------------------------
author: Ricky Reeves
date: 2013-08-30 15:36:57.000000000

Patch Set 4:

(1 comment)

Line:494, lttng/org.eclipse.linuxtools.tmf.ui/src/org/eclipse/linuxtools/tmf/ui/views/histogram/HistogramDataModel.java -> the flag name "fullRange" is misleading. Inside the data model fullRange has no meaning. It should be called according to its purpose.

-------------------------------------
author: Luciana Barry
date: 2013-08-31 05:31:47.000000000

Patch Set 4: Verified-1

(1 comment)

Testing the patch I can see an extra red pixel at the top of every histogram bar, even when there is 0 lost event.

Furthermore, the distribution of remaining lost events does not produce good results, because of the merging of buckets.

[11,11,11,11,11,11,10,10,10,...]
[22,22,22,22,20,20,20...]
[44,44,40,40,40,...]
[88,80,80,80,...]
where we would have wanted something like
[81,81,81,81,81,81,80,80,80,...]

Perhaps a more correct solution would be to store floating point numbers for the number of lost events per bucket (therefore equal across the whole lost event range), which only gets converted to an integer value at drawing time (or perhaps scaling time).

Line:494, lttng/org.eclipse.linuxtools.tmf.ui/src/org/eclipse/linuxtools/tmf/ui/views/histogram/HistogramDataModel.java -> I made the suggestion to have a flag name related to the 'context' (full vs partial) of the request instead of the purpose (merge vs drop), because then it could be misleading to use the flag for any other purpose. I guess it's ok for HistogramRequest.handleData() to be the 'cutoff' point between the two concepts.

-------------------------------------
author: Gerrit Code Review
date: 2013-09-30 21:25:45.000000000

The change could not be merged due to a path conflict.

Please rebase the change locally and upload the rebased commit for review.

-------------------------------------
