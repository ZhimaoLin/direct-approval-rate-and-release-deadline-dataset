DESCRIPTION

tmf : Update the histogram to handle lost events correctly

Add a checkbox to toggle displaying the lost events
Display the lost event's bars in the histogram

Change-Id: Iba72f479455cadc4150efadf695f943a6572f3d2
Signed-off-by: Liana Berg xxx@xxx.xxx
Signed-off-by: Kelsie Blackwell xxx@xxx.xxx
Signed-off-by: Ivy Mitchell xxx@xxx.xxx


COMMENTS

author: Ivy Mitchell
date: 2013-09-23 15:48:01.000000000

Uploaded patch set 7.

-------------------------------------
author: Brenden Conley
date: 2013-09-23 15:48:06.000000000

Patch Set 7:

Build Started https://hudson.eclipse.org/linuxtools/job/linuxtools-gerrit/3535/

-------------------------------------
author: Brenden Conley
date: 2013-09-23 16:15:37.000000000

Patch Set 7: Verified+1

Build Successful 

https://hudson.eclipse.org/linuxtools/job/linuxtools-gerrit/3535/ : SUCCESS

-------------------------------------
author: Braxton Mccarthy
date: 2013-09-24 20:33:13.000000000

Patch Set 7: Code-Review-1

(20 comments)

Seems to work well, good work!

Code-wise, two big things:

- The added unit tests should be in a separate test file, with common setup methods.
- The added button should be "Show Lost Events", so that everything is positive (if (showLostEvents), etc.) It would be clearer in both the UI and the code.

plus the other small comments.

Line:10, /COMMIT_MSG -> lost events'

I would say "bars", just display the lost events in the histogram.

Also the second line should be first.

Line:527, lttng/org.eclipse.linuxtools.lttng.help/doc/User-Guide.mediawiki -> Will become "Show lost events"

Line:62, lttng/org.eclipse.linuxtools.tmf.ui/src/org/eclipse/linuxtools/tmf/ui/views/histogram/HistogramScaledData.java -> oh god, the public, it hurts.

Ok, let's keep it consistent for now, but next API breaks we need to fix those fields (make them private, with getters where needed).

This field could be final at least.

Line:119, lttng/org.eclipse.linuxtools.tmf.ui/src/org/eclipse/linuxtools/tmf/ui/views/histogram/HistogramScaledData.java -> If it's gonna be public, should be volatile too (to guarantee safe multi-thread access).

Line:130, lttng/org.eclipse.linuxtools.tmf.ui/src/org/eclipse/linuxtools/tmf/ui/views/histogram/HistogramRequest.java -> Swap the if/else code blocks, and keep the condition positive. Makes it easier to understand.

Line:137, lttng/org.eclipse.linuxtools.tmf.ui/src/org/eclipse/linuxtools/tmf/ui/views/histogram/HistogramRequest.java -> Cast can be unsafe, should be checked the value is <= Integer.MAX_VALUE first.

File Comment: lttng/org.eclipse.linuxtools.lttng.help/doc/images/HV_toolbar_lost_events.png -> You should use the same file as the "real" icon. You will need a copy of the file in the lttng.help plugin, but if it's the exact same file then Git will store it only once.

File Comment: lttng/org.eclipse.linuxtools.tmf.ui.tests/src/org/eclipse/linuxtools/tmf/ui/tests/histogram/HistogramDataModelTest.java -> There is a lot of copy-paste in the added tests. They should be added to a test test file, which has a xxx@xxx.xxx method (and/or a private setup method with parameters)

Line:676, lttng/org.eclipse.linuxtools.tmf.ui.tests/src/org/eclipse/linuxtools/tmf/ui/tests/histogram/HistogramDataModelTest.java -> You shouldn't do assertTrue(a == b), but assertEquals(a, b). The error message will print the expected and actual values.

Here in fact you can use assertArrayEquals.

'expected' should be the first parameter. It's counter-intuitive, I know...

Line:679, lttng/org.eclipse.linuxtools.tmf.ui.tests/src/org/eclipse/linuxtools/tmf/ui/tests/histogram/HistogramDataModelTest.java -> same here

Line:689, lttng/org.eclipse.linuxtools.tmf.ui.tests/src/org/eclipse/linuxtools/tmf/ui/tests/histogram/HistogramDataModelTest.java -> Use assertEquals for those instead. Don't forget 'expected' goes first

Line:722, lttng/org.eclipse.linuxtools.tmf.ui.tests/src/org/eclipse/linuxtools/tmf/ui/tests/histogram/HistogramDataModelTest.java -> assertArrayEquals, rest of the file too

Line:732, lttng/org.eclipse.linuxtools.tmf.ui.tests/src/org/eclipse/linuxtools/tmf/ui/tests/histogram/HistogramDataModelTest.java -> assertEquals, + rest of the file

Line:16, lttng/org.eclipse.linuxtools.tmf.ui/src/org/eclipse/linuxtools/tmf/ui/views/histogram/HistogramDataModel.java -> s/ and /, /

Line:98, lttng/org.eclipse.linuxtools.tmf.ui/src/org/eclipse/linuxtools/tmf/ui/views/histogram/HistogramDataModel.java -> don't do this.

If the comment is really too long, put it above the variable declaration.

Line:514, lttng/org.eclipse.linuxtools.tmf.ui/src/org/eclipse/linuxtools/tmf/ui/views/histogram/HistogramDataModel.java -> where is this number coming from? looks like debugging artifacts

Line:531, lttng/org.eclipse.linuxtools.tmf.ui/src/org/eclipse/linuxtools/tmf/ui/views/histogram/HistogramDataModel.java -> the second condition is the same as the one in the while, so you do not need it here.

if it's false, then it won't enter the while block at all.

File Comment: lttng/org.eclipse.linuxtools.tmf.ui/src/org/eclipse/linuxtools/tmf/ui/views/histogram/Histogram.java -> The formatting updates should be separated in another commmit

Line:350, lttng/org.eclipse.linuxtools.tmf.ui/src/org/eclipse/linuxtools/tmf/ui/views/histogram/Histogram.java -> don't keep the 'f' in the method name, just getMaxNbEventsText()

Line:791, lttng/org.eclipse.linuxtools.tmf.ui/src/org/eclipse/linuxtools/tmf/ui/views/histogram/Histogram.java -> should use the platform-agnostic property, which I don't remember how to get, but SO surely knows.

-------------------------------------
author: Luciana Barry
date: 2013-09-24 21:02:23.000000000

Patch Set 7:

> The added button should be "Show Lost Events"

I guess it's to be similar to the "Hide" buttons in the Outline view for example. In my opinion it should be "Hide" if they are shown by default, and "Show" if they are hidden by default (the toggle button should be unpushed by default).

-------------------------------------
author: Ivy Mitchell
date: 2013-09-25 21:00:58.000000000

Patch Set 7:

(17 comments)

Line:62, lttng/org.eclipse.linuxtools.tmf.ui/src/org/eclipse/linuxtools/tmf/ui/views/histogram/HistogramScaledData.java -> Done

Line:119, lttng/org.eclipse.linuxtools.tmf.ui/src/org/eclipse/linuxtools/tmf/ui/views/histogram/HistogramScaledData.java -> Done

Line:130, lttng/org.eclipse.linuxtools.tmf.ui/src/org/eclipse/linuxtools/tmf/ui/views/histogram/HistogramRequest.java -> Done

Line:137, lttng/org.eclipse.linuxtools.tmf.ui/src/org/eclipse/linuxtools/tmf/ui/views/histogram/HistogramRequest.java -> Done

File Comment: lttng/org.eclipse.linuxtools.tmf.ui.tests/src/org/eclipse/linuxtools/tmf/ui/tests/histogram/HistogramDataModelTest.java -> Done

Line:676, lttng/org.eclipse.linuxtools.tmf.ui.tests/src/org/eclipse/linuxtools/tmf/ui/tests/histogram/HistogramDataModelTest.java -> Done

Line:679, lttng/org.eclipse.linuxtools.tmf.ui.tests/src/org/eclipse/linuxtools/tmf/ui/tests/histogram/HistogramDataModelTest.java -> Done

Line:689, lttng/org.eclipse.linuxtools.tmf.ui.tests/src/org/eclipse/linuxtools/tmf/ui/tests/histogram/HistogramDataModelTest.java -> Done

Line:722, lttng/org.eclipse.linuxtools.tmf.ui.tests/src/org/eclipse/linuxtools/tmf/ui/tests/histogram/HistogramDataModelTest.java -> Done

Line:732, lttng/org.eclipse.linuxtools.tmf.ui.tests/src/org/eclipse/linuxtools/tmf/ui/tests/histogram/HistogramDataModelTest.java -> Done

Line:16, lttng/org.eclipse.linuxtools.tmf.ui/src/org/eclipse/linuxtools/tmf/ui/views/histogram/HistogramDataModel.java -> Done

Line:98, lttng/org.eclipse.linuxtools.tmf.ui/src/org/eclipse/linuxtools/tmf/ui/views/histogram/HistogramDataModel.java -> Done

Line:514, lttng/org.eclipse.linuxtools.tmf.ui/src/org/eclipse/linuxtools/tmf/ui/views/histogram/HistogramDataModel.java -> Done

Line:531, lttng/org.eclipse.linuxtools.tmf.ui/src/org/eclipse/linuxtools/tmf/ui/views/histogram/HistogramDataModel.java -> Done

File Comment: lttng/org.eclipse.linuxtools.tmf.ui/src/org/eclipse/linuxtools/tmf/ui/views/histogram/Histogram.java -> Done

Line:350, lttng/org.eclipse.linuxtools.tmf.ui/src/org/eclipse/linuxtools/tmf/ui/views/histogram/Histogram.java -> Done

Line:791, lttng/org.eclipse.linuxtools.tmf.ui/src/org/eclipse/linuxtools/tmf/ui/views/histogram/Histogram.java -> Done

-------------------------------------
author: Gerrit Code Review
date: 2013-09-30 21:25:45.000000000

The change could not be merged due to a path conflict.

Please rebase the change locally and upload the rebased commit for review.

-------------------------------------
