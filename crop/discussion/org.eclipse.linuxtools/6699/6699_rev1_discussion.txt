DESCRIPTION

Add perf comparison feature.

This feature consists of collecting perf data files, generating
tree models from these files (using current perf functionality),
and building a result from these two models that is displayed
in a new view.

The logic for comparing the two tree models is located in PMSymbolMatcher,
matching PMSymbols are stored in a PMSymbolMatch object.

Views and actions are in their respective file.

Change-Id: Id1caee9bac0be49ea05bc7a8e62fb90cea8d762e


COMMENTS

author: Erick Ross
date: 2012-07-13 10:56:43.000000000

Patch Set 1: I would prefer that you didn't submit this

(27 inline comments)

Please take care of the comments and rebase on top of master before submitting.

Line:46, perf/org.eclipse.linuxtools.perf/src/org/eclipse/linuxtools/internal/perf/ui/PerfDiffLabelProvider.java -> Don't catch Exception. Catch the actual exception you care for.

Line:76, perf/org.eclipse.linuxtools.perf/src/org/eclipse/linuxtools/internal/perf/ui/PerfDiffLabelProvider.java -> Don't catch Exception. Catch the actual exception you care for.

Line:85, perf/org.eclipse.linuxtools.perf/src/org/eclipse/linuxtools/internal/perf/ui/PerfDiffLabelProvider.java -> throwing RuntimeException is really dangerous as it can be catched anywhere someone did catch(Exception) causing unpredictable results.
Case 5 returns empty string, can we make the default return empty string too or something else meaningful to prevent throwing the exception around.

Line:29, perf/org.eclipse.linuxtools.perf/src/org/eclipse/linuxtools/internal/perf/ui/PerfDiffAction.java -> Externalize string.

Line:48, perf/org.eclipse.linuxtools.perf/src/org/eclipse/linuxtools/internal/perf/ui/PerfDiffAction.java -> If it's warning use MessageDialog.openWarning

Line:50, perf/org.eclipse.linuxtools.perf/src/org/eclipse/linuxtools/internal/perf/ui/PerfDiffAction.java -> Externalize strings.

Line:62, perf/org.eclipse.linuxtools.perf/src/org/eclipse/linuxtools/internal/perf/ui/PerfDiffAction.java -> Use MessageDialog.openError for errors.

Line:64, perf/org.eclipse.linuxtools.perf/src/org/eclipse/linuxtools/internal/perf/ui/PerfDiffAction.java -> Externalize strings

Line:74, perf/org.eclipse.linuxtools.perf/src/org/eclipse/linuxtools/internal/perf/ui/PerfDiffAction.java -> If you agree on returning empty list from PMSymbolMatcher this would have to become result.isEmpty

Line:93, perf/org.eclipse.linuxtools.perf/src/org/eclipse/linuxtools/internal/perf/model/PMSymbolMatcher.java -> unneeded cast, please remove it

Line:98, perf/org.eclipse.linuxtools.perf/src/org/eclipse/linuxtools/internal/perf/model/PMSymbolMatcher.java -> one more unneeded cast, please remove it.

Line:117, perf/org.eclipse.linuxtools.perf/src/org/eclipse/linuxtools/internal/perf/model/PMSymbolMatcher.java -> In general when working with collections it's better to return empty collection (ArrayList in this case) which will prevent NPEs in places calling this method.

Line:32, perf/org.eclipse.linuxtools.perf/src/org/eclipse/linuxtools/internal/perf/launch/PerfDefaultLaunchConfig.java -> CoreException is not actaully thrown from this method body.

Line:21, perf/org.eclipse.linuxtools.perf/src/org/eclipse/linuxtools/internal/perf/ui/PerfDataClearAction.java -> Externalize strings.

Line:24, perf/org.eclipse.linuxtools.perf/src/org/eclipse/linuxtools/internal/perf/ui/PerfDataClearAction.java -> xxx@xxx.xxx annotation

Line:17, perf/org.eclipse.linuxtools.perf/src/org/eclipse/linuxtools/internal/perf/ui/PerfDiffTableSorter.java -> Would you please add some javadoc explaining how the comparison is done?

Line:31, perf/org.eclipse.linuxtools.perf/src/org/eclipse/linuxtools/internal/perf/ui/PerfDiffView.java -> not used anywhere. Please either remove or start using it

Line:72, perf/org.eclipse.linuxtools.perf/src/org/eclipse/linuxtools/internal/perf/ui/PerfDiffView.java -> What's the point of saving i to index ? Can't we just pass it to createTableViewerColumn directly?

Line:92, perf/org.eclipse.linuxtools.perf/src/org/eclipse/linuxtools/internal/perf/ui/PerfDiffView.java -> xxx@xxx.xxx

Line:67, perf/org.eclipse.linuxtools.perf/src/org/eclipse/linuxtools/internal/perf/model/PMSymbolMatch.java -> Please don't catch Exception. I removed it and it still compiles fine. If you prevent NPEs this way please replace with if (null.. ) .

Line:81, perf/org.eclipse.linuxtools.perf/src/org/eclipse/linuxtools/internal/perf/model/PMSymbolMatch.java -> Again, please don't catch Exception. Code compiles fine without the try catch but you might want to replace it with catch for NumberFormatException.

Line:31, perf/org.eclipse.linuxtools.perf/src/org/eclipse/linuxtools/internal/perf/ui/PerfDataCollectionView.java -> not used anywhere. Do you planned to have this constant for usage in the actions?

Line:42, perf/org.eclipse.linuxtools.perf/src/org/eclipse/linuxtools/internal/perf/ui/PerfDataCollectionView.java -> xxx@xxx.xxx

Line:79, perf/org.eclipse.linuxtools.perf/src/org/eclipse/linuxtools/internal/perf/ui/PerfDataCollectionView.java -> xxx@xxx.xxx

Line:103, perf/org.eclipse.linuxtools.perf/src/org/eclipse/linuxtools/internal/perf/ui/PerfDataCollectionView.java -> xxx@xxx.xxx

Line:24, perf/org.eclipse.linuxtools.perf/src/org/eclipse/linuxtools/internal/perf/ui/PerfDataCollectionAction.java -> Externalize strings.

Line:31, perf/org.eclipse.linuxtools.perf/src/org/eclipse/linuxtools/internal/perf/ui/PerfDataCollectionAction.java -> Please externalize strings.

-------------------------------------
author: Erick Ross
date: 2012-07-13 10:56:53.000000000

Patch Set 1:

Please take care of the comments and rebase on top of master before submitting.

-------------------------------------
