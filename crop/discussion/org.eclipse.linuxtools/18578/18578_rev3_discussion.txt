DESCRIPTION

tmf: Coalescing for analysis framework

When opening a trace all relevant background requests (indexing,
histogram, Kernel State system Analysis etc) are coalesced so
that the trace is read only once. To make it work the method
notifyPendingRequest() of the TmfDataProvider was used (amongst some
rearrangements). This method allows to synchronize requests across
threads. This is on top of the synchronization using TMF signals.

However, due to the fact that the HistoryBuilder.buildManually() waits
for the state system request to complete, the place to use
notifyPendingRequests(false) to decrement the internal pending counter
is not obvious. Therefore we need to revisit the way it is handled.

We also should allow analysis to run asynchronous so that we don't
use waitForCompletion. See executeAnalysis() method with requires
that the the analysis is finished when returning.

This patch is also to demonstrate that coalescing of requests is
possible with the current means provided by TMF.
The "Fun-bus-coalescing" hasn't been designed and there will be a
several challenges to make it work (e.g. multi-thread handling). Also
we don't know what the gain is. We should try to use what is already
there.

Change-Id: Ib5e156df9bca416e9546b16c5c9e06efe768372f
Signed-off-by: Ricky Reeves <Meredith xxx@xxx.xxx


COMMENTS

author: Braxton Mccarthy
date: 2013-11-25 23:33:09.000000000

Uploaded patch set 3.

-------------------------------------
author: Braxton Mccarthy
date: 2013-11-25 23:35:16.000000000

Patch Set 3:

Rebase to latest LTTng-kernel patch, which is based on latest master (with corrections for the TmfDataProvider -> TmfEventProvider change).

Haven't tried it or tested anything yet.

-------------------------------------
author: Ricky Reeves
date: 2013-11-26 01:24:59.000000000

Patch Set 3:

Thanks for rebasing it. I tested it and coalescing still works. Ready for review ...

-------------------------------------
author: Brenden Conley
date: 2013-11-26 02:08:07.000000000

Patch Set 3:

Build Started https://hudson.eclipse.org/linuxtools/job/linuxtools-gerrit/4151/

-------------------------------------
author: Brenden Conley
date: 2013-11-26 02:28:26.000000000

Patch Set 3: Verified-1

Build Failed 

https://hudson.eclipse.org/linuxtools/job/linuxtools-gerrit/4151/ : FAILURE

-------------------------------------
