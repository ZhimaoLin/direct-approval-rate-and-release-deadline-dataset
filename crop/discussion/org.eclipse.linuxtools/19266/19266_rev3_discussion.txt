DESCRIPTION

tmf : update for extension node in HistoryTree

Solve some performance issues by minimizing the number of childnodes.

Change-Id: Ie05ce11673d27994b397e7882c1d4f1c8710862c
Signed-off-by: Ayanna Reed xxx@xxx.xxx


COMMENTS

author: Braxton Mccarthy
date: 2013-12-03 22:36:21.000000000

Patch Set 3: Code-Review-1

This is more simple than I thought it would be, good work!

However, "ExtendedNode" or whatever it's called should be a separate class from CoreNode: we can get the list of children from the first (core) node, and instead of repeating it in the extensions, we could just strip those arrays from the node header, which would give more space to store intervals.

I don't know if you intended to work more on this, I can try to do this change in the next few days.

-------------------------------------
author: Braxton Mccarthy
date: 2013-12-03 22:38:46.000000000

Patch Set 3:

(1 comment)

Line:26, lttng/org.eclipse.linuxtools.tmf.core/src/org/eclipse/linuxtools/internal/tmf/core/statesystem/backends/historytree/HTConfig.java -> hmm, a minimum value, to say "create extension nodes until you reach at least this value". Good idea! Now we have more parameters to play with (and make charts!)

-------------------------------------
author: Ayanna Reed
date: 2013-12-03 22:44:33.000000000

Patch Set 3:

(1 comment)

I can work on it. I have a good understanding of this part. During the hackathon, I want to do a couple of patches to optimize how to do queries.

Line:26, lttng/org.eclipse.linuxtools.tmf.core/src/org/eclipse/linuxtools/internal/tmf/core/statesystem/backends/historytree/HTConfig.java -> Yes! Here we have one more potential paper !

-------------------------------------
author: Brenden Conley
date: 2013-12-04 01:32:02.000000000

Patch Set 3:

Build Started https://hudson.eclipse.org/linuxtools/job/linuxtools-gerrit/4376/

-------------------------------------
author: Brenden Conley
date: 2013-12-04 02:22:15.000000000

Patch Set 3: Verified+1

Build Successful 

https://hudson.eclipse.org/linuxtools/job/linuxtools-gerrit/4376/ : SUCCESS

-------------------------------------
author: Annalise Jimenez
date: 2013-12-04 14:50:42.000000000

Patch Set 3: Code-Review-1

(2 comments)

I'm not an expert on the subject, I'll let Alex judge the patch, but here are some comments on the code.

Line:72, lttng/org.eclipse.linuxtools.tmf.core/src/org/eclipse/linuxtools/internal/tmf/core/statesystem/backends/historytree/HTConfig.java -> No need for the minChildren field since you never set it.  You can just return DEFAULT_MINCHILDREN

Line:247, lttng/org.eclipse.linuxtools.tmf.core/src/org/eclipse/linuxtools/internal/tmf/core/statesystem/backends/historytree/HTNode.java -> This supposes that node is always later than current object.  You should add that to the javadoc, just so the caller of this function knows to make sure that node.nodeEnd > this.nodeEnd

-------------------------------------
author: Jordon Obrien
date: 2013-12-11 06:15:40.000000000

Patch Set 3:

(5 comments)

I have a major question on the algorithm.
many nits.

Line:10, /COMMIT_MSG -> Explain why this solve performance issue.

This is an abstract for the reader. It often avoid reading the patches many time to get the big picture because you summarize it for us.

Sell your ideas.

Line:127, lttng/org.eclipse.linuxtools.tmf.core/src/org/eclipse/linuxtools/internal/tmf/core/statesystem/backends/historytree/HT_IO.java -> -1?

This should be hoists to a global static final int constant.
The reason is documentation.

Which one has more sense for you?

1) if (extension != -1)
2) if (extension != NO_EXTENSION_NODE)

Line:128, lttng/org.eclipse.linuxtools.tmf.core/src/org/eclipse/linuxtools/internal/tmf/core/statesystem/backends/historytree/HT_IO.java -> If I understand correctly, the notion of extension is a "linked list" of nodes to extend the current one.

If yes, there is a major issue here.
Assume a bad cases, you have 1000 extensions linked.
Your algorithm will many but many times the intervals.

The packet 1000 will merged into packet 999
packet 999 will be merge into packet 998
packet 997 will be merge into packet 996...

thus intervals into packet 1000 are copy 1000 times.
etc...

This is bad.

Line:474, lttng/org.eclipse.linuxtools.tmf.core/src/org/eclipse/linuxtools/internal/tmf/core/statesystem/backends/historytree/HistoryTree.java -> an* extension

Line:240, lttng/org.eclipse.linuxtools.tmf.core/src/org/eclipse/linuxtools/internal/tmf/core/statesystem/backends/historytree/HTNode.java -> second/first
the notion of number is arbritary.

Naming the parameter "source" give a better hint to the reader.
Even just by looking at the method definition, you know where the intervals are moving to.

-------------------------------------
author: Ayanna Reed
date: 2014-04-10 13:51:22.000000000

Abandoned

The patch 24791 replace this patch.
https://git.eclipse.org/r/#/c/24791/

-------------------------------------
