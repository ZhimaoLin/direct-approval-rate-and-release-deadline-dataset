DESCRIPTION

tmf: Handle 'null' active pages in views

There is a possible race condition when launching the program,
between the platform's window and the views' active page.

Use getSite() in views where possible instead of PlatformUI, and
add null checks where this is not possible.

Change-Id: I2f94a9eb44817ac9ea906ac93efcf6863511a6d8
Signed-off-by: Braxton Mccarthy xxx@xxx.xxx


COMMENTS

author: Braxton Mccarthy
date: 2012-11-20 16:40:23.000000000

Uploaded patch set 2.

-------------------------------------
author: Brenden Conley
date: 2012-11-20 16:40:28.000000000

Patch Set 2:

Build Started https://hudson.eclipse.org/sandbox/job/linuxtools/618/ 

-------------------------------------
author: Luciana Barry
date: 2012-11-20 16:55:20.000000000

Patch Set 2: Verified; Looks good to me, approved; IP review completed

(1 inline comment)



Line:503, lttng/org.eclipse.linuxtools.tmf.ui/src/org/eclipse/linuxtools/tmf/ui/views/uml2sd/loader/TmfUml2SDSyncLoader.java -> It is ok, but I realized you could also do: editor = fView.getSite().getPage().getActiveEditor() here, if you want to use less code.

-------------------------------------
author: Ricky Reeves
date: 2012-11-20 17:00:06.000000000

Patch Set 2: Looks good to me, but someone else must approve

(1 inline comment)



Line:168, lttng/org.eclipse.linuxtools.tmf.ui/src/org/eclipse/linuxtools/tmf/ui/views/uml2sd/load/LoadersManager.java -> Node the same change was also proposed in review https://git.eclipse.org/r/#/c/8781/. The other review has a more comprehensive fix for NPEs. 
Anyways, one of us will have to rebase. Let's see who is faster :-)

-------------------------------------
author: Brenden Conley
date: 2012-11-20 17:01:56.000000000

Patch Set 2: Verified

Build Successful 

https://hudson.eclipse.org/sandbox/job/linuxtools/618/ : SUCCESS

-------------------------------------
author: Luciana Barry
date: 2012-11-20 17:09:17.000000000

Patch Set 2: I would prefer that you didn't submit this

(2 inline comments)

Hmm wait, looking at https://git.eclipse.org/r/#/c/8781/ it seems like it's actually the activeWorkbenchWindow and not the activePage that can be null during shutdown. And also, that patch is taking care of LoadersManager so perhaps we can leave it alone here...

Line:128, lttng/org.eclipse.linuxtools.tmf.ui/src/org/eclipse/linuxtools/tmf/ui/project/model/TmfProjectElement.java -> Not sure anymore, can activePage be null if activeWorkbenchWindow is ok?

Line:503, lttng/org.eclipse.linuxtools.tmf.ui/src/org/eclipse/linuxtools/tmf/ui/views/uml2sd/loader/TmfUml2SDSyncLoader.java -> Either use the suggested code, or else also would need a null check on activeWorkbenchWindow.

-------------------------------------
author: Braxton Mccarthy
date: 2012-11-20 17:58:49.000000000

Patch Set 2: (3 inline comments)



Line:128, lttng/org.eclipse.linuxtools.tmf.ui/src/org/eclipse/linuxtools/tmf/ui/project/model/TmfProjectElement.java -> I think so, in the first case we identified it  was the page that was null.

Line:503, lttng/org.eclipse.linuxtools.tmf.ui/src/org/eclipse/linuxtools/tmf/ui/views/uml2sd/loader/TmfUml2SDSyncLoader.java -> OK, I saw fView there but wasn't sure it could be used for that. I'll go with fView.getSite() then.

Line:168, lttng/org.eclipse.linuxtools.tmf.ui/src/org/eclipse/linuxtools/tmf/ui/views/uml2sd/load/LoadersManager.java -> Ok you win ;)  I'll remove this file from this patch

-------------------------------------
