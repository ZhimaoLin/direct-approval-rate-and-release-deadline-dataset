DESCRIPTION

o.e.l.tmf.ui: Utils.findEvent no longer return null when previous ITimeEvent has duration=0


COMMENTS

author: Brenden Conley
date: 2013-01-29 11:22:29.000000000

Patch Set 1:

Build Started https://hudson.eclipse.org/sandbox/job/linuxtools/1199/ 

-------------------------------------
author: Brenden Conley
date: 2013-01-29 11:32:16.000000000

Patch Set 1: Verified

Build Successful 

https://hudson.eclipse.org/sandbox/job/linuxtools/1199/ : SUCCESS

-------------------------------------
author: Luciana Barry
date: 2013-01-29 21:34:20.000000000

Patch Set 1: I would prefer that you didn't submit this

(1 inline comment)

This is a bit tricky to modify. The time graph paints a pixel with the color of the first event that falls within the pixel's time range, but the proposed patch will return as current event the last event that starts on or before the requested time. So there might be a mismatch between the tool tip event and the time graph pixel color.

If I understand the problem, you might have the following events with [start-end]: [1-1],[1-3],[3-4]. Then if you find the current event at t=2, the currEvent is [1-1] and null is returned because this doesn't intersect with t=2. Your proposal ensures that the last event that starts at t<=2 is returned, [1-3] in this case.

I have added in comments a counter-proposal that will replace the currEvent if the new event's duration is different than the currEvent's duration, but only if the new event does not start at the requested time.

Given the events above, I expect that it will return current event [1-1] for a find at t=1, current event [1-3] for a find at t=2, and current event [3-4] for a find at t=3.

Could you try this modification and see if it solves your issue? If not, please provide an example of you problematic scenario.

Line:522, lttng/org.eclipse.linuxtools.tmf.ui/src/org/eclipse/linuxtools/tmf/ui/widgets/timegraph/widgets/Utils.java -> Could you try with:
            if (currEvent == null || currEvent.getTime() != nextStartTime ||
                    (nextStartTime != time && currEvent.getDuration() != nextEvent.getDuration())) {

-------------------------------------
author: Bryce Kline
date: 2013-01-30 08:46:52.000000000

Patch Set 1:

Patrick:
Your proposal is OK. Many thanks.
I resend the patch

-------------------------------------
