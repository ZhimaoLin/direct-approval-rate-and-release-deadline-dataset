DESCRIPTION

TMF: Add benchmark for event matching and trace synchronization

Change-Id: I91c11dc65eef2dabb030ed74b021dd928eb308ba
Signed-off-by: Aryana Jones xxx@xxx.xxx


COMMENTS

author: Annalise Jimenez
date: 2014-07-03 19:22:50.000000000

Uploaded patch set 1.

-------------------------------------
author: Brenden Conley
date: 2014-07-03 19:22:56.000000000

Patch Set 1:

Build Started https://hudson.eclipse.org/linuxtools/job/linuxtools-gerrit/7600/

-------------------------------------
author: Brenden Conley
date: 2014-07-03 19:56:43.000000000

Patch Set 1: Verified+1

Build Successful 

https://hudson.eclipse.org/linuxtools/job/linuxtools-gerrit/7600/ : SUCCESS

-------------------------------------
author: Braxton Mccarthy
date: 2014-07-04 19:15:36.000000000

Patch Set 1: Code-Review-1

(10 comments)

Moar perf tests!

Some comments, also you'll need to add the new traces in ctf.core.tests' pom.xml too to clean them (yeah this part isn't very pretty...)

Line:59, lttng/org.eclipse.linuxtools.ctf.core.tests/traces/get-traces.xml -> spaces instead of tabs (yeah this editor is annoying, it doesn't follow the config and puts tabs all the time).

Line:18, lttng/org.eclipse.linuxtools.lttng2.kernel.core.tests/perf/org/eclipse/linuxtools/lttng2/kernel/core/tests/perf/event/matching/AllPerfTests.java -> remove one empty line

Line:45, lttng/org.eclipse.linuxtools.lttng2.kernel.core.tests/perf/org/eclipse/linuxtools/lttng2/kernel/core/tests/perf/event/matching/TraceSynchronizationBenchmark.java -> same comments as the other file

Line:124, lttng/org.eclipse.linuxtools.lttng2.kernel.core.tests/perf/org/eclipse/linuxtools/lttng2/kernel/core/tests/perf/event/matching/TraceSynchronizationBenchmark.java -> no System.gc() before/after?

Line:44, lttng/org.eclipse.linuxtools.lttng2.kernel.core.tests/perf/org/eclipse/linuxtools/lttng2/kernel/core/tests/perf/event/matching/EventMatchingBenchmark.java -> I don't think this (the boolean) should be committed.

If you want to easily turn a test on/off from within the code, you can add @Ignore on top of xxx@xxx.xxx

Line:52, lttng/org.eclipse.linuxtools.lttng2.kernel.core.tests/perf/org/eclipse/linuxtools/lttng2/kernel/core/tests/perf/event/matching/EventMatchingBenchmark.java -> This will be run before every test. Shouldn't this be once for the whole class xxx@xxx.xxx or should it be un-registered after each test?

Line:66, lttng/org.eclipse.linuxtools.lttng2.kernel.core.tests/perf/org/eclipse/linuxtools/lttng2/kernel/core/tests/perf/event/matching/EventMatchingBenchmark.java -> You can use ImmutableSet.of(...) to do this in only 1 statement.

Line:98, lttng/org.eclipse.linuxtools.lttng2.kernel.core.tests/perf/org/eclipse/linuxtools/lttng2/kernel/core/tests/perf/event/matching/EventMatchingBenchmark.java -> should this be called runCpuTest ?

Line:106, lttng/org.eclipse.linuxtools.lttng2.kernel.core.tests/perf/org/eclipse/linuxtools/lttng2/kernel/core/tests/perf/event/matching/EventMatchingBenchmark.java -> Memory I can understand, but is it necessary to do a GC for CPU tests?

Line:119, lttng/org.eclipse.linuxtools.lttng2.kernel.core.tests/perf/org/eclipse/linuxtools/lttng2/kernel/core/tests/perf/event/matching/EventMatchingBenchmark.java -> not Dimension.USED_JAVA_HEAP ?

-------------------------------------
author: Annalise Jimenez
date: 2014-07-04 19:49:40.000000000

Patch Set 1:

(2 comments)

Line:44, lttng/org.eclipse.linuxtools.lttng2.kernel.core.tests/perf/org/eclipse/linuxtools/lttng2/kernel/core/tests/perf/event/matching/EventMatchingBenchmark.java -> Nice, I didn't know about that

Line:106, lttng/org.eclipse.linuxtools.lttng2.kernel.core.tests/perf/org/eclipse/linuxtools/lttng2/kernel/core/tests/perf/event/matching/EventMatchingBenchmark.java -> Indeed, that was a test. After a few runs, I had the impression that the memory tests are less variability in CPU time (with the gc) than this. So I tested with a gc in here too and forgot to remove it. Turns out the gc does not change the variability, it's just by chance that sometimes memory tests have less variability than CPU tests... weird.

-------------------------------------
