DESCRIPTION

ctf: replace hashmaps with arraylists for eventdeclaration storage

Change-Id: I088943c5a041f16638cb89b832ab79f8ef9c1d76
Signed-off-by: Ivy Mitchell xxx@xxx.xxx


COMMENTS

author: Ivy Mitchell
date: 2014-08-04 01:17:17.000000000

Uploaded patch set 6.

-------------------------------------
author: Brenden Conley
date: 2014-08-04 01:17:24.000000000

Patch Set 6:

Build Started https://hudson.eclipse.org/linuxtools/job/linuxtools-gerrit/8053/

-------------------------------------
author: Brenden Conley
date: 2014-08-04 01:19:40.000000000

Patch Set 6: Verified-1

Build Failed 

https://hudson.eclipse.org/linuxtools/job/linuxtools-gerrit/8053/ : FAILURE

-------------------------------------
author: Brenden Conley
date: 2014-08-04 01:37:18.000000000

Patch Set 6: -Verified

Build Started https://hudson.eclipse.org/linuxtools/job/linuxtools-gerrit/8055/

-------------------------------------
author: Ivy Mitchell
date: 2014-08-04 01:44:45.000000000

Patch Set 6:

(2 comments)

more replies

Line:474, lttng/org.eclipse.linuxtools.ctf.core/src/org/eclipse/linuxtools/ctf/core/trace/CTFTrace.java -> through inspection of the debugger it appears the copy was utterly useless.

Line:339, lttng/org.eclipse.linuxtools.ctf.core/src/org/eclipse/linuxtools/ctf/core/trace/CTFStream.java -> the index is the event id. so it can be done later assuming list1 and list2 don't overlap

-------------------------------------
author: Brenden Conley
date: 2014-08-04 02:10:14.000000000

Patch Set 6: Verified-1

Build Failed 

https://hudson.eclipse.org/linuxtools/job/linuxtools-gerrit/8055/ : FAILURE

-------------------------------------
author: Brenden Conley
date: 2014-08-04 03:23:27.000000000

Patch Set 6: -Verified

Build Started https://hudson.eclipse.org/linuxtools/job/linuxtools-gerrit/8060/

-------------------------------------
author: Brenden Conley
date: 2014-08-04 03:58:13.000000000

Patch Set 6: Verified+1

Build Successful 

https://hudson.eclipse.org/linuxtools/job/linuxtools-gerrit/8060/ : SUCCESS

-------------------------------------
author: Luciana Barry
date: 2014-08-04 15:41:05.000000000

Patch Set 6: Code-Review-1

(2 comments)

Line:256, lttng/org.eclipse.linuxtools.ctf.core/src/org/eclipse/linuxtools/ctf/core/trace/CTFStream.java -> How is the receiver supposed to know what a blank hole is? Won't CtfTmfTrace receive the holes, is this ok? I think, for now, this method is called only once. Surely filtering nulls won't be worse than redoing the immutable list for every added event.

Line:339, lttng/org.eclipse.linuxtools.ctf.core/src/org/eclipse/linuxtools/ctf/core/trace/CTFStream.java -> Could just call addEvent on each element

-------------------------------------
author: Ivy Mitchell
date: 2014-08-04 18:00:01.000000000

Patch Set 6:

(2 comments)

Line:256, lttng/org.eclipse.linuxtools.ctf.core/src/org/eclipse/linuxtools/ctf/core/trace/CTFStream.java -> rebuilding a list is done in the metadata reading phase. this happens once per trace normally. This fct is called for each event. Ctftmftrace will not call stuff with the holes unless the trace is corrupt. It will throw ctfreaderexceptions first though

Line:339, lttng/org.eclipse.linuxtools.ctf.core/src/org/eclipse/linuxtools/ctf/core/trace/CTFStream.java -> no, we could merge for(int i =0; i < Min(fEvents.size() , events.size); i++){
if( fEvents.get(i) == unassigned ) fEvents.set(events.get(i));

-------------------------------------
author: Luciana Barry
date: 2014-08-04 20:59:51.000000000

Patch Set 6:

(2 comments)

Line:256, lttng/org.eclipse.linuxtools.ctf.core/src/org/eclipse/linuxtools/ctf/core/trace/CTFStream.java -> I thought this method getEventDeclarations() is called only once, addEvent() is called many times (once per event type), and getEventDeclaration(int) is called for each event in the trace.

Line:339, lttng/org.eclipse.linuxtools.ctf.core/src/org/eclipse/linuxtools/ctf/core/trace/CTFStream.java -> I was thinking simply:
for (IEventDeclaration event : events) {
  addEvent(event);
}?

-------------------------------------
author: Ivy Mitchell
date: 2014-08-05 20:56:42.000000000

Patch Set 6:

(1 comment)

Line:256, lttng/org.eclipse.linuxtools.ctf.core/src/org/eclipse/linuxtools/ctf/core/trace/CTFStream.java -> you have a point, hmm, this requires more vespene thought

-------------------------------------
author: Gerrit Code Review
date: 2014-08-14 00:47:25.000000000

The change could not be merged due to a path conflict.

Please rebase the change locally and upload the rebased commit for review.

-------------------------------------
