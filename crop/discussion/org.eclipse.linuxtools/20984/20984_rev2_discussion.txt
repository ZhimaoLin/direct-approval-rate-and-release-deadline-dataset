DESCRIPTION

tmf: Fix reading HTNodes while the tree is being built

A race condition could occur if a node would receive a query
after closeThisNode() was called, but before it was finished
writing itself to disk (in writeSelf()). It would result in
BufferUnderflowException's.

The important part of this patch is moving the "isDone" from
closeThisNode() to the end of writeSelf().

Also renamed the flag to isOnDisk, to reflect better what it
represents. It wouldn't even need to be written to the file,
but since a change in the file format is due soon-ish, might
as well change it all at the same time.

Change-Id: Ib22e3d56538057c7b3fd6655d32597b524fd8b28
Signed-off-by: Braxton Mccarthy xxx@xxx.xxx


COMMENTS

author: Ivy Mitchell
date: 2014-01-27 15:19:06.000000000

Uploaded patch set 2.

-------------------------------------
author: Brenden Conley
date: 2014-01-27 15:19:12.000000000

Patch Set 2:

Build Started https://hudson.eclipse.org/linuxtools/job/linuxtools-gerrit/5194/

-------------------------------------
author: Brenden Conley
date: 2014-01-27 16:10:39.000000000

Patch Set 2: Verified+1

Build Successful 

https://hudson.eclipse.org/linuxtools/job/linuxtools-gerrit/5194/ : SUCCESS

-------------------------------------
author: Luciana Barry
date: 2014-01-27 18:57:34.000000000

Patch Set 2: Verified+1 Code-Review+1 IP-Clean+1

Seems to fix the BufferUnderflowException during live reading.

-------------------------------------
author: Braxton Mccarthy
date: 2014-01-27 19:37:44.000000000

Patch Set 2: Code-Review+2

-------------------------------------
