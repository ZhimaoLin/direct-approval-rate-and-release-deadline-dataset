DESCRIPTION

indexer: async commit/snapshot in storage manager

storage manager does async commit/snapshot operation.
This allows to service the get snapshot request concurrently
while the long commit operation is in progress.
Also commits for multiple buckets can run in parallel.

Change-Id: I758ab60dfde054bf737129a23e5a804188eefbcd


COMMENTS

author: Maliyah Fischer
date: 2015-02-27 17:38:08.628000000

Uploaded patch set 1.

-------------------------------------
author: Dominique Stanton
date: 2015-02-27 18:00:42.900000000

Patch Set 1: Code-Review+1

-------------------------------------
author: Kinsley Fox
date: 2015-02-27 19:42:24.017000000

Patch Set 1:

(1 comment)

Line:218, secondary/indexer/storage_manager.go -> What would be the affect of async snapshot creation on inmemory snapshots ?
Flusher should wait until in-memory snapshot is created before inserting anymore doc into forestdb.

For creating in-memory snapshot, remember that we specify a in-memory flag instead of sequence number so that it automatically creates the snapshot with latest current sequence number. If we do not wait for snapshot to be created before inserting any item, it may create in-memory snapshot at a different timestamp.

-------------------------------------
author: Maliyah Fischer
date: 2015-02-28 03:13:56.747000000

Patch Set 1:

(1 comment)

Line:218, secondary/indexer/storage_manager.go -> Once flusher is done, the message comes to storage manager for commit/snapshot. Next flush message gets generated by timekeeper only after storage manager sends done. So at no point, flusher and storage manager work together on a slice.

-------------------------------------
author: Kinsley Fox
date: 2015-02-28 07:20:24.261000000

Patch Set 1: Code-Review+2

-------------------------------------
author: Maliyah Fischer
date: 2015-02-28 12:59:28.261000000

Patch Set 2: Patch Set 1 was rebased

-------------------------------------
author: Tate Garrett
date: 2015-02-28 13:00:02.639000000

Change has been successfully merged into the git repository.

-------------------------------------
