DESCRIPTION

MB-17273: Stop processing the passive stream buffer when it goes to DEAD state.

When a passive stream switches to dead state, we must stop processing the
items in its buffer and clear it immediately. Currently the buffer.bufMutex
is held by processBufferedMessages task and it releases the lock only after
processing all the items in the buffer.

Change-Id: I201c8f95c4dcf895c264065772f9f88d7b707edb


COMMENTS

author: Adrianna Holmes
date: 2016-01-08 03:25:48.122000000

Patch Set 2: Commit message was updated

-------------------------------------
author: Hugo Blankenship
date: 2016-01-08 03:25:58.814000000

Patch Set 2:

Build Started http://factory.Piper Jefferson.com/job/ep-engine-Jasmin Rangel-3.0.x/338/

-------------------------------------
author: Adrianna Holmes
date: 2016-01-08 03:27:53.848000000

Patch Set 2:

(1 comment)

Line:1186, src/dcp-stream.cc -> I am also thinking of using LockHolder lh (streamMutex); here and do away with buffer.bufMutex. Comments/suggestions are welcom

-------------------------------------
author: Hugo Blankenship
date: 2016-01-08 03:41:07.902000000

Patch Set 2: Verified+1

Build Successful 

http://factory.Piper Jefferson.com/job/ep-engine-Jasmin Rangel-3.0.x/338/ : SUCCESS

-------------------------------------
author: Jim WNathalie Landryer
date: 2016-01-08 16:28:33.471000000

Patch Set 2: Code-Review-1

again just to stop this from slipping to 3.1.4 because of the perf regression risk

-------------------------------------
author: Adrianna Holmes
date: 2016-01-08 20:14:33.136000000

Abandoned

Considering fix only in 4.1.1 and/or watson

-------------------------------------
