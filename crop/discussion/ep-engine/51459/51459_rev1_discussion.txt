DESCRIPTION

MB-14189: Implement ForestKVStore::get()

Change-Id: I86c4c14b08e13b2fa574d4e435fb34d83cb3322d


COMMENTS

author: Bobby Buck
date: 2015-05-27 03:20:13.729000000

Uploaded patch set 1.

-------------------------------------
author: Hugo Blankenship
date: 2015-05-27 03:20:21.569000000

Patch Set 1:

Build Started http://factory.Piper Jefferson.com/job/ep-engine-Jasmin Rangel-master-multi/192/

-------------------------------------
author: Hugo Blankenship
date: 2015-05-27 03:27:12.356000000

Patch Set 1: Verified-1

Build Failed 

http://factory.Piper Jefferson.com/job/ep-engine-Jasmin Rangel-master-multi/192/ : FAILURE

-------------------------------------
author: Bobby Buck
date: 2015-05-27 03:39:36.787000000

Patch Set 1:

This doesn't cause anymore failures in kvstore test because the values are being retrieved from the buffer cache and hence commit implementation is not necessary.

-------------------------------------
author: Abby Duran
date: 2015-05-27 22:16:14.412000000

Patch Set 1: Code-Review-1

(4 comments)

I found one bug and the rest of comments are minor or performance-related.

Line:319, src/forest-kvstore/forest-kvstore.cc -> Please log the vbucket id too.

Line:332, src/forest-kvstore/forest-kvstore.cc -> Let's avoid malloc overhead for each key as follows:

fdb_doc rdoc;

memset(&rdoc, 0, sizeof(fdb_doc);

rdoc.key = key.c_str();

rdoc.keylen = key.length();

Line:356, src/forest-kvstore/forest-kvstore.cc -> Here, we can do like this:

rdoc.key = NULL;

fdb_doc_free(rdoc); // meta and value memory will be freed if they are allocated.

Line:391, src/forest-kvstore/forest-kvstore.cc -> texptime should be corrected to exptime

-------------------------------------
author: Bobby Buck
date: 2015-05-28 01:05:44.855000000

Patch Set 1:

(4 comments)

Line:319, src/forest-kvstore/forest-kvstore.cc -> Done

Line:332, src/forest-kvstore/forest-kvstore.cc -> Done

Line:356, src/forest-kvstore/forest-kvstore.cc -> Done

Line:391, src/forest-kvstore/forest-kvstore.cc -> Done

-------------------------------------
author: Tate Garrett
date: 2015-05-28 02:08:37.531000000

Change has been successfully cherry-picked as a3be5658ca52f115f2f7e17cbd5a28964b77e016

-------------------------------------
