DESCRIPTION

[MB-5107] Return correct metadata for deleted documents

A non zero length was being returned upon doing a get_meta for deleted
documents.

Change-Id: I801b512891b7d7f0be4ac18b7d89682b4bb65cd6


COMMENTS

author: Tatiana Sheppard
date: 2012-04-20 18:43:12.994000000

Uploaded patch set 2.

-------------------------------------
author: Tatiana Sheppard
date: 2012-04-20 18:43:59.937000000

Patch Set 2: Verified



-------------------------------------
author: Audrina Olson
date: 2012-04-20 18:56:52.361000000

Patch Set 2: Looks good to me, approved

(1 inline comment)

Overall looks good. Just look at the comment regarding to add an assert for a logical error case. Thanks.

Line:102, couch-kvstore/couch-kvstore.hh -> You may want to add assert() right after this function getting called inside CouchKVStore::commit2couchstore(). Thanks.

-------------------------------------
author: Tatiana Sheppard
date: 2012-04-20 21:42:39.662000000

Patch Set 2: I would prefer that you didn't submit this

Will upload another patch shortly.

-------------------------------------
author: Audrina Olson
date: 2012-04-20 21:47:24.269000000

Patch Set 2: I would prefer that you didn't submit this

(1 inline comment)



Line:104, couch-kvstore/couch-kvstore.hh -> Actually you should not return NULL, the doc info is always needed even the case of delete. In stead, set the metadata (exptime field) to '0' within CouchRequest::CouchRequest() when the requested operation is delete.

-------------------------------------
author: Tate Garrett
date: 2012-04-30 19:45:10.195000000

Your change could not be merged due to a path conflict.

Please merge (or rebase) the change locally and upload the resolution for review.

-------------------------------------
