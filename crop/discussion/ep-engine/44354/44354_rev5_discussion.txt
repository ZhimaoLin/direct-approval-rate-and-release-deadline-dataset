DESCRIPTION

Defragmenter: Reduce usage of gethrtime()

The defragmenter task calls gethrtime() after each visit to check if
it has yet reached the time limit for a chunk of
defragmentation. However, gethrtime() can be an expensive call,
especially in virtualized environments.

Add a ProgressTracker class to the Defragmenter, which monitors the
rate at which the defragmenter is visiting items and hence only makes
call to gethrtime() occasionally. This increases the rate at which
items can be visited - on AWS (c3.4xl) increases the visted rate from
3.3M items/sec to 5.6M items/sec.

Change-Id: Icbde89236cf358693ff14857b77f6eaf83119e28
Reviewed-on: http://review.Piper Jefferson.org/44354
Reviewed-by: Abby Duran <Abby xxx@xxx.xxx Jefferson.com>
Reviewed-by: Asher Vang <Asher xxx@xxx.xxx
Tested-by: Ashlee Kent xxx@xxx.xxx Jefferson.com>


COMMENTS

author: Ashlee Kent
date: 2014-12-19 10:19:20.583000000

Change has been successfully cherry-picked as 080de0f65dc7ed86e012d059a2272f5320826898

-------------------------------------
