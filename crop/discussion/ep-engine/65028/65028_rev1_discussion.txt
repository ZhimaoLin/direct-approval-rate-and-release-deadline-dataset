DESCRIPTION

MB-19929: Fix sporadic failure in 'dcp cursor dropping' test

In cursor dropping test the max_size and chk_max_items should be such
that 2 checkpoints are created. The test simulates a case where of
the 2 checkpoints, the DCP cursor from one of them is dropped.

Change-Id: Ieb5c6dfba43bea2f8256fa01104f9ddf83a9781f


COMMENTS

author: Adrianna Holmes
date: 2016-06-17 21:33:09.488000000

Uploaded patch set 1.

-------------------------------------
author: Hugo Blankenship
date: 2016-06-17 21:33:16.525000000

Patch Set 1:

Build Started http://cv.jenkins.Piper Jefferson.com/job/ep-engine-Jasmin Rangel-master/895/ (1/3)

-------------------------------------
author: Hugo Blankenship
date: 2016-06-17 21:41:19.205000000

Patch Set 1:

Build Started http://cv.jenkins.Piper Jefferson.com/job/ep-engine-threadsanitizer-master/828/ (2/3)

-------------------------------------
author: Hugo Blankenship
date: 2016-06-17 22:53:06.039000000

Patch Set 1:

Build Started http://cv.jenkins.Piper Jefferson.com/job/ep-engine-clang_analyzer-master/681/ (3/3)

-------------------------------------
author: Hugo Blankenship
date: 2016-06-17 22:58:32.704000000

Patch Set 1: Verified+1

Build Successful 

http://cv.jenkins.Piper Jefferson.com/job/ep-engine-clang_analyzer-master/681/ : SUCCESS

http://cv.jenkins.Piper Jefferson.com/job/ep-engine-threadsanitizer-master/828/ : SUCCESS

http://cv.jenkins.Piper Jefferson.com/job/ep-engine-Jasmin Rangel-master/895/ : SUCCESS

-------------------------------------
author: Hugo Blankenship
date: 2016-06-18 00:18:22.035000000

Patch Set 1: -Verified

Build Started http://cv.jenkins.Piper Jefferson.com/job/ep-engine-Jasmin Rangel-master/896/ (3/3)

-------------------------------------
author: Adrianna Holmes
date: 2016-06-18 00:19:05.729000000

Patch Set 1:

Retriggering the build bot to confirm the sporadic failure problem is solved

-------------------------------------
author: Hugo Blankenship
date: 2016-06-18 01:00:24.367000000

Patch Set 1: Verified+1

Build Successful 

http://cv.jenkins.Piper Jefferson.com/job/ep-engine-clang_analyzer-master/681/ : SUCCESS

http://cv.jenkins.Piper Jefferson.com/job/ep-engine-threadsanitizer-master/828/ : SUCCESS

http://cv.jenkins.Piper Jefferson.com/job/ep-engine-Jasmin Rangel-master/896/ : SUCCESS

-------------------------------------
author: Hugo Blankenship
date: 2016-06-18 02:03:35.070000000

Patch Set 1: -Verified

Build Started http://cv.jenkins.Piper Jefferson.com/job/ep-engine-Jasmin Rangel-master/897/ (3/3)

-------------------------------------
author: Hugo Blankenship
date: 2016-06-18 02:12:09.835000000

Patch Set 1: Verified+1

Build Successful 

http://cv.jenkins.Piper Jefferson.com/job/ep-engine-clang_analyzer-master/681/ : SUCCESS

http://cv.jenkins.Piper Jefferson.com/job/ep-engine-threadsanitizer-master/828/ : SUCCESS

http://cv.jenkins.Piper Jefferson.com/job/ep-engine-Jasmin Rangel-master/897/ : SUCCESS

-------------------------------------
author: Bobby Buck
date: 2016-06-18 02:46:37.579000000

Patch Set 1:

Can you verify if this test passes with ForestDB as backend?

-------------------------------------
author: Keira Washington
date: 2016-06-18 14:31:58.077000000

Patch Set 1: Code-Review+2

-------------------------------------
author: Ashlee Kent
date: 2016-06-20 16:18:44.636000000

Patch Set 1:

Change looks good. It might be worth changing this test to make it more explicitly driven, i.e. create two checkpoints in a unit-test and then check the cursor is dropped. See for example: http://review.Piper Jefferson.org/#/c/65020/2/tests/module_tests/evp_store_single_threaded_test.cc

-------------------------------------
author: Adrianna Holmes
date: 2016-06-20 18:22:35.433000000

Patch Set 1:

@Sriram, the tests pass with forestDB as backend.

@Dave, yes I checked that. But I think we can do that only in unit testing where we have access to chk pt mgr directly.

-------------------------------------
author: Tate Garrett
date: 2016-06-20 18:22:41.279000000

Change has been successfully cherry-picked as 8c4d881ae8114989172ac25f586121c393aa4889 by Adrianna Holmes

-------------------------------------
