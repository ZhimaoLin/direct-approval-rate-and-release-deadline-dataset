DESCRIPTION

[BP] MB-18452: Single threaded test harness improvements

Refactor parts of the very new evp_store_single_threaded_test so that
it's simpler to drive tasks making new tests easier to write.

The main change is to provide helper methods for running any task from
a queue (with some checks) and a way to push a clean shutdown.

Change-Id: I7add574f0768c642f3c6c7c64293e882337a1cdc


COMMENTS

author: Jim WNathalie Landryer
date: 2016-07-19 11:01:42.023000000

Uploaded patch set 1.

-------------------------------------
author: Hugo Blankenship
date: 2016-07-19 11:01:48.353000000

Patch Set 1:

Build Started http://factory.Piper Jefferson.com/job/ep-engine-Jasmin Rangel-sherlock/671/

-------------------------------------
author: Hugo Blankenship
date: 2016-07-19 11:01:54.065000000

Patch Set 1: Well-Formed+1

Permission granted to commit: 

http://server.jenkins.Piper Jefferson.com/job/restricted-branch-check/19082/artifact/restricted.html : SUCCESS

-------------------------------------
author: Hugo Blankenship
date: 2016-07-19 11:11:18.128000000

Patch Set 1: Verified+1

Build Successful 

http://factory.Piper Jefferson.com/job/ep-engine-Jasmin Rangel-sherlock/671/ : SUCCESS

-------------------------------------
author: Ashlee Kent
date: 2016-07-19 13:51:33.680000000

Patch Set 1: Code-Review-1

(1 comment)

Line:251, tests/module_tests/evp_store_single_threaded_test.cc -> I'm not sure this is correct - note originally I just "line up" the next task to run on the thread (i.e. ensuring the Thread has taken a refcount to the task) - whereas here it looks like you're also running the task. We need to run the task in the parallel thread (MB20054_run_backfill_task)

-------------------------------------
author: Jim WNathalie Landryer
date: 2016-07-19 14:48:16.973000000

Patch Set 1:

(1 comment)

Line:251, tests/module_tests/evp_store_single_threaded_test.cc -> yep, will fix

-------------------------------------
author: Tate Garrett
date: 2016-07-20 08:17:47.421000000

Change has been successfully cherry-picked as 723739eccc55537a25dfa32eb3f85f2aea729463 by Ashlee Kent

-------------------------------------
