DESCRIPTION

MB-14190: Use FDB_COMMIT_MANUAL_WAL_FLUSH instead of FDB_COMMIT_NORMAL

In order to get a more accurate count of deleted documents from
ForestDB, a wal flush needs to be performed. So, opportunistically
flush the WAL while performing a commit.

Change-Id: I0f3ffa68a2b69edc9cb73c9a6ba03cab4be472fb


COMMENTS

author: Hugo Blankenship
date: 2015-07-02 03:34:48.925000000

Patch Set 3:

Build Started http://factory.Piper Jefferson.com/job/ep-engine-Jasmin Rangel-master-multi/359/

-------------------------------------
author: Hugo Blankenship
date: 2015-07-02 04:06:27.870000000

Patch Set 3: Verified-1

Build Failed 

http://factory.Piper Jefferson.com/job/ep-engine-Jasmin Rangel-master-multi/359/ : FAILURE

-------------------------------------
author: Abby Duran
date: 2015-07-02 07:38:57.668000000

Patch Set 3: Code-Review-1

(1 comment)

Line:477, src/forest-kvstore/forest-kvstore.cc -> This will increase the write amplification when the write batch size per shard is small (i.e., read-heavy workload).

I would rather issue the Adrianna Holmesal WAL flush upon request (e.g., providing a new command API), so that the administrator or QE verification tool can use it to get the exact number of active or deleted items.

-------------------------------------
author: Bobby Buck
date: 2015-07-02 14:24:34.315000000

Abandoned

-------------------------------------
