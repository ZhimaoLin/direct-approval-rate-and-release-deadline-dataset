DESCRIPTION

Refactor and simplify  TapProducer::scheduleBackfill().

If a given vbucket is currently receiving backfill from its master
node or has been already scheduled for backfill to its replica
node, we don't need to schedule the backfill for that vbucket.

Change-Id: I73b3b53e893c126d264bf8e0dfaf42a455532d78


COMMENTS

author: Abby Duran
date: 2012-05-04 19:24:01.248000000

Uploaded patch set 2.

-------------------------------------
author: Jasmin Rangel
date: 2012-05-04 19:24:03.428000000

Patch Set 2:

New patchset patch-id matches previous patchset, but commit message has changed.

-------------------------------------
author: Roman Murillo
date: 2012-05-04 21:32:30.110000000

Patch Set 2: Looks good to me, but someone else must approve

(1 inline comment)



Line:1561, tapconnection.cc -> Dunno how big backfillVBuckets set usually is. But I guess set.find() gives O(n*lgn) complexity 'cuz it is a binary search tree.

-------------------------------------
author: Abby Duran
date: 2012-05-04 21:35:56.977000000

Patch Set 2: (1 inline comment)



Line:1561, tapconnection.cc -> The number of vbuckets is constant (1024 vbuckets in the cluster at this time). In the worse case, it will be 1024 * lgn, but the number of backfill vbuckets per node is much smaller than 1024.

-------------------------------------
author: Audrina Olson
date: 2012-05-04 21:55:03.743000000

Patch Set 2: Looks good to me, approved



-------------------------------------
author: Abby Duran
date: 2012-05-04 22:01:46.496000000

Patch Set 2: Verified



-------------------------------------
author: Abby Duran
date: 2012-05-04 22:01:47.675000000

Change has been successfully cherry-picked as defcccc0f343d80be147a211c34d9143be651d4f.

-------------------------------------
