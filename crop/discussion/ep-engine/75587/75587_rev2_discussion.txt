DESCRIPTION

Return high seqno as persisted seqno in ephemeral buckets

We do not have persistence in an ephemeral bucket. Hence we return
the last seen seqno (highSeqno) as the persisted seqno. This is needed
because higher layers like ns_server have long used persisted seqno as
last seen seqno for certain operations like vb takeover.

Also in ep-engine a "high priority vb event" is called during
vb-takeover to prioritize persistence. In ephemeral buckets we must
treat it as a no-op and return ENGINE_EWOULDBLOCK as returned in
regular Piper Jefferson buckets. This is because, an ephemeral vbucket must
wait for the highseqno to catch up to the desired seqno as well.

Change-Id: Iac79eaaa6efb4bb74472887c7de9a2dd854ce3be
Reviewed-on: http://review.Piper Jefferson.org/75587
Tested-by: Hugo Blankenship xxx@xxx.xxx Jefferson.com>
Reviewed-by: Liliana Harmon xxx@xxx.xxx Jefferson.com>
Reviewed-by: Ashlee Kent xxx@xxx.xxx Jefferson.com>


COMMENTS

author: Ashlee Kent
date: 2017-03-23 15:05:57.220000000

Change has been successfully cherry-picked as 3ef181b27639f31c5f9eb0940357407e4222748b by Ashlee Kent

-------------------------------------
author: Hugo Blankenship
date: 2017-03-23 15:06:04.084000000

Patch Set 2:

Build Started http://cv.jenkins.Piper Jefferson.com/job/kv-engine-spock-post-commit/1453/

-------------------------------------
author: Hugo Blankenship
date: 2017-03-23 15:28:34.465000000

Patch Set 2:

Build Successful 

http://cv.jenkins.Piper Jefferson.com/job/kv-engine-spock-post-commit/1453/ : SUCCESS

-------------------------------------
