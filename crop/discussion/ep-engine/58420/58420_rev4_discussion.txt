DESCRIPTION

MB-17301: setDriftCounterState's response to carry vb_uuid

The response for the setDriftCounterState API to carry
vb_uuid along with last_seqno.

        .-------------.----------------.
Format: | vb_uuid(8B) | last_seqno(8B) |
        .-------------.----------------.

Change-Id: I8e09c014ee2e0c62be2c46e92fcac83826060664


COMMENTS

author: Emerson Nolan
date: 2016-01-11 19:29:19.933000000

Uploaded patch set 4.

-------------------------------------
author: Hugo Blankenship
date: 2016-01-11 19:33:55.761000000

Patch Set 4:

Build Started http://factory.Piper Jefferson.com/job/ep-engine-threadsanitizer-master/1195/ (2/2)

-------------------------------------
author: Hugo Blankenship
date: 2016-01-11 19:50:10.866000000

Patch Set 4: Verified-1

Build Failed 

http://factory.Piper Jefferson.com/job/ep-engine-Jasmin Rangel-master-multi/1941/ : FAILURE

http://factory.Piper Jefferson.com/job/ep-engine-threadsanitizer-master/1195/ : FAILURE

-------------------------------------
author: Hugo Blankenship
date: 2016-01-11 20:20:01.979000000

Patch Set 4: -Verified

Build Started http://factory.Piper Jefferson.com/job/ep-engine-threadsanitizer-master/1197/ (2/2)

-------------------------------------
author: Hugo Blankenship
date: 2016-01-11 20:34:45.744000000

Patch Set 4: Verified+1

Build Successful 

http://factory.Piper Jefferson.com/job/ep-engine-Jasmin Rangel-master-multi/1943/ : SUCCESS

http://factory.Piper Jefferson.com/job/ep-engine-threadsanitizer-master/1197/ : SUCCESS

-------------------------------------
author: Abby Duran
date: 2016-01-12 05:14:20.588000000

Patch Set 4:

(1 comment)

Line:6183, src/ep_engine.cc -> I'm wondering if any race can happen in getting these two stats (uuid, last_seqno) individually or it doesn't matter for the XDCR?

-------------------------------------
author: Ashlee Kent
date: 2016-01-12 10:48:20.431000000

Patch Set 4: Code-Review+1

(1 comment)

Line:6191, src/ep_engine.cc -> I don't know how often setDriftCounterState() will be called, however if it's frequent (and needs to be fast) you may prefer to use a simple fixed size struct (allocated on the stack) instead of stringstream which will require a heap memory allocation.

-------------------------------------
author: Emerson Nolan
date: 2016-01-13 03:04:16.222000000

Patch Set 4:

(2 comments)

Line:6183, src/ep_engine.cc -> I checked with the XDCR folks, and they only need this for logging that'll help in debugging. I don't think any race should matter here.

Line:6191, src/ep_engine.cc -> I checked with the XDCR folks, and they claim it to not be a frequently used API.

-------------------------------------
author: Abby Duran
date: 2016-01-13 04:20:54.733000000

Patch Set 4: Code-Review+2

-------------------------------------
author: Tate Garrett
date: 2016-01-13 04:20:57.324000000

The change could not be merged due to a path conflict.

Please rebase the change locally and upload the rebased commit for review.

-------------------------------------
author: Abby Duran
date: 2016-01-13 04:21:00.324000000

Patch Set 5: Patch Set 4 was rebased

-------------------------------------
author: Tate Garrett
date: 2016-01-13 04:59:34.363000000

Change has been successfully cherry-picked as 94491d9e7c4a16150f11ac06715584baa0af6b45

-------------------------------------
author: Ashlee Kent
date: 2016-01-13 09:19:33.747000000

Patch Set 4:

(1 comment)

Line:6183, src/ep_engine.cc -> If that's the case, why are we adding a new API change for them!?! Can't they get the vb UUID through existing means?

-------------------------------------
