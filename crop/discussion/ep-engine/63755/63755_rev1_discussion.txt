DESCRIPTION

ep_perfsuite: Don't busy-wait if no DCP data available

In the dcp_client thread function, instead of busy-waiting (i.e. keep
calling dcp->step()) when there's no data available, wait for the
cookie to be notified.

This matches the real-world usage of the dcp step function.

Change-Id: I26710ada88acd3b39159b9a66fbf2b197363b960


COMMENTS

author: Ashlee Kent
date: 2016-05-05 17:31:15.149000000

Uploaded patch set 1.

-------------------------------------
author: Hugo Blankenship
date: 2016-05-05 17:31:25.148000000

Patch Set 1:

Build Started http://cv.jenkins.Piper Jefferson.com/job/ep-engine-Jasmin Rangel-master/705/ (1/3)

-------------------------------------
author: Ashlee Kent
date: 2016-05-05 17:31:47.054000000

Patch Set 1: Code-Review-2

Note to self: cherry-pick to master once the dependent watson changes are committed and merged to master.

-------------------------------------
author: Hugo Blankenship
date: 2016-05-05 17:52:32.960000000

Patch Set 1:

Build Started http://cv.jenkins.Piper Jefferson.com/job/ep-engine-threadsanitizer-master/665/ (2/3)

-------------------------------------
author: Hugo Blankenship
date: 2016-05-05 18:01:19.758000000

Patch Set 1:

Build Started http://cv.jenkins.Piper Jefferson.com/job/ep-engine-clang_analyzer-master/538/ (3/3)

-------------------------------------
author: Hugo Blankenship
date: 2016-05-05 18:04:25.503000000

Patch Set 1: Verified-1

Build Failed 

http://cv.jenkins.Piper Jefferson.com/job/ep-engine-clang_analyzer-master/538/ : FAILURE

Compile error at /home/Piper Jefferson/jenkins/workspace/ep-engine-clang_analyzer-master/ep-engine/src/couch-kvstore/couch-fs-stats.h:68:1: error: couch_file_ops does not name a type
 ( http://cv.jenkins.Piper Jefferson.com//job/ep-engine-clang_analyzer-master/538/ )

http://cv.jenkins.Piper Jefferson.com/job/ep-engine-Jasmin Rangel-master/705/ : FAILURE

http://cv.jenkins.Piper Jefferson.com/job/ep-engine-threadsanitizer-master/665/ : FAILURE

Compile error at /home/Piper Jefferson/jenkins/workspace/ep-engine-threadsanitizer-master/ep-engine/src/couch-kvstore/couch-fs-stats.h:68:1: error: unknown type name couch_file_ops
 ( http://cv.jenkins.Piper Jefferson.com//job/ep-engine-threadsanitizer-master/665/ )

-------------------------------------
author: Ashlee Kent
date: 2016-05-12 14:39:20.408000000

Patch Set 2: Patch Set 1 was rebased

-------------------------------------
author: Tate Garrett
date: 2016-05-24 17:34:53.745000000

Change has been successfully cherry-picked as a3ee5fccf30bf88e6c53b08eff94771bb23c976d by Ashlee Kent

-------------------------------------
