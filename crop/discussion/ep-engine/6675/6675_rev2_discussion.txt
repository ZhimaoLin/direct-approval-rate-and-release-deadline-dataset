DESCRIPTION

Don't push any backfill items into the current open checkpoint.

We observed that pushing all backfill items into the current open
checkpoint causes OOM in the destination node in heavy DGM during
or after rebalance. This change fixes this issue by having a
separate backfill queue per vbucket and pushing all backfill items
directly into the outgoing persistence queue.

Change-Id: I70a9a7fe8a48ca3bced556109b9f2cfd1e3fc28a


COMMENTS

author: Abby Duran
date: 2011-05-31 11:52:42.711000000

Uploaded patch set 2.

-------------------------------------
author: Rubi Walsh
date: 2011-05-31 19:05:17.855000000

Patch Set 2: (2 inline comments)



Line:241, tapconnection.cc -> Is the old logic more fault tolerant and less chance for data loss?

Line:175, vbucket.hh -> Need to call vb->doStatsForFlushing()

-------------------------------------
author: Rubi Walsh
date: 2011-05-31 19:09:52.006000000

Patch Set 2: Looks good to me, approved



-------------------------------------
author: Abby Duran
date: 2011-05-31 19:51:10.701000000

Patch Set 2: Verified



-------------------------------------
author: Abby Duran
date: 2011-05-31 19:51:10.853000000

Change has been successfully cherry-picked as 15ec22731fff98d898450abcccdd50e2cef799ea.

-------------------------------------
