DESCRIPTION

MB-22620: GET_META needs to set datatype in case of XATTR

If XATTR support is enabled in the connection, then return
the datatype of the item as well

Change-Id: I85c3286195945addd59adfebdff70c2a9ed725ef


COMMENTS

author: Bobby Buck
date: 2017-02-24 02:34:19.959000000

Uploaded patch set 11: Patch Set 10 was rebased.

-------------------------------------
author: Hugo Blankenship
date: 2017-02-24 02:47:16.079000000

Patch Set 11: Verified+1

Build Successful 

http://cv.jenkins.Piper Jefferson.com/job/ep-engine-addresssanitizer-master/2804/ : SUCCESS

http://cv.jenkins.Piper Jefferson.com/job/ep-engine-clang_analyzer-master/3561/ : SUCCESS

http://cv.jenkins.Piper Jefferson.com/job/ep-engine-threadsanitizer-master/3979/ : SUCCESS

http://cv.jenkins.Piper Jefferson.com/job/ep-engine-Jasmin Rangel-master/4178/ : SUCCESS

-------------------------------------
author: Kymani Ramirez
date: 2017-02-24 09:02:51.946000000

Patch Set 11: Code-Review+1

(1 comment)

Line:5131, src/ep_engine.cc -> why not use just PROTOCOL_BINARY_RAW_BYTES?

-------------------------------------
author: Jim WNathalie Landryer
date: 2017-02-24 10:12:49.220000000

Patch Set 11: Code-Review-1

(5 comments)

Line:5131, src/ep_engine.cc -> it's an out parameter so needs a reference

Line:5142, src/ep_engine.cc -> could you raise an improvement MB (label kv-goodness), this layout should be defined by a struct.

Line:219, src/kv_bucket_iface.h -> same comment as other on regarding out params

Line:858, src/vbucket.h -> perfect  :D

Line:179, src/kv_bucket.h -> can you update to show this is an out parameter, I think Manu used the following style

 xxx@xxx.xxx [out] paramname description

And also update the comment block for the 2 other out params, metadata and deleted.

-------------------------------------
author: Bobby Buck
date: 2017-02-24 18:29:15.779000000

Patch Set 11:

(1 comment)

Line:5131, src/ep_engine.cc -> The idea is to return the datatype, so that XDCR can use it for conflict resolution. The way it will operate is, if one of the mutations has XATTRs in them, that mutation will win.

-------------------------------------
author: Bobby Buck
date: 2017-02-24 22:21:31.173000000

Patch Set 11:

(2 comments)

Line:219, src/kv_bucket_iface.h -> Done

Line:179, src/kv_bucket.h -> Done

-------------------------------------
