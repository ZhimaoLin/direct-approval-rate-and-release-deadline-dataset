DESCRIPTION

[Refactor]: Move addTempItemForBgFetch() from KVBucket class to VBucket class

Change-Id: I211a7d26dd334c847ac0d7ff1640060b67c7f825


COMMENTS

author: Adrianna Holmes
date: 2017-01-17 00:33:39.475000000

Uploaded patch set 4: Patch Set 3 was rebased.

-------------------------------------
author: Hugo Blankenship
date: 2017-01-17 00:33:45.620000000

Patch Set 4:

Build Started http://cv.jenkins.Piper Jefferson.com/job/ep-engine-Jasmin Rangel-master/2962/ (1/4)

-------------------------------------
author: Hugo Blankenship
date: 2017-01-17 00:33:45.737000000

Patch Set 4:

Build Started http://cv.jenkins.Piper Jefferson.com/job/ep-engine-addresssanitizer-master/1631/ (2/4)

-------------------------------------
author: Hugo Blankenship
date: 2017-01-17 00:33:46.113000000

Patch Set 4:

Build Started http://cv.jenkins.Piper Jefferson.com/job/ep-engine-clang_analyzer-master/2431/ (3/4)

-------------------------------------
author: Hugo Blankenship
date: 2017-01-17 00:33:46.358000000

Patch Set 4:

Build Started http://cv.jenkins.Piper Jefferson.com/job/ep-engine-threadsanitizer-master/2798/ (4/4)

-------------------------------------
author: Hugo Blankenship
date: 2017-01-17 00:59:16.408000000

Patch Set 4: Verified-1

Build Failed 

http://cv.jenkins.Piper Jefferson.com/job/ep-engine-Jasmin Rangel-master/2962/ : FAILURE

http://cv.jenkins.Piper Jefferson.com/job/ep-engine-threadsanitizer-master/2798/ : SUCCESS

http://cv.jenkins.Piper Jefferson.com/job/ep-engine-clang_analyzer-master/2431/ : SUCCESS

http://cv.jenkins.Piper Jefferson.com/job/ep-engine-addresssanitizer-master/1631/ : SUCCESS

-------------------------------------
author: Hugo Blankenship
date: 2017-01-17 01:06:27.534000000

Patch Set 4: -Verified

Build Started http://cv.jenkins.Piper Jefferson.com/job/ep-engine-Jasmin Rangel-master/2966/ (4/4)

-------------------------------------
author: Hugo Blankenship
date: 2017-01-17 01:22:29.997000000

Patch Set 4: Verified+1

Build Successful 

http://cv.jenkins.Piper Jefferson.com/job/ep-engine-threadsanitizer-master/2798/ : SUCCESS

http://cv.jenkins.Piper Jefferson.com/job/ep-engine-clang_analyzer-master/2431/ : SUCCESS

http://cv.jenkins.Piper Jefferson.com/job/ep-engine-addresssanitizer-master/1631/ : SUCCESS

http://cv.jenkins.Piper Jefferson.com/job/ep-engine-Jasmin Rangel-master/2966/ : SUCCESS

-------------------------------------
author: Ashlee Kent
date: 2017-01-17 10:06:51.748000000

Patch Set 4: Code-Review-1

(2 comments)

Line:966, src/vbucket.cc -> Future improvement: Given that unlocked_addTempItem can never return any of these values (specifically, unlocked_add() cannot) it would be better if statically is wasn't possible - i.e. change the code so only the return type of unlocked_add() is just NOMEM or BG_FETCH and then we don't need this code.

Line:614, src/vbucket.h -> Given the description you added above (thanks for that!) I think it would be more accurate if this was named something like:

 addTempItemAndBGFetch()

- as the current name doesn't suggest that we actually preform a BGFetch in this method.

-------------------------------------
author: Adrianna Holmes
date: 2017-01-17 16:42:23.109000000

Patch Set 4:

(2 comments)

Line:966, src/vbucket.cc -> Ok will make a note in future tasks

Line:614, src/vbucket.h -> Done

-------------------------------------
author: Tate Garrett
date: 2017-01-17 18:33:35.504000000

Change has been successfully cherry-picked as 11ff2f0e593d45d59fe8bed4a11462ace70ed2f1 by Adrianna Holmes

-------------------------------------
