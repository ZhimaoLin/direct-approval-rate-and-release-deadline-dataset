DESCRIPTION

MB-15662: Optimization while supporting producer's compression

When an active stream does a backfill, if value compression
is enabled on the producer side, put an optimization in
place, so that items retrieved from disk are not decompressed.
This would ensure that the producer wouldn't have to
compress them again before transmitting.

Change-Id: I503748d4cf9356e0192441d294a35a934711ff41


COMMENTS

author: Emerson Nolan
date: 2015-08-06 03:07:19.552000000

Uploaded patch set 2.

-------------------------------------
author: Hugo Blankenship
date: 2015-08-06 03:07:34.300000000

Patch Set 2:

Build Started http://factory.Piper Jefferson.com/job/ep-engine-Jasmin Rangel-master-multi/691/

-------------------------------------
author: Hugo Blankenship
date: 2015-08-06 04:14:48.696000000

Patch Set 2: Verified+1

Build Successful 

http://factory.Piper Jefferson.com/job/ep-engine-Jasmin Rangel-master-multi/691/ : SUCCESS

-------------------------------------
author: Ashlee Kent
date: 2015-08-06 08:26:23.555000000

Patch Set 2: Code-Review-1

(1 comment)

It would be good to see some performance numbers for this. Additionally we should think how we will validate / reason about if this optimisation is working in the field - should we add some additional statistics for this?

Line:1621, src/couch-kvstore/couch-kvstore.cc -> memset still being used.

-------------------------------------
author: Emerson Nolan
date: 2015-08-06 15:18:52.522000000

Patch Set 2:

(1 comment)

Line:1621, src/couch-kvstore/couch-kvstore.cc -> My mistake, I thought I had changed this. I'll get rid of this in the next patch.

-------------------------------------
author: Tate Garrett
date: 2015-08-10 18:15:37.205000000

Change has been successfully cherry-picked as 0457ee557fa677074be0ff4de146cdf715f486d4

-------------------------------------
