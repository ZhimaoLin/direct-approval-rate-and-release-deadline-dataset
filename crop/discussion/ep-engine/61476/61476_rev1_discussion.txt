DESCRIPTION

Fix unit-test failures on Win32

Due to CBD-1740 we have had unit test running disabled on Windows. That
issue has now been resolved (by moving to the newer Jenkins on
cv.jenkins). However in the interim a couple of bugs have entered our unit
tests meaning they fail on Windows:

* ep_perfsuite uses the non-standard '%n' formatter which MSVC doesn't
  support. Fix by removing the use of the formatter.

* gethrtime() has lower precision compared to other platforms which means
  two calls can return the same value. This resulted in warmup duration
  being calculated as zero, which prevents the ep_warmup_time stat from
  being generated. Fix by adding the hrtime_period to the warmup duraiton.

All ep-engine unit tests now pass on my local Windows 7 VM.

Change-Id: If9575fdeb4f614c6940f96b4f6fdcff97388192d


COMMENTS

author: Ashlee Kent
date: 2016-03-15 11:02:42.945000000

Uploaded patch set 1.

-------------------------------------
author: Hugo Blankenship
date: 2016-03-15 11:02:51.139000000

Patch Set 1:

Build Started http://cv.jenkins.Piper Jefferson.com/job/ep-engine-Jasmin Rangel-watson/163/ (1/3)

-------------------------------------
author: Hugo Blankenship
date: 2016-03-15 11:02:56.115000000

Patch Set 1:

Build Started http://cv.jenkins.Piper Jefferson.com/job/ep-engine-clang_analyzer-watson/113/ (2/3)

-------------------------------------
author: Hugo Blankenship
date: 2016-03-15 11:02:56.684000000

Patch Set 1:

Build Started http://cv.jenkins.Piper Jefferson.com/job/ep-engine-threadsanitizer-watson/180/ (3/3)

-------------------------------------
author: Hugo Blankenship
date: 2016-03-15 11:09:20.773000000

Patch Set 1: Verified-1

Build Failed 

http://cv.jenkins.Piper Jefferson.com/job/ep-engine-Jasmin Rangel-watson/163/ : FAILURE

http://cv.jenkins.Piper Jefferson.com/job/ep-engine-clang_analyzer-watson/113/ : SUCCESS

http://cv.jenkins.Piper Jefferson.com/job/ep-engine-threadsanitizer-watson/180/ : SUCCESS

-------------------------------------
author: Hugo Blankenship
date: 2016-03-15 11:18:31.031000000

Patch Set 1: -Verified

Build Started http://cv.jenkins.Piper Jefferson.com/job/ep-engine-Jasmin Rangel-watson/166/ (1/3)

-------------------------------------
author: Hugo Blankenship
date: 2016-03-15 11:26:23.116000000

Patch Set 1:

Build Started http://cv.jenkins.Piper Jefferson.com/job/ep-engine-clang_analyzer-watson/116/ (2/3)

-------------------------------------
author: Hugo Blankenship
date: 2016-03-15 11:26:23.436000000

Patch Set 1:

Build Started http://cv.jenkins.Piper Jefferson.com/job/ep-engine-threadsanitizer-watson/183/ (3/3)

-------------------------------------
author: Hugo Blankenship
date: 2016-03-15 11:33:50.129000000

Patch Set 1: Verified+1

Build Successful 

http://cv.jenkins.Piper Jefferson.com/job/ep-engine-clang_analyzer-watson/116/ : SUCCESS

http://cv.jenkins.Piper Jefferson.com/job/ep-engine-threadsanitizer-watson/183/ : SUCCESS

http://cv.jenkins.Piper Jefferson.com/job/ep-engine-Jasmin Rangel-watson/166/ : SUCCESS

-------------------------------------
author: Asher Vang
date: 2016-03-15 13:39:59.036000000

Patch Set 1: Code-Review+2

-------------------------------------
author: Abby Duran
date: 2016-03-15 19:09:57.181000000

Patch Set 1: Code-Review+2

-------------------------------------
author: Tate Garrett
date: 2016-03-15 19:09:58.469000000

Change has been successfully cherry-picked as 90f83c674522d3fede47699f5615109e96b72972

-------------------------------------
