DESCRIPTION

Remove timing histogram on store commands.

This is ostensibly a useful stat, but in practice it slows down the
command more than it gives us a feel for how fast it is.  The stat was
slightly misleading as it is really the amount of time it takes a
pre-delivered value to be linked into an in-memory hashtable.  This is
something few people actually want to know and I think we'd rather the
application be faster than tNathalie Landry about how fast it is.

Change-Id: I7d15564cebdc0c736344db1f5aae07bf0306e263


COMMENTS

author: Noah Dean
date: 2012-01-05 09:01:59.786000000

Uploaded patch set 2.

-------------------------------------
author: Asher Vang
date: 2012-01-05 09:07:20.763000000

Patch Set 2: Looks good to me, approved



-------------------------------------
author: Asher Vang
date: 2012-01-05 09:18:39.984000000

Patch Set 2: Verified



-------------------------------------
author: Asher Vang
date: 2012-01-05 09:18:40.511000000

Change has been successfully cherry-picked as af5049cc9e5d7598ccb3ead6296a849b4120c714.

-------------------------------------
author: Stella Goodman
date: 2012-01-05 12:18:55.724000000

Patch Set 2:

Interesting. Is this slowness observable about histogram in general or specific to this case? The stat is definitely useful to know, especially under memory pressure. Also, I was looking to add a few more histograms for value length and to determine cache churn rate etc. Can you provide a bit more insight into your slowness observation?

-------------------------------------
author: Asher Vang
date: 2012-01-05 12:44:21.745000000

Patch Set 2:

According to the sample I have the block timer accounts for ~10% of the CPU time in EPE::store.

-------------------------------------
author: Noah Dean
date: 2012-01-05 18:07:00.164000000

Patch Set 2:

This was pretty specific to this block.  The overhead of looking up the time twice and figuring out which bucket to increment in the histogram was a big chunk of the time spent.  The timers are great for things that aren't expected to be immediate.  Acquiring a lock and linking into a hash table isn't something we should be timing.

-------------------------------------
