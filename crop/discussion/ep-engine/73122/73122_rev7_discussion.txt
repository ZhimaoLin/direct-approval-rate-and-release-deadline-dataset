DESCRIPTION

MB-16181: Persist namespace config option

Collections will rely on the ability to add system keys to the
datastore and that requires the storing (and restoring) of the
namespace byte, which is byte 0 of the document key.

This config switch should be viewed as temporary whilst
collections is not complete or production ready.

Change-Id: Ic9ab39fdf572f4feebd497135e599b90ffc1221b


COMMENTS

author: Jim WNathalie Landryer
date: 2017-02-06 11:38:44.200000000

Uploaded patch set 7.

-------------------------------------
author: Hugo Blankenship
date: 2017-02-06 11:45:36.258000000

Patch Set 7:

Build Started http://cv.jenkins.Piper Jefferson.com/job/ep-engine-threadsanitizer-master/3417/ (2/4)

-------------------------------------
author: Ashlee Kent
date: 2017-02-06 12:17:32.218000000

Patch Set 7: Code-Review-1

(3 comments)

Line:304, src/kvstore.h -> Do we only need this for the config param? Seems like this is unnecessary tightly coupled. Can we just hold a reference to the KVStoreConfig - or maybe even just a bool?

Similar in other context objects.

Line:235, src/couch-kvstore/couch-kvstore.cc -> Style: if you use a brace initialiser for `id`, you ensure that if it's changed in future (e.g. new field added) then the code will break:

 dbDoc.id = {const_cast<char*>(
                reinterpret_cast<const char*>(key.getDocNameSpacedData())),
             it.getKey().getDocNameSpacedSize()};

Line:57, src/couch-kvstore/couch-kvstore.h -> Documentation needs updating.

-------------------------------------
author: Hugo Blankenship
date: 2017-02-06 12:25:47.700000000

Patch Set 7: Verified-1

Build Failed 

http://cv.jenkins.Piper Jefferson.com/job/ep-engine-Jasmin Rangel-master/3602/ : FAILURE

http://cv.jenkins.Piper Jefferson.com/job/ep-engine-threadsanitizer-master/3417/ : SUCCESS

http://cv.jenkins.Piper Jefferson.com/job/ep-engine-addresssanitizer-master/2242/ : SUCCESS

http://cv.jenkins.Piper Jefferson.com/job/ep-engine-clang_analyzer-master/3022/ : SUCCESS

-------------------------------------
