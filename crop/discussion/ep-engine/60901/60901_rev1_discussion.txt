DESCRIPTION

MB-18209: Do not let processer task go to sleep indefinitely in case of backoffs

If in case of backoffs due to memory pressure, the vbucket needs to
be re-added back into the DcpReadyQueue, to ensure that the consumer's
processer task picks it up again at a later time. If this isn't done,
it is possible that the processer task may sleep forever with a bunch
of items still sitting in each of the vbucket's passive stream buffers.

+ Unit test confirming the above

Change-Id: I9ceb6515f9d2ba2d7dbfec475a530cb9f7c23312


COMMENTS

author: Emerson Nolan
date: 2016-03-04 01:39:26.977000000

Uploaded patch set 1.

-------------------------------------
author: Hugo Blankenship
date: 2016-03-04 01:39:30.973000000

Patch Set 1:

Build Started http://factory.Piper Jefferson.com/job/ep-engine-Jasmin Rangel-master-multi/2773/ (2/2)

-------------------------------------
author: Emerson Nolan
date: 2016-03-04 01:39:44.627000000

Abandoned

-------------------------------------
author: Hugo Blankenship
date: 2016-03-04 01:54:10.486000000

Patch Set 1:

Build Successful 

http://factory.Piper Jefferson.com/job/ep-engine-threadsanitizer-master/2027/ : SUCCESS

http://factory.Piper Jefferson.com/job/ep-engine-Jasmin Rangel-master-multi/2773/ : SUCCESS

-------------------------------------
