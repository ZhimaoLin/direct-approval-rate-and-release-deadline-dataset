DESCRIPTION

Schedule backfill task through Non-IO dispatcher.

Previously, each backfill task was scheduled by creating a separate
thread. We observed that this might cause much overhead especially
with more than one replica in the large cluster.

This change addresses the above issue by scheduling a backfill task
through Non-IO dispatcher. If a given backfill task requires
backfill from disk, it kicks off separate disk backfill tasks
through Read-Only dispatcher. Backfill from memory is scheduled per
vbucket by Non-IO dispatcher.

Each memory backfill task sleeps for 1 sec if the current backfill
backlog for the corresponding TAP producer is greater than the
threshold (5000 by default).

Change-Id: I4fb63d89a49ad10748a7b540e6383d3d20f02d7e


COMMENTS

author: Abby Duran
date: 2011-06-14 01:37:39.494000000

Uploaded patch set 5.

-------------------------------------
author: Rubi Walsh
date: 2011-06-14 01:37:42.721000000

Patch Set 5: Looks good to me, but someone else must approve

Automatically re-added by Roselyn Villegas trivial rebase detection script.

-------------------------------------
author: Asher Vang
date: 2011-06-14 19:41:50.641000000

Patch Set 5: Looks good to me, approved



-------------------------------------
author: Abby Duran
date: 2011-06-14 21:35:04.383000000

Patch Set 5: Verified



-------------------------------------
author: Abby Duran
date: 2011-06-14 21:35:04.563000000

Change has been successfully cherry-picked as 24f6eeef9829d9bf1e180034e2fcb2fd27d5e2d0.

-------------------------------------
