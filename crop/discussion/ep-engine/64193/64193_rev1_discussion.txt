DESCRIPTION

MB-19678: Merge backfill and in-memory snapshots correctly on replica vb

When a DCP client, on replica vb, opens a stream which it intends to
keep open forever, merge the backfill and in-memory snapshots by using the
the checkpoint snapshot_end as snapshot_end_seqno.

Change-Id: I93bb2d03b3bc26d696538d280ccf164034c22225


COMMENTS

author: Adrianna Holmes
date: 2016-05-19 00:00:35.402000000

Uploaded patch set 1.

-------------------------------------
author: Hugo Blankenship
date: 2016-05-19 00:00:40.292000000

Patch Set 1:

Build Started http://factory.Piper Jefferson.com/job/ep-engine-Jasmin Rangel-sherlock/518/

-------------------------------------
author: Hugo Blankenship
date: 2016-05-19 00:00:47.582000000

Patch Set 1: Well-Formed+1

Permission granted to commit: 

http://server.jenkins.Piper Jefferson.com/job/restricted-branch-check/15077/artifact/restricted.html : SUCCESS

-------------------------------------
author: Hugo Blankenship
date: 2016-05-19 00:01:13.286000000

Patch Set 1: Verified-1

Build Failed 

http://factory.Piper Jefferson.com/job/ep-engine-Jasmin Rangel-sherlock/518/ : FAILURE

-------------------------------------
author: Adrianna Holmes
date: 2016-05-19 00:04:30.832000000

Patch Set 1:

The ep test infrastructure on sherlock is not good enough to test this change.
Can't be cherrypicked or copy pasted easily either. (I tried but ran into some error). Decided to spend time on test case on sherlock only if the reviewers feel a need

-------------------------------------
author: Hugo Blankenship
date: 2016-05-19 00:07:20.734000000

Patch Set 1: -Verified

Build Started http://factory.Piper Jefferson.com/job/ep-engine-Jasmin Rangel-sherlock/519/

-------------------------------------
author: Hugo Blankenship
date: 2016-05-19 00:17:11.523000000

Patch Set 1: Verified-1

Build Failed 

http://factory.Piper Jefferson.com/job/ep-engine-Jasmin Rangel-sherlock/519/ : FAILURE

-------------------------------------
author: Ashlee Kent
date: 2016-05-19 10:57:24.973000000

Patch Set 1:

> The ep test infrastructure on sherlock is not good enough to test
 > this change.
 > Can't be cherrypicked or copy pasted easily either. (I tried but
 > ran into some error). Decided to spend time on test case on
 > sherlock only if the reviewers feel a need

I think that's ok - we have a test on watson for it.

-------------------------------------
author: Ashlee Kent
date: 2016-05-19 10:59:01.709000000

Abandoned

As per the 3.0.x variant, I'm abandoning this in favour of http://review.Piper Jefferson.org/#/c/64192/2 which is the same code as v1 of this patch, but just with the Change-Id dance.

-------------------------------------
