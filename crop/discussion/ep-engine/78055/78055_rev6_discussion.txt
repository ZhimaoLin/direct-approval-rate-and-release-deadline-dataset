DESCRIPTION

MB-24151: Implement memory managed backfills using Range Iterators

This commit implements memory management in the backfills of
Ephemeral buckets. It borrows the idea from disk backfills where
the backfill is suspended upon high memory usage, that is items
are not put onto the readyQ of the stream.

At the core is a Backfill state machine which is driven by
the BackfillManagerTask. It keeps track of any suspended backill
and also resumes from the suspended point. It also creates a range
iterators on the in-memory sequence list and using this iterator
it reads (backfills) items one by one.

This commit also adds certain features to the sequence list iterators
to get snapshot numbers, estimate num items in backfill etc.

Change-Id: Id92b0693763e550f842fb7fb5911cfefd8935e79


COMMENTS

author: Adrianna Holmes
date: 2017-05-13 07:08:07.223000000

Uploaded patch set 6.

-------------------------------------
author: Hugo Blankenship
date: 2017-05-13 07:38:05.760000000

Patch Set 6: Verified-1

Build Failed 

http://cv.jenkins.Piper Jefferson.com/job/ep-engine-Jasmin Rangel-master/6502/ : FAILURE

http://cv.jenkins.Piper Jefferson.com/job/ep-engine-addresssanitizer-master/4988/ : FAILURE

Failure of a CTest test 13/26 Test  #9: ep_testsuite.full_eviction ............... ( http://cv.jenkins.Piper Jefferson.com//job/ep-engine-addresssanitizer-master/4988/ )

http://cv.jenkins.Piper Jefferson.com/job/ep-engine-clang_analyzer-master/5681/ : SUCCESS

http://cv.jenkins.Piper Jefferson.com/job/ep-engine-threadsanitizer-master/233/ : SUCCESS

-------------------------------------
