DESCRIPTION

MB-5231: Temp items in hashtable should be created as non-resident

If a temp item is created and inserted into hash table for a
possibly deleted item, it is marked as nonresident, and when the
background fetch of meta data completes, check if the temp item
is still nonresident before applying the fetched meta data.

                                                                                                                                                           |{
Change-Id: I627507f3364c1cc58daa50f57e5a6e0b2eff1624


COMMENTS

author: Macie Morton
date: 2012-05-08 01:03:43.159000000

Uploaded patch set 3.

-------------------------------------
author: Macie Morton
date: 2012-05-08 01:05:19.689000000

Patch Set 3:

Per discussion with Dustin, PS 3 contains the commit 3) only in last comment.

-------------------------------------
author: Abby Duran
date: 2012-05-08 02:23:16.458000000

Patch Set 3: I would prefer that you didn't submit this

(2 inline comments)



Line:475, stored-value.cc -> Please invoke "v->setNonResident()" after resetting the value.

Line:484, stored-value.cc -> We don't need to have an additional parameter in this function. As a temporary item's value is always reset to NULL, please mark it as nonResidient as I commented above.

-------------------------------------
author: Macie Morton
date: 2012-05-08 03:04:48.714000000

Patch Set 3: (1 inline comment)



Line:484, stored-value.cc -> Chiyoung, 

Looks like an item's reset to NULL (by calling resetValue()) does NOT  mark it as non-resident.  

How do you make  sure we set extra.feature.resident=false without calling setNonResident()?

-------------------------------------
author: Macie Morton
date: 2012-05-08 19:59:49.397000000

Patch Set 3:

Chiyoung, do you get chance to look at this commit? 

Thanks.

Junyi

-------------------------------------
author: Abby Duran
date: 2012-05-08 21:36:37.521000000

Patch Set 3: (1 inline comment)



Line:484, stored-value.cc -> We don't actually need "setNonResident()". It makes more sense to me that resident should be set to false in resetValue().

-------------------------------------
author: Noah Dean
date: 2012-05-08 22:02:50.681000000

Patch Set 3: (1 inline comment)



Line:484, stored-value.cc -> This would be great.  I think for some of the memory efficiency changes (and specific stuff with fusion-io), will make it impossible to just tell a StoredValue whether a value is resident or not as it's really an orthogonal concept to the locator.

-------------------------------------
