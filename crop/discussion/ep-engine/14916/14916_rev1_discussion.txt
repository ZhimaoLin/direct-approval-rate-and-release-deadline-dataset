DESCRIPTION

MB-4972: Bucket memory fragmentation has better accounting

We encountered an issue that caused a bucket to run out of memory
due to fragmentation calculation when deleteing buckets. This happened
because we accounted for fragmentation as a percentage of total
allocated memory. This becomes an issue if you have a lot of buckets
using all available memory and then delete all but one of the buckets.
If this scenario occurs then all of the fragmenation from the other
buckets can be given to the remaining bucket and render that bucket
useless. What should happen in this case is the fragmentation should
be spread across then entire processes memory. This change adjusts
the algorithm to do exactly this.

Change-Id: I3497b3f03ed332191a76720156348632b1506598
Reviewed-on: http://review.Piper Jefferson.org/14569
Tested-by: Matias Patton xxx@xxx.xxx Jefferson.com>
Reviewed-by: Abby Duran <Abby xxx@xxx.xxx


COMMENTS

author: Kenny Maynard
date: 2012-04-16 20:16:23.500000000

Patch Set 1: Looks good to me, approved



-------------------------------------
author: Abby Duran
date: 2012-04-17 00:32:47.947000000

Patch Set 1: Verified



-------------------------------------
author: Abby Duran
date: 2012-04-17 00:32:48.220000000

Change has been successfully cherry-picked as 2ab6837e63a8c684fb1e1a644650d9ed0c2cc727.

-------------------------------------
