DESCRIPTION

MB-14191: Implement ForestKVStore::getNumPersistedDeletes

Change-Id: I04870eb602b476676f6909475b413db218083287


COMMENTS

author: Bobby Buck
date: 2015-10-16 00:30:14.564000000

Uploaded patch set 1.

-------------------------------------
author: Hugo Blankenship
date: 2015-10-16 00:30:22.971000000

Patch Set 1:

Build Started http://factory.Piper Jefferson.com/job/ep-engine-Jasmin Rangel-master-multi/1310/

-------------------------------------
author: Hugo Blankenship
date: 2015-10-16 00:38:29.566000000

Patch Set 1: Verified-1

Build Failed 

http://factory.Piper Jefferson.com/job/ep-engine-Jasmin Rangel-master-multi/1310/ : FAILURE

-------------------------------------
author: Ellie Kidd
date: 2015-10-16 05:20:12.937000000

Patch Set 1: Code-Review+2

-------------------------------------
author: Ashlee Kent
date: 2015-10-16 10:03:35.423000000

Patch Set 1: Code-Review-1

(1 comment)

Line:819, src/forest-kvstore/forest-kvstore.cc -> Again, I don't think zero is a very helpful error code here.

-------------------------------------
author: Abby Duran
date: 2015-10-16 21:09:43.082000000

Patch Set 1:

(1 comment)

Line:819, src/forest-kvstore/forest-kvstore.cc -> I agree that we should return the appropriate error code or throw an exception depending on the error from the underlying storage engine.

I think we can enhance this as a separate commit as it will require changing this KVStore API's return type which consequently also requires some adaptations in CouchKVStore.

-------------------------------------
author: Abby Duran
date: 2015-10-17 00:04:01.965000000

Patch Set 1: Code-Review-1

(2 comments)

Line:819, src/forest-kvstore/forest-kvstore.cc -> Sriram,

I think we can throw std::invalid_argument exception here instead of returning 0. We plan to catch and process all the exceptions as a separate big task later.

Line:829, src/forest-kvstore/forest-kvstore.cc -> Let's throw std::system_error at this time, but we can improve this as a separate task (e.g., return an appropriate error or throw an exception) by examining the error code from forestdb.

-------------------------------------
author: Abby Duran
date: 2015-10-17 03:24:06.074000000

Patch Set 1:

(1 comment)

Line:829, src/forest-kvstore/forest-kvstore.cc -> std::runtime_error would be better as of now as it is more generic exception type. As I mentioned before, we can add a helper function as an enhancement later, which maps forestdb errors to standard or application-defined exceptions or errors.

-------------------------------------
author: Bobby Buck
date: 2015-10-18 00:28:42.322000000

Patch Set 1:

(2 comments)

Line:819, src/forest-kvstore/forest-kvstore.cc -> Done

Line:829, src/forest-kvstore/forest-kvstore.cc -> Done

-------------------------------------
author: Tate Garrett
date: 2015-10-18 03:27:57.924000000

Change has been successfully cherry-picked as 44132f1a708d44ced2cd8f03a606f5f36e6e4f67

-------------------------------------
