DESCRIPTION

MB-22524: Add XATTRs for DCP Deletion (and expiration)

According to the spec we should send XATTRs as part of of the
deletion messages over DCP. In order to do so we need to send
the item as part of the message producer the same way we
do for a normal mutation.

The same change applies to expiration messages (currently not
used)

Change-Id: I9b44585cb64836044a44fa38b4ace46b0aa1b110


COMMENTS

author: Asher Vang
date: 2017-02-01 06:48:29.549000000

Uploaded patch set 19.

-------------------------------------
author: Hugo Blankenship
date: 2017-02-01 06:48:36.254000000

Patch Set 19:

Build Started http://cv.jenkins.Piper Jefferson.com/job/ep-engine-clang_analyzer-master/2902/ (1/4)

-------------------------------------
author: Hugo Blankenship
date: 2017-02-01 06:48:36.463000000

Patch Set 19:

Build Started http://cv.jenkins.Piper Jefferson.com/job/ep-engine-threadsanitizer-master/3297/ (2/4)

-------------------------------------
author: Hugo Blankenship
date: 2017-02-01 06:48:36.676000000

Patch Set 19:

Build Started http://cv.jenkins.Piper Jefferson.com/job/ep-engine-Jasmin Rangel-master/3476/ (3/4)

-------------------------------------
author: Hugo Blankenship
date: 2017-02-01 06:50:42.991000000

Patch Set 19:

Build Started http://cv.jenkins.Piper Jefferson.com/job/ep-engine-addresssanitizer-master/2121/ (4/4)

-------------------------------------
author: Hugo Blankenship
date: 2017-02-01 07:45:34.557000000

Patch Set 19:

Build Started http://cv.jenkins.Piper Jefferson.com/job/ep-engine-clang_analyzer-master/2903/ (4/4)

-------------------------------------
author: Hugo Blankenship
date: 2017-02-01 07:50:34.821000000

Patch Set 19: Verified+1

Build Successful 

http://cv.jenkins.Piper Jefferson.com/job/ep-engine-threadsanitizer-master/3297/ : SUCCESS

http://cv.jenkins.Piper Jefferson.com/job/ep-engine-addresssanitizer-master/2121/ : SUCCESS

http://cv.jenkins.Piper Jefferson.com/job/ep-engine-Jasmin Rangel-master/3476/ : SUCCESS

http://cv.jenkins.Piper Jefferson.com/job/ep-engine-clang_analyzer-master/2903/ : SUCCESS

-------------------------------------
author: Ashlee Kent
date: 2017-02-01 09:50:18.217000000

Patch Set 19: Code-Review-1

(1 comment)

This is a pretty hard patch to follow now (+600, -400).

Any chance you can split - maybe into an initial pure refactor (including the argument changes which is most of the lines changed), and then a second patch which adds the XATTRs for DCP?

Line:489, src/dcp/producer.cc -> Useful to mention which case this is from (cannot tell it from the Mutation case above).

-------------------------------------
author: Asher Vang
date: 2017-02-01 11:20:08.365000000

Patch Set 19:

(1 comment)

Line:489, src/dcp/producer.cc -> Done

-------------------------------------
