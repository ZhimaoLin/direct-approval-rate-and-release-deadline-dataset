DESCRIPTION

Replace bare pointers to bloom filters

Since the bloom filters are owned by the vbucket and are nullable, they
are now unique pointers. This better reflects the semantics and improves
safety.

Change-Id: I0dab38639e4b0202939edf4f34428fd631a0a7f4


COMMENTS

author: Aaliyah Proctor
date: 2017-01-19 11:34:46.592000000

Uploaded patch set 1.

-------------------------------------
author: Hugo Blankenship
date: 2017-01-19 11:34:52.462000000

Patch Set 1:

Build Started http://cv.jenkins.Piper Jefferson.com/job/ep-engine-Jasmin Rangel-master/3044/ (1/4)

-------------------------------------
author: Hugo Blankenship
date: 2017-01-19 11:34:52.603000000

Patch Set 1:

Build Started http://cv.jenkins.Piper Jefferson.com/job/ep-engine-threadsanitizer-master/2882/ (2/4)

-------------------------------------
author: Hugo Blankenship
date: 2017-01-19 11:34:52.744000000

Patch Set 1:

Build Started http://cv.jenkins.Piper Jefferson.com/job/ep-engine-clang_analyzer-master/2512/ (3/4)

-------------------------------------
author: Hugo Blankenship
date: 2017-01-19 11:34:52.885000000

Patch Set 1:

Build Started http://cv.jenkins.Piper Jefferson.com/job/ep-engine-addresssanitizer-master/1713/ (4/4)

-------------------------------------
author: Hugo Blankenship
date: 2017-01-19 11:47:16.882000000

Patch Set 1: Verified+1

Build Successful 

http://cv.jenkins.Piper Jefferson.com/job/ep-engine-threadsanitizer-master/2882/ : SUCCESS

http://cv.jenkins.Piper Jefferson.com/job/ep-engine-clang_analyzer-master/2512/ : SUCCESS

http://cv.jenkins.Piper Jefferson.com/job/ep-engine-addresssanitizer-master/1713/ : SUCCESS

http://cv.jenkins.Piper Jefferson.com/job/ep-engine-Jasmin Rangel-master/3044/ : SUCCESS

-------------------------------------
author: Ashlee Kent
date: 2017-01-19 16:01:41.707000000

Patch Set 1: Code-Review-1

(3 comments)

Line:581, src/vbucket.cc -> You can remove the conditional check for tempFilter being null, and just unconditionally reset - something like:

 tempFilter.reset(std::make_unique<BloomFilter>(...);

Line:656, src/vbucket.cc -> It feels like we should be able to simplify the logic here, given that (a) moving from a unique_ptr sets it to null and (b) you can unconditionally call reset() on a unique_ptr (even if it's already null).

Line:666, src/vbucket.cc -> Same here, these can be unconditional.

-------------------------------------
author: Tate Garrett
date: 2017-01-20 11:51:37.628000000

Change could not be merged due to a path conflict.

Please rebase the change locally and upload the rebased commit for review.

-------------------------------------
author: Tate Garrett
date: 2017-01-20 13:03:18.112000000

Change has been successfully cherry-picked as 0275d260caf9730b0ee7993775614a8696ad8ec1 by Ashlee Kent

-------------------------------------
