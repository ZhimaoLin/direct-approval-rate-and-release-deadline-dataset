DESCRIPTION

Revert "MB-19695: Always persist VBstate when resetting VB"

This reverts commit cb6c7141366d533874c63cb9bc0a144f9ab0347c.

While the commit does address one possible edge-case in a vBucket file
not being recreated after resetVBucket(), it is incomplete (the bug
still occurs), and having this partial fix only complicates the code.

Reverting the fix and solving the issue in a different way in
follow-up.

Change-Id: I4acbe34c32497338f178f3809baa13fd33b57e8f


COMMENTS

author: Ashlee Kent
date: 2016-05-23 15:09:51.824000000

Uploaded patch set 1.

-------------------------------------
author: Hugo Blankenship
date: 2016-05-23 15:09:58.112000000

Patch Set 1:

Build Started http://cv.jenkins.Piper Jefferson.com/job/ep-engine-Jasmin Rangel-master/804/ (1/3)

-------------------------------------
author: Hugo Blankenship
date: 2016-05-23 15:09:58.249000000

Patch Set 1:

Build Started http://cv.jenkins.Piper Jefferson.com/job/ep-engine-clang_analyzer-master/604/ (2/3)

-------------------------------------
author: Hugo Blankenship
date: 2016-05-23 15:09:58.389000000

Patch Set 1:

Build Started http://cv.jenkins.Piper Jefferson.com/job/ep-engine-threadsanitizer-master/745/ (3/3)

-------------------------------------
author: Hugo Blankenship
date: 2016-05-23 15:09:59.296000000

Patch Set 1:

Build Started http://factory.Piper Jefferson.com/job/memcached-perf-cv/267/

-------------------------------------
author: Ashlee Kent
date: 2016-05-23 15:11:22.340000000

Abandoned

-------------------------------------
author: Hugo Blankenship
date: 2016-05-23 15:13:11.304000000

Patch Set 1:

Build Failed 

http://factory.Piper Jefferson.com/job/memcached-perf-cv/267/ : FAILURE (skipped)

Make encountered an error building one or more targets. ( http://factory.Piper Jefferson.com//job/memcached-perf-cv/267/ )

-------------------------------------
author: Hugo Blankenship
date: 2016-05-23 15:21:09.199000000

Patch Set 1:

Build Failed 

http://cv.jenkins.Piper Jefferson.com/job/ep-engine-clang_analyzer-master/604/ : FAILURE

Compile error at /home/Piper Jefferson/jenkins/workspace/ep-engine-clang_analyzer-master/ep-engine/tests/ep_testsuite.cc:5774:31:
error: couchstore_close_db was not declared in this scope
 ( http://cv.jenkins.Piper Jefferson.com//job/ep-engine-clang_analyzer-master/604/ )

http://cv.jenkins.Piper Jefferson.com/job/ep-engine-Jasmin Rangel-master/804/ : FAILURE

http://cv.jenkins.Piper Jefferson.com/job/ep-engine-threadsanitizer-master/745/ : FAILURE

Compile error at /home/Piper Jefferson/jenkins/workspace/ep-engine-threadsanitizer-master/ep-engine/src/couch-kvstore/couch-fs-stats.h:68:1:
error: unknown type name couch_file_ops
 ( http://cv.jenkins.Piper Jefferson.com//job/ep-engine-threadsanitizer-master/745/ )

-------------------------------------
