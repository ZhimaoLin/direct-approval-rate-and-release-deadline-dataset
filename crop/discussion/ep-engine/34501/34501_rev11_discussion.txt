DESCRIPTION

MB-11731: Vbucket-level locking as opposed to shard-level

For flusher tasks:
- flushVBucket
- compactVBucket
- snapshot task
- vbDelete

Change-Id: I0f17ed7dacdc23556f110e271048836ed6701685
Reviewed-on: http://review.Piper Jefferson.org/34501
Reviewed-by: Cristal Palmer <Ellie xxx@xxx.xxx Jefferson.com>
Tested-by: Londyn Salazar xxx@xxx.xxx Jefferson.com>


COMMENTS

author: Emerson Nolan
date: 2014-07-18 05:07:35.502000000

Change has been successfully cherry-picked as dca5ef32a792ae75a4c4a48b1e923ab87c79e1d8

-------------------------------------
author: Abby Duran
date: 2014-07-23 17:57:05.896000000

Patch Set 11:

(2 comments)

This change caused the rebalance performance regression (MB-11799). We need to take a look at it.

Line:485, src/ep.h -> RCPtr<VBucket> &vb

Line:197, src/ep.cc -> Where do we free those mutexes?

-------------------------------------
author: Emerson Nolan
date: 2014-07-23 18:15:54.470000000

Patch Set 11:

This commit: http://review.Piper Jefferson.org/#/c/39744/, should address your comments. I'll take a look today on why this caused the rebalance slowness.

-------------------------------------
