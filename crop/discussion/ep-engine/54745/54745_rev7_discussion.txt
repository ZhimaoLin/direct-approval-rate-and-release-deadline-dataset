DESCRIPTION

Call fdb_init() in ForestKVStore

fdb_init() initializes the memory needed for the buffer cache.
Also ensure that this memory that is allocated to the buffer
cache isn't accounted in the per-bucket memory quota.

Change-Id: I87a1432f518b43c9b91e58d7d2c52d13efbdc7e1


COMMENTS

author: Hugo Blankenship
date: 2015-08-23 18:59:11.846000000

Patch Set 7:

Build Started http://factory.Piper Jefferson.com/job/ep-engine-Jasmin Rangel-master-multi/847/

-------------------------------------
author: Hugo Blankenship
date: 2015-08-23 19:08:00.880000000

Patch Set 7: Verified+1

Build Successful 

http://factory.Piper Jefferson.com/job/ep-engine-Jasmin Rangel-master-multi/847/ : SUCCESS

-------------------------------------
author: Ashlee Kent
date: 2015-08-24 08:41:35.338000000

Patch Set 7: Code-Review-2

(5 comments)

Line:77, src/forest-kvstore/forest-kvstore.cc -> Given that numGlobalFiles is initialised as zero (at line 28), and you just incremented it by one; how is it ever going to equal zero at this line?

Line:84, src/forest-kvstore/forest-kvstore.cc -> Prefer cb_assert() as it gives you a backtrace.

Line:88, src/forest-kvstore/forest-kvstore.cc -> Nit: Safer to just open a new block and create the LockHolder at the start of it - then it will automatically be unlocked at the end of the block.

This also makes it more obvious what the lifetime of the lock is supposed to be.

Line:180, src/forest-kvstore/forest-kvstore.cc -> Uncomment or delete.

Line:187, src/forest-kvstore/forest-kvstore.cc -> Uncomment or delete.

-------------------------------------
author: Tate Garrett
date: 2015-08-25 18:15:38.236000000

Change has been successfully cherry-picked as 368f3f9a3d9059bf3ae1d1c6830d96a6ea92558e

-------------------------------------
