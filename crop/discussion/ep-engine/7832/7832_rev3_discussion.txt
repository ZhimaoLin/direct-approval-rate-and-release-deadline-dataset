DESCRIPTION

Ensure mc can process database state transitions before writing data.

SQLite has all vbucket tables ready all of the time.  In practice,
this means that SQLite doesn't care, but it's also part of the reason
that we have to be really careful when reusing them.

In CouchDB, we create and destroy databases, so we want to ensure that
we see these events in the operation stream at the right times.

Change-Id: I3d24625edecdf58113a99df8ac75170e6a75c5f3


COMMENTS

author: Noah Dean
date: 2011-07-08 23:26:18.265000000

Uploaded patch set 3.

-------------------------------------
author: Tatiana Sheppard
date: 2011-07-08 23:32:33.748000000

Patch Set 3: Verified; Looks good to me, approved

Verified.

-------------------------------------
author: Tatiana Sheppard
date: 2011-07-08 23:32:34.136000000

Change has been successfully cherry-picked as 4082a7bd47bc4692a2fc3707e9210f11e99bd76c.

-------------------------------------
author: Asher Vang
date: 2011-07-09 06:44:31.059000000

Patch Set 3: (1 inline comment)



Line:2152, ep.cc -> Why not run a commit() before this command?

-------------------------------------
author: Noah Dean
date: 2011-07-09 06:48:22.487000000

Patch Set 3: (1 inline comment)



Line:2152, ep.cc -> It's not really necessary.  Well, anymore.  I can create or update another database while continuing to process an existing batch.

-------------------------------------
author: Asher Vang
date: 2011-07-09 07:00:46.723000000

Patch Set 3: (1 inline comment)



Line:2152, ep.cc -> ok. I guess it will also "force" an "partial" commit by waiting for all of the items added so far in the commit needs to complete before the return of this message :)

-------------------------------------
author: Noah Dean
date: 2011-07-09 07:02:36.716000000

Patch Set 3: (1 inline comment)



Line:2152, ep.cc -> That's true, but ideally, I'd like a static callback that just eats the message, then I can just fire-and-forget async (since I'm doing fire-and-forget sync now).  Maybe that's not a good idea, though.  :)

-------------------------------------
author: Asher Vang
date: 2011-07-09 07:08:17.140000000

Patch Set 3: (1 inline comment)



Line:2152, ep.cc -> If the operation can't fail I don't see why you cant do that ;) (I'm  going to reschedule the message for network problems etc..)

-------------------------------------
