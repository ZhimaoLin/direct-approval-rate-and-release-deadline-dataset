DESCRIPTION

MB-14279: Disk usage for vbuckets to be tracked during warmup

Disk Usage stats: fileSize and spaceUsed for every vbucket
are to be updated during warmup, as obtained from dbinfo.

Change-Id: Ia69f8ad3cd61bbb068355ff3b159d66a03ae7cb9


COMMENTS

author: Emerson Nolan
date: 2015-04-07 00:56:40.769000000

Uploaded patch set 3.

-------------------------------------
author: Hugo Blankenship
date: 2015-04-07 00:56:48.467000000

Patch Set 3:

Build Started http://factory.Piper Jefferson.com/job/ep-engine-Jasmin Rangel-sherlock/124/

-------------------------------------
author: Hugo Blankenship
date: 2015-04-07 01:39:00.813000000

Patch Set 3: Verified-1

Build Failed 

http://factory.Piper Jefferson.com/job/ep-engine-Jasmin Rangel-sherlock/124/ : FAILURE

-------------------------------------
author: Emerson Nolan
date: 2015-04-07 03:18:12.765000000

Removed the following votes:

* Verified-1 by Hugo Blankenship xxx@xxx.xxx Jefferson.com>


-------------------------------------
author: Abby Duran
date: 2015-04-07 17:05:47.358000000

Patch Set 3: Code-Review-1

(3 comments)

Line:95, src/kvstore.h -> Please rename it to VBucketDBInfo

Line:2244, src/couch-kvstore/couch-kvstore.cc -> I don't think we need to check the cached value because we always open the DB and get its stats here. The main purpose of maintaining cached values is to avoid opening the file repetitively.

Line:7091, tests/ep_testsuite.cc -> What is this magic number 0.9? Does this work across all the different environments?

-------------------------------------
author: Emerson Nolan
date: 2015-04-07 20:10:27.403000000

Patch Set 3:

(2 comments)

Line:95, src/kvstore.h -> Done

Line:7091, tests/ep_testsuite.cc -> 0.9 is to indicate a Â±10% buffer for the size and space used. It worked fine on mac and ubuntu.

-------------------------------------
author: Tate Garrett
date: 2015-04-07 22:48:42.612000000

Change has been successfully cherry-picked as c49789062cfbd03bc2c24d60e8f04b827bfe9544

-------------------------------------
