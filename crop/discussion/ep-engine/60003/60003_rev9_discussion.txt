DESCRIPTION

MB-18095: Support for testing multiple streams from single producer

Expand dcp unit tests to support streaming from multiple vbuckets
under the umbrella of a single producer.
+ Unit test demonstrating this capability

Change-Id: Ib9a91af42a9667c145269165474ec0f78db8bda8


COMMENTS

author: Emerson Nolan
date: 2016-02-19 01:31:52.495000000

Uploaded patch set 9.

-------------------------------------
author: Hugo Blankenship
date: 2016-02-19 01:42:02.107000000

Patch Set 9:

Build Started http://factory.Piper Jefferson.com/job/ep-engine-threadsanitizer-master/1855/ (2/2)

-------------------------------------
author: Hugo Blankenship
date: 2016-02-19 01:51:27.545000000

Patch Set 9: Verified-1

Build Failed 

http://factory.Piper Jefferson.com/job/ep-engine-threadsanitizer-master/1855/ : FAILURE

Make encountered an error building one or more targets. ( http://factory.Piper Jefferson.com//job/ep-engine-threadsanitizer-master/1855/ )

http://factory.Piper Jefferson.com/job/ep-engine-Jasmin Rangel-master-multi/2605/ : SUCCESS

-------------------------------------
author: Hugo Blankenship
date: 2016-02-19 02:14:54.598000000

Patch Set 9: -Verified

Build Started http://factory.Piper Jefferson.com/job/ep-engine-threadsanitizer-master/1857/ (2/2)

-------------------------------------
author: Hugo Blankenship
date: 2016-02-19 02:21:55.263000000

Patch Set 9: Verified+1

Build Successful 

http://factory.Piper Jefferson.com/job/ep-engine-Jasmin Rangel-master-multi/2605/ : SUCCESS

http://factory.Piper Jefferson.com/job/ep-engine-threadsanitizer-master/1857/ : SUCCESS

-------------------------------------
author: Ashlee Kent
date: 2016-02-19 18:05:46.918000000

Patch Set 9: Code-Review-1

(4 comments)

Line:100, tests/ep_testsuite_dcp.cc -> Make this const (so the caller knows its unchanged).

Line:191, tests/ep_testsuite_dcp.cc -> Is ctx modified in there? If not make const.

Line:319, tests/ep_testsuite_dcp.cc -> Given you refer to the current vbid stats constantly, just pull out a reference to it at the top of the block:

 auto& stats = vb_stats[vbid];

Line:465, tests/ep_testsuite_dcp.cc -> Same here, pull out a reference to make it more readable.

-------------------------------------
author: Emerson Nolan
date: 2016-02-19 18:44:27.162000000

Patch Set 9:

(2 comments)

Line:100, tests/ep_testsuite_dcp.cc -> ctx can be modified within run().

Line:191, tests/ep_testsuite_dcp.cc -> Yes it is modified, see lines 205, 209 below.

-------------------------------------
author: Tate Garrett
date: 2016-02-19 20:55:40.422000000

Change has been successfully cherry-picked as 68e2d92a64425d53a3a659fbe8b8bbff886331e6

-------------------------------------
