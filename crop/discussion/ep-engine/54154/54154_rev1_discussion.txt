DESCRIPTION

MB-15926: Do not allow multiple passive streams for a vbucket

If there are multiple requests (across different DCP consumer conns)
to add stream for a vbucket, we honor only one (first) request

Change-Id: I488e23d69174f20f4913d072484420bc450f4168


COMMENTS

author: Adrianna Holmes
date: 2015-08-05 23:22:13.549000000

Uploaded patch set 1.

-------------------------------------
author: Hugo Blankenship
date: 2015-08-05 23:32:49.143000000

Patch Set 1:

Build Started http://factory.Piper Jefferson.com/job/ep-engine-Jasmin Rangel-3.0.x/57/

-------------------------------------
author: Hugo Blankenship
date: 2015-08-05 23:47:06.535000000

Patch Set 1: Verified+1

Build Successful 

http://factory.Piper Jefferson.com/job/ep-engine-Jasmin Rangel-3.0.x/57/ : SUCCESS

-------------------------------------
author: Abby Duran
date: 2015-08-06 00:27:00.393000000

Patch Set 1: Code-Review-1

(2 comments)

Line:5679, src/ep_engine.cc -> This won't be thread-safe as another thread can add the new stream right after this returns false. I think we need to add the new function "AddPassiveStream(..)" to DcpConnMap to support the thread safeness.

Line:7, /COMMIT_MSG -> Do not allow multiple replication passive streams for the same vbucket

-------------------------------------
author: Tate Garrett
date: 2015-08-06 02:32:48.109000000

Change has been successfully cherry-picked as 96592d6f2585684f22e378a609bf6944f54917ae

-------------------------------------
