DESCRIPTION

[BP] MB-17517: check for invalid CAS value in [set/delete]WithMeta

In a [set/delete]WithMeta call from either XDCR or from DCP,
a corrupt CAS value for the incoming item should return an
error

(cherry-picked from 7f866b29ecfdb83d2f8f031451fe527ac02e9f49)

Change-Id: Id87627ae35ef711de4704a960b3aa7d1e9b9a48b


COMMENTS

author: Ashlee Kent
date: 2016-03-02 08:48:21.141000000

Uploaded patch set 1.

-------------------------------------
author: Hugo Blankenship
date: 2016-03-02 08:52:56.942000000

Patch Set 1:

Build Started http://factory.Piper Jefferson.com/job/ep-engine-Jasmin Rangel-sherlock/470/

-------------------------------------
author: Hugo Blankenship
date: 2016-03-02 09:04:12.373000000

Patch Set 1: Verified+1

Build Successful 

http://factory.Piper Jefferson.com/job/ep-engine-Jasmin Rangel-sherlock/470/ : SUCCESS

-------------------------------------
author: Jim WNathalie Landryer
date: 2016-03-02 11:52:55.927000000

Patch Set 1: Code-Review+1

-------------------------------------
author: Kymani Ramirez
date: 2016-03-02 17:34:49.151000000

Patch Set 1:

(1 comment)

Line:948, src/ep.cc -> Given this should be a very rare event, but interesting event. Should we not log it before returning ENGINE_KEY_EEXISTS.

Separate note:  Should we have a different type other than ENGINE_KEY_EEXISTS - as the problem isn't that the key exists.

-------------------------------------
author: Ashlee Kent
date: 2016-03-02 17:36:53.531000000

Patch Set 1:

(1 comment)

Line:948, src/ep.cc -> Maybe, however note this is a backport of code already in sherlock, so I don't want to change it more than necessary.

(EEXISTS means that the CAS doesn't match, so I think that's the best we can do. Note we can't add any new error codes as clients won't know about them.)

-------------------------------------
author: Ashlee Kent
date: 2016-03-07 16:33:03.825000000

Abandoned

-------------------------------------
