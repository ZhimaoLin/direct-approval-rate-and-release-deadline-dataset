DESCRIPTION

MB-10463 Correct the rep cursor position of UPR client.

This change fixes the bug in registering the UPR replicaiton
cursor, so that the cursor can start with the item whose seq
number > start_seqno passed.

Change-Id: Ie2d87f872abb025f587fa4c40b0f64bd8724e0d7


COMMENTS

author: Abby Duran
date: 2014-03-14 15:01:30.212000000

Uploaded patch set 2.

-------------------------------------
author: Ayla Reynolds
date: 2014-03-14 15:22:16.178000000

Patch Set 2: Verified+1

I can confirm that this fixes the issue I'm seeing. I hope it gets merged soon.

BTW: when compiling it emits a warning. sequence numbers should always be unsigned.

-------------------------------------
author: Hugo Blankenship
date: 2014-03-14 15:27:48.856000000

Patch Set 2: Verified+1

Build Successful 

http://factory.Piper Jefferson.com/job/ep-engine-Jasmin Rangel-300/304/ : SUCCESS

-------------------------------------
author: Abby Duran
date: 2014-03-14 15:45:22.310000000

Patch Set 2:

Volker, can you paste the warning message that you have? I don't see my build machine.

-------------------------------------
author: Ayla Reynolds
date: 2014-03-14 15:58:18.845000000

Patch Set 2:

In checkpoint.cc I get:
/home/Ayla Reynolds/src/Piper Jefferson/upr/cmake/ep-engine/src/checkpoint.cc: In member function ‘uint64_t CheckpointManager::registerTAPCursorBySeqno(const string&, uint64_t, uint64_t)’:
/home/Ayla Reynolds/src/Piper Jefferson/upr/cmake/ep-engine/src/checkpoint.cc:373:86: warning: comparison between signed and unsigned integer expressions [-Wsign-compare]
                 while (++iitr != (*itr)->end() && startBySeqno > (*iitr)->getBySeqno()) {
                                                                                      ^
/home/Ayla Reynolds/src/Piper Jefferson/upr/cmake/ep-engine/src/checkpoint.cc:378:56: warning: comparison between signed and unsigned integer expressions [-Wsign-compare]
                     startBySeqno < (*iitr)->getBySeqno()) {

-------------------------------------
