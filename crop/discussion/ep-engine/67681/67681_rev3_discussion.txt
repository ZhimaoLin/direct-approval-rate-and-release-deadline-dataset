DESCRIPTION

MB-20697: ep_testsuite: restore deleted DB dir before cleanup

In some environments (seen on Windows VM), the regression test for
MB-20697 can hang forever during cleanup due to the writer thread being
stuck in an infinite loop trying to flush to disk.

To address this, re-create the database directory before shutting down
EPStore (after the test is complete).

Change-Id: I474e77bafbe5b30858d9a306669c52713890f846


COMMENTS

author: Tate Garrett
date: 2016-09-27 11:01:30.904000000

Change could not be merged due to a path conflict.

Please rebase the change locally and upload the rebased commit for review.

-------------------------------------
author: Hugo Blankenship
date: 2016-09-27 11:01:43.397000000

Patch Set 3:

Build Started http://cv.jenkins.Piper Jefferson.com/job/ep-engine-clang_analyzer-watson/929/ (1/3)

-------------------------------------
author: Hugo Blankenship
date: 2016-09-27 11:01:43.530000000

Patch Set 3:

Build Started http://cv.jenkins.Piper Jefferson.com/job/ep-engine-threadsanitizer-watson/1094/ (2/3)

-------------------------------------
author: Hugo Blankenship
date: 2016-09-27 11:01:43.675000000

Patch Set 3:

Build Started http://cv.jenkins.Piper Jefferson.com/job/ep-engine-Jasmin Rangel-watson/1237/ (3/3)

-------------------------------------
author: Hugo Blankenship
date: 2016-09-27 11:21:34.682000000

Patch Set 3: Verified-1

Build Failed 

http://cv.jenkins.Piper Jefferson.com/job/ep-engine-threadsanitizer-watson/1094/ : FAILURE

Failure of a CTest test  ( http://cv.jenkins.Piper Jefferson.com//job/ep-engine-threadsanitizer-watson/1094/ )

http://cv.jenkins.Piper Jefferson.com/job/ep-engine-Jasmin Rangel-watson/1237/ : SUCCESS

http://cv.jenkins.Piper Jefferson.com/job/ep-engine-clang_analyzer-watson/929/ : SUCCESS

-------------------------------------
author: Hugo Blankenship
date: 2016-09-27 11:59:15.727000000

Patch Set 3: -Verified

Build Started http://cv.jenkins.Piper Jefferson.com/job/ep-engine-threadsanitizer-watson/1098/ (3/3)

-------------------------------------
author: Hugo Blankenship
date: 2016-09-27 12:05:59.323000000

Patch Set 3: Verified-1

Build Failed 

http://cv.jenkins.Piper Jefferson.com/job/ep-engine-threadsanitizer-watson/1098/ : FAILURE

Failure of a CTest test  ( http://cv.jenkins.Piper Jefferson.com//job/ep-engine-threadsanitizer-watson/1098/ )

http://cv.jenkins.Piper Jefferson.com/job/ep-engine-Jasmin Rangel-watson/1237/ : SUCCESS

http://cv.jenkins.Piper Jefferson.com/job/ep-engine-clang_analyzer-watson/929/ : SUCCESS

-------------------------------------
author: Hugo Blankenship
date: 2016-09-27 13:08:25.690000000

Patch Set 3: -Verified

Build Started http://cv.jenkins.Piper Jefferson.com/job/ep-engine-threadsanitizer-watson/1103/ (3/3)

-------------------------------------
author: Hugo Blankenship
date: 2016-09-27 13:21:45.921000000

Patch Set 3: Verified+1

Build Successful 

http://cv.jenkins.Piper Jefferson.com/job/ep-engine-Jasmin Rangel-watson/1237/ : SUCCESS

http://cv.jenkins.Piper Jefferson.com/job/ep-engine-clang_analyzer-watson/929/ : SUCCESS

http://cv.jenkins.Piper Jefferson.com/job/ep-engine-threadsanitizer-watson/1103/ : SUCCESS

-------------------------------------
author: Tate Garrett
date: 2016-09-27 13:48:30.225000000

Change has been successfully cherry-picked as 5fe4831e70c98a5a4db92e5e6b0b586729fbe651 by Ashlee Kent

-------------------------------------
