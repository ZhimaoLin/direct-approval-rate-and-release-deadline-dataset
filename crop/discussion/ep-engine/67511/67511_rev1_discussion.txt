DESCRIPTION

MB-20611: Fair scheduling when # of tasks >> # of threads

With large tasks and small snooze times, sorting by taskId
can result in lower taskId tasks getting 'lucky' and running
more frequently in an unfair manner.
1) Update current time of executor threads after task finishes
to ensure that sleeping tasks get woken correctly
2) Use a monotonically increasing "queue entry time" to
distinguish among tasks of the same priority in FIFO

Change-Id: If7f85573d491da26e95d0925c68e9947ac5920ad


COMMENTS

author: Ellie Kidd
date: 2016-09-08 18:59:02.550000000

Uploaded patch set 1.

-------------------------------------
author: Hugo Blankenship
date: 2016-09-08 18:59:08.167000000

Patch Set 1:

Build Started http://cv.jenkins.Piper Jefferson.com/job/ep-engine-Jasmin Rangel-master/1296/ (1/4)

-------------------------------------
author: Hugo Blankenship
date: 2016-09-08 19:00:57.989000000

Patch Set 1:

Build Started http://cv.jenkins.Piper Jefferson.com/job/ep-engine-threadsanitizer-master/1208/ (2/4)

-------------------------------------
author: Hugo Blankenship
date: 2016-09-08 19:01:00.909000000

Patch Set 1:

Build Started http://cv.jenkins.Piper Jefferson.com/job/ep-engine-addresssanitizer-master/104/ (3/4)

-------------------------------------
author: Ellie Kidd
date: 2016-09-08 19:02:29.582000000

Patch Set 1: Code-Review-1

Working on unit test as suggested by DaveR.

-------------------------------------
author: Hugo Blankenship
date: 2016-09-08 19:32:10.614000000

Patch Set 1:

Build Started http://cv.jenkins.Piper Jefferson.com/job/ep-engine-clang_analyzer-master/1024/ (4/4)

-------------------------------------
author: Hugo Blankenship
date: 2016-09-08 19:37:23.739000000

Patch Set 1: Verified-1

Build Failed 

http://cv.jenkins.Piper Jefferson.com/job/ep-engine-threadsanitizer-master/1208/ : FAILURE

Timeout of a CTest test 32/32 Test #24: ep-engine_dcp_tests ...................} ( http://cv.jenkins.Piper Jefferson.com//job/ep-engine-threadsanitizer-master/1208/ )

http://cv.jenkins.Piper Jefferson.com/job/ep-engine-addresssanitizer-master/104/ : FAILURE

Failure of a CTest test  ( http://cv.jenkins.Piper Jefferson.com//job/ep-engine-addresssanitizer-master/104/ )

http://cv.jenkins.Piper Jefferson.com/job/ep-engine-clang_analyzer-master/1024/ : SUCCESS

http://cv.jenkins.Piper Jefferson.com/job/ep-engine-Jasmin Rangel-master/1296/ : SUCCESS

-------------------------------------
author: Jim WNathalie Landryer
date: 2016-09-08 20:21:22.852000000

Patch Set 1: Code-Review-2

(1 comment)

Line:92, src/taskqueue.h -> It would be cleaner to integrate this into a custome readyQueue. We can subclass the priority_queue into our own class and override push so that it performs the setting of the enqueue value.

-------------------------------------
