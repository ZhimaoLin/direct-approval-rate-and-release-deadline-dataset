DESCRIPTION

DfsObjectDatabase: Expose PackList and move markDirty there

What's invalidated when an object database is "dirty" is not the whole
database, but rather a specific list of packs. If there is a race
between getting the pack list and setting the volatile dirty flag
where the packs are rescanned, we don't need to mark the new pack list
as dirty.

This is a fine point that only really applies if the decision of
whether or not to mark dirty actually requires introspecting the pack
list (say, its timestamps). The general operation of "take whatever
is the current pack list and mark it dirty" may still be inherently
racy, but the cost is not so high.

Change-Id: I159e9154bd8b2d348b4e383627a503e85462dcc6


COMMENTS

author: Santos Moore
date: 2016-07-14 20:13:51.000000000

Uploaded patch set 4.

-------------------------------------
author: Brenden Conley
date: 2016-07-14 20:13:57.000000000

Patch Set 4:

Build Started https://hudson.eclipse.org/jgit/job/jgit.gerrit/8705/

-------------------------------------
author: Santos Moore
date: 2016-07-14 20:14:10.000000000

Patch Set 4: -Code-Review

PTAL. I can squash this into the previous change if you prefer.

-------------------------------------
author: Brenden Conley
date: 2016-07-14 20:26:00.000000000

Patch Set 4: Verified+1

Build Successful 

https://hudson.eclipse.org/jgit/job/jgit.gerrit/8705/ : SUCCESS

-------------------------------------
author: Yoselin Hanna
date: 2016-07-18 19:55:06.000000000

Patch Set 4: Code-Review-1

(1 comment)

Line:511, org.eclipse.jgit/src/org/eclipse/jgit/internal/storage/dfs/DfsObjDatabase.java -> Formatting is off

-------------------------------------
author: Santos Moore
date: 2016-07-18 19:57:46.000000000

Patch Set 4:

(1 comment)

Line:511, org.eclipse.jgit/src/org/eclipse/jgit/internal/storage/dfs/DfsObjDatabase.java -> Done

-------------------------------------
author: Gerrit Code Review
date: 2016-07-19 14:51:52.000000000

Change has been successfully merged into the git repository by Santos Moore

-------------------------------------
