DESCRIPTION

Fix checkout of pathes

The checkout command was producing a inconsistent state of the index
which even confuses native git. The content sha1 of the touched index
entries was updated, but the length and the filemode was not updated.
Later in coding the index entries got automatically corrected (throught
Dircache.checkoutEntry()) but the correction was after persisting the
index to disk. So, the correction was lost and we ended up with a index
where length and sha1 doesn't fit together.
A similar problem is fixed with "lastModified" of DircacheEntry. When
checking out a path without specifying an explicit commit (you want to
checkout what's in the index) the index was not updated regarding
lastModified. Readers of the index will think the checked-out
file is dirty because the file has a younger lastmodified then what's
in the index.

Change-Id: Ifc6d806fbf96f53c94d9ded0befcc932d943aa04
Signed-off-by: Zachary Orozco xxx@xxx.xxx
Signed-off-by: Marlie Beasley xxx@xxx.xxx


COMMENTS

author: Brenden Conley
date: 2011-09-27 11:38:35.000000000

Patch Set 1:

Build Started https://hudson.eclipse.org/sandbox/job/jgit.gerrit/826/ 

-------------------------------------
author: Brenden Conley
date: 2011-09-27 11:41:51.000000000

Patch Set 1: Build Successful

Build Successful 
 
https://hudson.eclipse.org/sandbox/job/jgit.gerrit/826/ : SUCCESS

-------------------------------------
author: Douglas Trujillo
date: 2011-09-27 14:58:42.000000000

Patch Set 1: (6 inline comments)



Line:254, org.eclipse.jgit/src/org/eclipse/jgit/api/CheckoutCommand.java -> style nit: no braces around single line blocks

Line:257, org.eclipse.jgit/src/org/eclipse/jgit/api/CheckoutCommand.java -> style nit: no braces here

Line:9, /COMMIT_MSG -> typo: s/a/an/

Line:12, /COMMIT_MSG -> typo: s/throught/through/

Line:14, /COMMIT_MSG -> typo: s/a/an/

Line:15, /COMMIT_MSG -> typo: s/doesn't/don't/

-------------------------------------
author: Juliet Cantu
date: 2011-09-27 15:25:58.000000000

Patch Set 1: (1 inline comment)



Line:7, /COMMIT_MSG -> spelling: paths.

This subject is very unclear regarding the problem.
Suggestion: Fix status in index entries after checkout of paths

-------------------------------------
author: Jaidyn Nichols
date: 2011-09-27 15:29:28.000000000

Patch Set 1: (2 inline comments)



Line:253, org.eclipse.jgit/src/org/eclipse/jgit/api/CheckoutCommand.java -> style nit: parentheses not needed on right side

Line:275, org.eclipse.jgit/src/org/eclipse/jgit/api/CheckoutCommand.java -> Would JGitInternalException be better to throw here instead of RuntimeException?

-------------------------------------
author: Jaidyn Nichols
date: 2011-09-27 16:10:17.000000000

Patch Set 1:

Could this change be a fix for https://bugs.eclipse.org/bugs/show_bug.cgi?id=355205 ?

-------------------------------------
author: Zachary Orozco
date: 2011-09-27 16:56:04.000000000

Patch Set 1: (8 inline comments)

Kevin, yes I think that this problem is related to bug 355205. I commentet on that bug!

Line:253, org.eclipse.jgit/src/org/eclipse/jgit/api/CheckoutCommand.java -> Done

Line:254, org.eclipse.jgit/src/org/eclipse/jgit/api/CheckoutCommand.java -> Done

Line:257, org.eclipse.jgit/src/org/eclipse/jgit/api/CheckoutCommand.java -> Done

Line:275, org.eclipse.jgit/src/org/eclipse/jgit/api/CheckoutCommand.java -> Done

Line:7, /COMMIT_MSG -> Done

Line:9, /COMMIT_MSG -> Done

Line:12, /COMMIT_MSG -> Done

Line:14, /COMMIT_MSG -> Done

-------------------------------------
