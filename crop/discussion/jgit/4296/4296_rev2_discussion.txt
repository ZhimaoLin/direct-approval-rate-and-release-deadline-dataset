DESCRIPTION

Fix status in index entries after checkout of paths

The checkout command was producing an inconsistent state of the index
which even confuses native git. The content sha1 of the touched index
entries was updated, but the length and the filemode was not updated.
Later in coding the index entries got automatically corrected (through
Dircache.checkoutEntry()) but the correction was after persisting the
index to disk. So, the correction was lost and we ended up with an index
where length and sha1 don't fit together.
A similar problem is fixed with "lastModified" of DircacheEntry. When
checking out a path without specifying an explicit commit (you want to
checkout what's in the index) the index was not updated regarding
lastModified. Readers of the index will think the checked-out
file is dirty because the file has a younger lastmodified then what's
in the index.

Change-Id: Ifc6d806fbf96f53c94d9ded0befcc932d943aa04
Signed-off-by: Zachary Orozco xxx@xxx.xxx
Signed-off-by: Marlie Beasley xxx@xxx.xxx
Bug: 355205


COMMENTS

author: Zachary Orozco
date: 2011-09-27 16:54:27.000000000

Uploaded patch set 2.

-------------------------------------
author: Brenden Conley
date: 2011-09-27 16:54:30.000000000

Patch Set 2:

Build Started https://hudson.eclipse.org/sandbox/job/jgit.gerrit/830/ 

-------------------------------------
author: Brenden Conley
date: 2011-09-27 16:58:17.000000000

Patch Set 2: Build Successful

Build Successful 
 
https://hudson.eclipse.org/sandbox/job/jgit.gerrit/830/ : SUCCESS

-------------------------------------
author: Juliet Cantu
date: 2011-09-27 18:44:14.000000000

Patch Set 2:

Can you update the unit tests too?

-------------------------------------
