DESCRIPTION

Avoid reading huge files into memory

When reading refs, avoid reading huge files that were put there
accidentally, but still read the top of e.g. FETCH_HEAD, which
may be longer than our limit. We're only interested in the first line
anyway.

Change-Id: I969f3931
Signed-off-by: Mallory Peters xxx@xxx.xxx

COMMENTS

author: Brenden Conley
date: 2011-03-16 14:33:20.000000000

Patch Set 1:

Build Started https://hudson.eclipse.org/sandbox/job/jgit.gerrit/100/ 

-------------------------------------
author: Brenden Conley
date: 2011-03-16 14:35:24.000000000

Patch Set 1: Build Failed

Build Failed 
 
https://hudson.eclipse.org/sandbox/job/jgit.gerrit/100/ : FAILURE

-------------------------------------
author: Malia Sampson
date: 2011-03-16 15:15:51.000000000

Patch Set 1:

The test build came with a lot of errors...

Results :

Tests in error: 
  testPullConfigRenameLocalBranch(org.eclipse.jgit.api.BranchCommandTest)
  testRenameLocalBranch(org.eclipse.jgit.api.BranchCommandTest)
  testRenameRemoteTrackingBranch(org.eclipse.jgit.api.BranchCommandTest)
  testGetRefs_IgnoresGarbageRef2(org.eclipse.jgit.storage.file.RefDirectoryTest)
  testRenameBranchNoPreviousLog(org.eclipse.jgit.storage.file.RefUpdateTest)
  testRenameBranchHasPreviousLog(org.eclipse.jgit.storage.file.RefUpdateTest)
  testRenameCurrentBranch(org.eclipse.jgit.storage.file.RefUpdateTest)
  testRenameBranchAlsoInPack(org.eclipse.jgit.storage.file.RefUpdateTest)
  testRenameBranchCannotLockAFileHEADisFromLockHEAD(org.eclipse.jgit.storage.file.RefUpdateTest)
  testRenameBranchCannotLockAFileHEADisFromLockFrom(org.eclipse.jgit.storage.file.RefUpdateTest)
  testRenameBranchCannotLockAFileHEADisFromLockTo(org.eclipse.jgit.storage.file.RefUpdateTest)
  testRenameBranchCannotLockAFileHEADisToLockFrom(org.eclipse.jgit.storage.file.RefUpdateTest)
  testRenameBranchCannotLockAFileHEADisToLockTo(org.eclipse.jgit.storage.file.RefUpdateTest)
  testRenameBranchCannotLockAFileHEADisOtherLockFrom(org.eclipse.jgit.storage.file.RefUpdateTest)
  testRenameBranchCannotLockAFileHEADisOtherLockTo(org.eclipse.jgit.storage.file.RefUpdateTest)
  testRenameRefNameColission1avoided(org.eclipse.jgit.storage.file.RefUpdateTest)
  testRenameRefNameColission2avoided(org.eclipse.jgit.storage.file.RefUpdateTest)

-------------------------------------
author: Mallory Peters
date: 2011-03-16 15:18:13.000000000

Patch Set 1:

I know, I already have a fix for that, I'm just struggling how to push the fix into gerrit (tells me to squash previous commits).

-------------------------------------
author: Douglas Trujillo
date: 2011-03-16 15:49:14.000000000

Patch Set 1:

this error message from gerrit is explained here :
https://android.git.kernel.org/?p=tools/gerrit.git;a=blob;f=Documentation/error-squash-commits-first.txt;h=138ad98951d9b44f06cfaa8e1ed846695cdcd73e;hb=HEAD

-------------------------------------
author: Mallory Peters
date: 2011-03-16 16:07:54.000000000

Patch Set 1:

Thanks. Looks like I'm quite good at hitting all those traps, although I'm afraid there are some more.

I actually wanted to create a new patch set for http://egit.eclipse.org/r/#change,2721
I'll read up on gerrit before I mess things up further.

-------------------------------------
author: Malia Sampson
date: 2011-03-16 16:08:46.000000000

Patch Set 1:

Use the right Change-Id: then :)

Change-Id: I969f39315216141f10d645d58120141b77b3b3cf

-------------------------------------
author: Mallory Peters
date: 2011-03-16 16:17:02.000000000

Patch Set 1:

That's what I did actually, but when I amended my previous commit it ended up as 
Change-Id: Change-Id: I969f39315216141f10d645d58120141b77b3b3cf

So close to getting it right ;-)

-------------------------------------
author: Yoselin Hanna
date: 2011-04-01 19:28:57.000000000

Patch Set 1: Abandoned

Moved to another change.

-------------------------------------
