DESCRIPTION

RefDirectory: Use FileSnapshot for packed-refs

Instead of tracking the length and modification time by hand, rely
on FileSnapshot to tell RefDirectory when the $GIT_DIR/packed-refs
file has been changed or should be re-read from disk.

Change-Id: I067d268dfdca1d39c72dfa536b34e6a239117cc3
Signed-off-by: Jaycee Hickman xxx@xxx.xxx


COMMENTS

author: Yoselin Hanna
date: 2010-12-15 23:52:20.000000000

Uploaded patch set 3.

-------------------------------------
author: Malia Sampson
date: 2010-12-20 17:42:26.000000000

Patch Set 3: Looks good to me, approved; IP review completed

Looks good.

-------------------------------------
author: Brenden Conley
date: 2010-12-20 20:42:13.000000000

Patch Set 3:

Build Started https://hudson.eclipse.org/hudson/job/jgit.gerrit/2/ 

-------------------------------------
author: Brenden Conley
date: 2010-12-20 21:32:29.000000000

Patch Set 3:

Build Started https://hudson.eclipse.org/hudson/job/jgit.gerrit/3/ 

-------------------------------------
author: Juliet Cantu
date: 2010-12-20 21:45:00.000000000

Patch Set 3: (1 inline comment)



Line:1005, org.eclipse.jgit.test/tst/org/eclipse/jgit/storage/file/RefDirectoryTest.java -> Did I lure you into this, with my comment in FileSnapshot?

The test class inherits from a class that configures the MockSystemReader, whose concept of currentTime is not related to File.lastModified as System.getCurrentTime

-------------------------------------
author: Brenden Conley
date: 2010-12-20 22:55:14.000000000

Patch Set 3:

Build Started https://hudson.eclipse.org/hudson/job/jgit.gerrit/5/ 

-------------------------------------
author: Yoselin Hanna
date: 2010-12-21 00:12:45.000000000

Patch Set 3: I would prefer that you didn't submit this

(1 inline comment)



Line:1005, org.eclipse.jgit.test/tst/org/eclipse/jgit/storage/file/RefDirectoryTest.java -> Yea, I wasn't thinking and just dropped it into the test.  :-(

-------------------------------------
author: Brenden Conley
date: 2010-12-21 11:03:05.000000000

Patch Set 3:

Build Started https://hudson.eclipse.org/hudson/job/jgit.gerrit/8/ 

-------------------------------------
author: Brenden Conley
date: 2010-12-21 11:04:46.000000000

Patch Set 3:

Build Started https://hudson.eclipse.org/hudson/job/jgit.gerrit/9/ 

-------------------------------------
author: Brenden Conley
date: 2010-12-21 11:22:03.000000000

Patch Set 3:

Build Started https://hudson.eclipse.org/hudson/job/jgit.gerrit/10/ 

-------------------------------------
author: Brenden Conley
date: 2010-12-21 22:08:28.000000000

Patch Set 3:

Build Started https://hudson.eclipse.org/hudson/job/jgit.gerrit/12/ 

-------------------------------------
author: Brenden Conley
date: 2010-12-21 22:58:52.000000000

Patch Set 3:

Build Started https://hudson.eclipse.org/hudson/job/jgit.gerrit/13/ 

-------------------------------------
author: Zachary Orozco
date: 2011-03-22 22:55:55.000000000

Patch Set 3: (1 inline comment)



Line:1005, org.eclipse.jgit.test/tst/org/eclipse/jgit/storage/file/RefDirectoryTest.java -> shouldn't you use a simple System.currrentTimeMillis() instead of the SystemReader?

-------------------------------------
author: Yoselin Hanna
date: 2011-03-27 21:00:01.000000000

Patch Set 3: (1 inline comment)



Line:1005, org.eclipse.jgit.test/tst/org/eclipse/jgit/storage/file/RefDirectoryTest.java -> Yes, I think that is why I have a -1 on this patch. Robin's remark above is correct we should use java.lang.System here and not SystemReader.

-------------------------------------
author: Brenden Conley
date: 2011-03-31 22:55:47.000000000

Patch Set 3:

Build Started https://hudson.eclipse.org/sandbox/job/jgit.gerrit/209/ 

-------------------------------------
author: Brenden Conley
date: 2011-03-31 22:58:37.000000000

Patch Set 3: Build Successful

Build Successful 
 
https://hudson.eclipse.org/sandbox/job/jgit.gerrit/209/ : SUCCESS

-------------------------------------
