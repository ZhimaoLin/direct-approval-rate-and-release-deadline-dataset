DESCRIPTION

"Bare" Repository should not return working directory.

If a repository is "bare", it currently still returns a working directory.
This conflicts with the specification of "bare"-ness.

Bug: 311902

Change-Id: Ib54b31ddc80b9032e6e7bf013948bb83e12cfd88
Signed-off-by: Willow Cantrell xxx@xxx.xxx

COMMENTS

author: Willow Cantrell
date: 2010-06-15 15:33:24.000000000

Uploaded patch set 6.

-------------------------------------
author: Willow Cantrell
date: 2010-06-15 15:39:03.000000000

Patch Set 6: No score

I wonder about setWorkDir()... Not sure if the configuration should be checked there...

-------------------------------------
author: Yoselin Hanna
date: 2010-06-15 16:07:44.000000000

Patch Set 6: No score; No score

Nah, if setWorkDir(File) is called, just set workDir property, and then we'll assume non-bare repository.  Which is what the caller told us.

-------------------------------------
author: Yoselin Hanna
date: 2010-06-15 16:13:25.000000000

Patch Set 6: I would prefer that you didn't submit this

Logic looks right now.

Before we submit I think we need:

* Unit tests for the branches in the constructor.
* Consistency in the type of exception thrown when bare.
* Allow setWorkDir on a bare repository, making it non-bare.

Line:1156, org.eclipse.jgit/src/org/eclipse/jgit/lib/Repository.java -> Why do we throw IOException here and IllegalStateException in getIndexFile()?

Can we at least throw the same type consistently?

Line:1342, org.eclipse.jgit/src/org/eclipse/jgit/lib/Repository.java -> Nak.  I'd just allow the call.  Its not reasonable for an application to setup a Repository from a bare Git, and then later point it at a working directory.

-------------------------------------
author: Willow Cantrell
date: 2010-06-15 17:51:03.000000000

MISMATCHED INLINE COMMENT
Line:1156, org.eclipse.jgit/src/org/eclipse/jgit/lib/Repository.java -> Done

-------------------------------------
author: Willow Cantrell
date: 2010-06-15 17:51:03.000000000

MISMATCHED INLINE COMMENT
Line:1342, org.eclipse.jgit/src/org/eclipse/jgit/lib/Repository.java -> Done

-------------------------------------
