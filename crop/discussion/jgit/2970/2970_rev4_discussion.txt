DESCRIPTION

Add NotesCommand to the JGit API

Bug: 334765
Change-Id: Ie0fb79671e7a741eb85651f507b8ade930bfcc20
Signed-off-by: Malia Sampson xxx@xxx.xxx


COMMENTS

author: Malia Sampson
date: 2011-04-06 19:44:26.000000000

Uploaded patch set 4.

-------------------------------------
author: Brenden Conley
date: 2011-04-06 19:44:29.000000000

Patch Set 4:

Build Started https://hudson.eclipse.org/sandbox/job/jgit.gerrit/242/ 

-------------------------------------
author: Brenden Conley
date: 2011-04-06 19:46:56.000000000

Patch Set 4: Build Successful

Build Successful 
 
https://hudson.eclipse.org/sandbox/job/jgit.gerrit/242/ : SUCCESS

-------------------------------------
author: Yoselin Hanna
date: 2011-04-11 00:49:41.000000000

Patch Set 4: I would prefer that you didn't submit this

(22 inline comments)



Line:68, org.eclipse.jgit/src/org/eclipse/jgit/api/AddNotesCommand.java -> This is called AddNotes, but it only adds one note. Should we support multiple notes at once in a batch, or should we rename the class to AddNote?

Line:101, org.eclipse.jgit/src/org/eclipse/jgit/api/AddNotesCommand.java -> This early flush is unnecessary, see commitNoteMap().

Line:104, org.eclipse.jgit/src/org/eclipse/jgit/api/AddNotesCommand.java -> The local variable "note" is unnecessary.

Line:128, org.eclipse.jgit/src/org/eclipse/jgit/api/AddNotesCommand.java -> Please document somewhere that if the object already has a note, the existing note is *replaced*.

Line:145, org.eclipse.jgit/src/org/eclipse/jgit/api/AddNotesCommand.java -> Use builder.setCommitter(builder.getAuthor()) to ensure the timestamp is identical.

Line:149, org.eclipse.jgit/src/org/eclipse/jgit/api/AddNotesCommand.java -> You need an inserter.flush() after here.

Line:150, org.eclipse.jgit/src/org/eclipse/jgit/api/AddNotesCommand.java -> Missing:

  if (notesCommit != null)
    refUpdate.setExpectedOldObjectId(notesCommit);
  else
    refUpdate.setExpectedOldObjectId(ObjectId.zeroId());

Line:152, org.eclipse.jgit/src/org/eclipse/jgit/api/AddNotesCommand.java -> Pass the RevWalk you have in call().

Line:68, org.eclipse.jgit/src/org/eclipse/jgit/api/RemoveNotesCommand.java -> Same remark about single note operation, but plural name.

Line:99, org.eclipse.jgit/src/org/eclipse/jgit/api/RemoveNotesCommand.java -> This flush is unnecessary this early, see commitNoteMap().

Line:102, org.eclipse.jgit/src/org/eclipse/jgit/api/RemoveNotesCommand.java -> The local variable "note" is unnecessary.

Line:114, org.eclipse.jgit/src/org/eclipse/jgit/api/RemoveNotesCommand.java -> Style-nit: Trailing space.

Line:124, org.eclipse.jgit/src/org/eclipse/jgit/api/RemoveNotesCommand.java -> See my comments in AddNotesCommand.commitNoteMap() as the code is identical here.

Line:60, org.eclipse.jgit/src/org/eclipse/jgit/api/ShowNotesCommand.java -> Style-nit: Trailing space.

Line:64, org.eclipse.jgit/src/org/eclipse/jgit/api/ShowNotesCommand.java -> Same remark about single note operation, but plural name.

Line:84, org.eclipse.jgit/src/org/eclipse/jgit/api/ShowNotesCommand.java -> Unnecessary.

Line:86, org.eclipse.jgit/src/org/eclipse/jgit/api/ShowNotesCommand.java -> Unnecessary.

Line:94, org.eclipse.jgit/src/org/eclipse/jgit/api/ShowNotesCommand.java -> The local variable "note" is unnecessary.

Line:99, org.eclipse.jgit/src/org/eclipse/jgit/api/ShowNotesCommand.java -> Unnecessary.

Line:85, org.eclipse.jgit/src/org/eclipse/jgit/api/ListNotesCommand.java -> Unnecessary.

Line:99, org.eclipse.jgit/src/org/eclipse/jgit/api/ListNotesCommand.java -> Unnecessary.

Line:103, org.eclipse.jgit/src/org/eclipse/jgit/api/ListNotesCommand.java -> Unnecessary.

-------------------------------------
author: Malia Sampson
date: 2011-04-11 02:23:44.000000000

Patch Set 4: (8 inline comments)



Line:68, org.eclipse.jgit/src/org/eclipse/jgit/api/AddNotesCommand.java -> I'll rename it to AddNote for now.

Line:101, org.eclipse.jgit/src/org/eclipse/jgit/api/AddNotesCommand.java -> ok

Line:104, org.eclipse.jgit/src/org/eclipse/jgit/api/AddNotesCommand.java -> done

Line:128, org.eclipse.jgit/src/org/eclipse/jgit/api/AddNotesCommand.java -> done

Line:145, org.eclipse.jgit/src/org/eclipse/jgit/api/AddNotesCommand.java -> done.

Line:149, org.eclipse.jgit/src/org/eclipse/jgit/api/AddNotesCommand.java -> done

Line:150, org.eclipse.jgit/src/org/eclipse/jgit/api/AddNotesCommand.java -> done

Line:152, org.eclipse.jgit/src/org/eclipse/jgit/api/AddNotesCommand.java -> done

-------------------------------------
