DESCRIPTION

Add performance tests for MyersDiff

Add some tests which make sure that the diff algorithm really behaves in the
promised O(N*D) manner. This tests compute diffs between multiple big chunks
of data, measure time for computing the diffs and fail if the measured times
are off O(N*D) by more than a factor 10

Signed-off-by: Zachary Orozco xxx@xxx.xxx
Change-Id: I8e1e0be60299472828718371b231f1d8a9dc21a7


COMMENTS

author: Zachary Orozco
date: 2009-10-20 12:05:42.000000000

Uploaded patch set 2.

-------------------------------------
author: Zachary Orozco
date: 2009-10-20 12:07:59.000000000

Patch Set 2: Looks good to me, but someone else must approve; IP review completed

fixed some typos in comments

-------------------------------------
author: Yoselin Hanna
date: 2009-10-31 22:15:51.000000000

Patch Set 2: Looks good to me, but someone else must approve; No score

All style nits.  The only one I'd consider really important is the name of "t" -> "runningTime" inside of PerfData.

-------------------------------------
author: Juliet Cantu
date: 2009-11-01 01:27:17.000000000

Patch Set 2: Do not submit; No score

The tests test80000 and test99999 fails occasionally here.
It's just a little worse than the limit set.

The off-factor for test80000 varies up to 18 here.

One thing to keep in mind when doing performance tests is the limited resolution of System.currentTimeMillis, but
also that it measures elapsed time and not CPU time.

Look here for hints on measuring CPU time.

http://nadeausoftware.com/articles/2008/03/java_tip_how_get_cpu_and_user_time_benchmarking

I tried this, but it seems the tests are too short. Repeating them ten times seemed to work...

-------------------------------------
author: Yoselin Hanna
date: 2010-03-10 05:19:08.000000000

MISMATCHED INLINE COMMENT
Line:66, org.eclipse.jgit.test/tst/org/eclipse/jgit/diff/MyersDiffPerformanceTest.java -> How about renaming this to "runningTime" ?

-------------------------------------
author: Yoselin Hanna
date: 2010-03-10 05:19:08.000000000

MISMATCHED INLINE COMMENT
Line:88, org.eclipse.jgit.test/tst/org/eclipse/jgit/diff/MyersDiffPerformanceTest.java -> Style-nit: We don't put braces around a simple expression like this one, and the one after it.

-------------------------------------
author: Juliet Cantu
date: 2010-03-10 05:19:08.000000000

MISMATCHED INLINE COMMENT
Line:95, org.eclipse.jgit.test/tst/org/eclipse/jgit/diff/MyersDiffPerformanceTest.java -> Please add the checked value as the message string here for quicker diagnosis.

-------------------------------------
author: Yoselin Hanna
date: 2010-03-10 05:19:08.000000000

MISMATCHED INLINE COMMENT
Line:107, org.eclipse.jgit.test/tst/org/eclipse/jgit/diff/MyersDiffPerformanceTest.java -> Please don't println during normal unit tests.

I would suggest making this conditional on a system property, or writing it to a trace file.  Basically, it annoys me to see the Console pop open in Eclipse to show output whenever I run unit tests to verify code changes.

-------------------------------------
author: Yoselin Hanna
date: 2010-03-10 05:19:08.000000000

MISMATCHED INLINE COMMENT
Line:112, org.eclipse.jgit.test/tst/org/eclipse/jgit/diff/MyersDiffPerformanceTest.java -> Since we always say a factor of 10, can we just make this a private static final and not pass it to checkPerfData every time?

-------------------------------------
author: Yoselin Hanna
date: 2010-03-10 05:19:08.000000000

MISMATCHED INLINE COMMENT
Line:146, org.eclipse.jgit.test/tst/org/eclipse/jgit/diff/MyersDiffPerformanceTest.java -> Style-nit: Unnecessary parens

-------------------------------------
author: Yoselin Hanna
date: 2010-03-10 05:19:08.000000000

MISMATCHED INLINE COMMENT
Line:149, org.eclipse.jgit.test/tst/org/eclipse/jgit/diff/MyersDiffPerformanceTest.java -> Style-nit: unnecessary utility method, I would just use new CharArray at its two call sites.

-------------------------------------
author: Yoselin Hanna
date: 2010-03-10 05:19:08.000000000

MISMATCHED INLINE COMMENT
Line:154, org.eclipse.jgit.test/tst/org/eclipse/jgit/diff/MyersDiffPerformanceTest.java -> private final

-------------------------------------
author: Yoselin Hanna
date: 2010-03-10 05:19:08.000000000

MISMATCHED INLINE COMMENT
Line:65, org.eclipse.jgit.test/tst/org/eclipse/jgit/diff/DiffTestDataGenerator.java -> Typo on skipLenght

-------------------------------------
author: Yoselin Hanna
date: 2010-03-10 05:19:08.000000000

MISMATCHED INLINE COMMENT
Line:79, org.eclipse.jgit.test/tst/org/eclipse/jgit/diff/DiffTestDataGenerator.java -> Probably could pass len here to allocate the underlying char[] at the correct size.

-------------------------------------
author: Yoselin Hanna
date: 2010-03-10 05:19:08.000000000

MISMATCHED INLINE COMMENT
Line:89, org.eclipse.jgit.test/tst/org/eclipse/jgit/diff/DiffTestDataGenerator.java -> Style-nit: Unnecessary parens around expression.

-------------------------------------
