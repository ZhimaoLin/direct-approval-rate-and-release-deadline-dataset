DESCRIPTION

Add TagCommand

A tag command is added to the Git porcelain API. Tests were
also added to stress test the tag command.

Change-Id: Iab282a918eb51b0e9c55f628a3396ff01c9eb9eb
Signed-off-by: Malia Sampson xxx@xxx.xxx


COMMENTS

author: Malia Sampson
date: 2010-08-24 03:22:02.000000000

Uploaded patch set 7.

-------------------------------------
author: Yoselin Hanna
date: 2010-08-25 02:38:12.000000000

Patch Set 7: I would prefer that you didn't submit this

(14 inline comments)



Line:77, org.eclipse.jgit/src/org/eclipse/jgit/api/TagCommand.java -> Use "" instead.  But actually this isn't necessary.  TagBuilder will now correctly accept a null message.

Line:79, org.eclipse.jgit/src/org/eclipse/jgit/api/TagCommand.java -> s/author/tagger/

Line:107, org.eclipse.jgit/src/org/eclipse/jgit/api/TagCommand.java -> Line is too long, please line-wrap it.

Line:127, org.eclipse.jgit/src/org/eclipse/jgit/api/TagCommand.java -> IIRC resolve can return null here, and setObjectId won't check.  We'll later crash hard.  Check the result of resolve() and if its null use the NoHeadException.  At which point you can probably just remove getRef() above and just do the resolve HEAD^{commit}, if that fails for any reason we throw NoHeadException.

Line:129, org.eclipse.jgit/src/org/eclipse/jgit/api/TagCommand.java -> This doesn't compile.  You need to pass a RevObject, or know the object type.  Since the caller only gave you an ObjectId, you may need to open that and get the type off the ObjectLoader.

Line:135, org.eclipse.jgit/src/org/eclipse/jgit/api/TagCommand.java -> inserter.insert(newTag) is a newer short form of this.

Line:136, org.eclipse.jgit/src/org/eclipse/jgit/api/TagCommand.java -> This isn't necessary.  format() and inserter.insert(newTag) do this indirectly.

Line:146, org.eclipse.jgit/src/org/eclipse/jgit/api/TagCommand.java -> Pass in revWalk here to update() so we can reuse the revision pool you already have.

Line:193, org.eclipse.jgit/src/org/eclipse/jgit/api/TagCommand.java -> if (signed) is enough.  We try not to compare boolean variables to boolean constants.

Line:218, org.eclipse.jgit/src/org/eclipse/jgit/api/TagCommand.java -> No getters for author, objectId, forceUpdate, or signed.  Should we do getters for everything?  Or nothing at all?  CommitCommand tends to do getters for each field, though its missing for setAll().

Line:235, org.eclipse.jgit/src/org/eclipse/jgit/api/TagCommand.java -> s/parameter -a/parameter -s/

Line:245, org.eclipse.jgit/src/org/eclipse/jgit/api/TagCommand.java -> Extra blank line.

Line:254, org.eclipse.jgit/src/org/eclipse/jgit/api/TagCommand.java -> s/Author/Tagger/

Line:91, org.eclipse.jgit.test/tst/org/eclipse/jgit/api/TagCommandTest.java -> Insanely long lines.  Our Eclipse code style formatter knows the line length.  Please apply it to this file.  I know you aren't coding for JGit in NetBeans... :-)

-------------------------------------
author: Gerrit Code Review
date: 2010-08-26 21:24:49.000000000

Your change could not be merged due to a path conflict.

Please merge (or rebase) the change locally and upload the resolution for review.

-------------------------------------
