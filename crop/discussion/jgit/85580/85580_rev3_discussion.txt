DESCRIPTION

Fix merge-base calculation

Fix JGits merge-base calculation in case of inconsistent commit times.
JGit was potentially failing to compute correct merge-bases when the
commit times where inconsistent (a parent commit was younger than a
child commit). The code in MergeBaseGenerator was aware of the fact that
sometimes the discovery of a merge base x can occur after the parents of
x have been seen (see comment in #carryOntoOne()). But in the light of
inconsistent commit times it was possible that these parents of a
merge-base have already been returned as a merge-base.

This commit fixes the bug by buffering all commits generated by
MergeBaseGenerator. It is expected that this buffer will be small because
the number of merge-bases will be small. Additionally a new flag is used
to mark the ancestors of merge-bases. This together allows to filter out
the unwanted commits.

Bug: 507584
Change-Id: I9cc140b784c3231b972bd2c3de61a789365237ab


COMMENTS

author: Zachary Orozco
date: 2016-11-24 13:26:02.000000000

Uploaded patch set 3.

-------------------------------------
author: Brenden Conley
date: 2016-11-24 13:26:08.000000000

Patch Set 3:

Build Started https://hudson.eclipse.org/jgit/job/jgit.gerrit/9459/

-------------------------------------
author: Brenden Conley
date: 2016-11-24 13:35:32.000000000

Patch Set 3: Verified+1

Build Successful 

https://hudson.eclipse.org/jgit/job/jgit.gerrit/9459/ : SUCCESS

-------------------------------------
author: Bryanna Douglas
date: 2016-11-24 14:50:03.000000000

Patch Set 3:

(1 comment)

Line:89, org.eclipse.jgit/src/org/eclipse/jgit/revwalk/MergeBaseGenerator.java -> mini-typo - Anchestor -> Ancestor

-------------------------------------
author: Douglas Trujillo
date: 2016-11-24 15:31:24.000000000

Patch Set 3:

(5 comments)

Line:152, org.eclipse.jgit.test/tst/org/eclipse/jgit/revwalk/RevWalkMergeBaseTest.java -> this link is already given in the commit message

Line:158, org.eclipse.jgit.test/tst/org/eclipse/jgit/revwalk/RevWalkMergeBaseTest.java -> s/he/it/

Line:158, org.eclipse.jgit.test/tst/org/eclipse/jgit/revwalk/RevWalkMergeBaseTest.java -> that,

Line:159, org.eclipse.jgit.test/tst/org/eclipse/jgit/revwalk/RevWalkMergeBaseTest.java -> base,

Line:21, /COMMIT_MSG -> s/together//

-------------------------------------
author: Zachary Orozco
date: 2016-11-24 15:46:12.000000000

Patch Set 3:

(6 comments)

Line:152, org.eclipse.jgit.test/tst/org/eclipse/jgit/revwalk/RevWalkMergeBaseTest.java -> Done

Line:158, org.eclipse.jgit.test/tst/org/eclipse/jgit/revwalk/RevWalkMergeBaseTest.java -> Done

Line:158, org.eclipse.jgit.test/tst/org/eclipse/jgit/revwalk/RevWalkMergeBaseTest.java -> Done

Line:159, org.eclipse.jgit.test/tst/org/eclipse/jgit/revwalk/RevWalkMergeBaseTest.java -> Done

Line:89, org.eclipse.jgit/src/org/eclipse/jgit/revwalk/MergeBaseGenerator.java -> Done

Line:21, /COMMIT_MSG -> Done

-------------------------------------
author: Gerrit Code Review
date: 2016-11-28 12:44:36.000000000

Change has been successfully merged into the git repository by Douglas Trujillo

-------------------------------------
