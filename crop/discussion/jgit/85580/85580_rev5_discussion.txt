DESCRIPTION

Fix merge-base calculation

Fix JGits merge-base calculation in case of inconsistent commit times.
JGit was potentially failing to compute correct merge-bases when the
commit times where inconsistent (a parent commit was younger than a
child commit). The code in MergeBaseGenerator was aware of the fact that
sometimes the discovery of a merge base x can occur after the parents of
x have been seen (see comment in #carryOntoOne()). But in the light of
inconsistent commit times it was possible that these parents of a
merge-base have already been returned as a merge-base.

This commit fixes the bug by buffering all commits generated by
MergeBaseGenerator. It is expected that this buffer will be small
because the number of merge-bases will be small. Additionally a new
flag is used to mark the ancestors of merge-bases. This allows to filter
out the unwanted commits.

Bug: 507584
Change-Id: I9cc140b784c3231b972bd2c3de61a789365237ab


COMMENTS

author: Douglas Trujillo
date: 2016-11-28 10:48:22.000000000

Uploaded patch set 5: Patch Set 4 was rebased.

-------------------------------------
author: Brenden Conley
date: 2016-11-28 10:48:29.000000000

Patch Set 5:

Build Started https://hudson.eclipse.org/jgit/job/jgit.gerrit/9465/

-------------------------------------
author: Douglas Trujillo
date: 2016-11-28 10:49:00.000000000

Patch Set 5: Code-Review+2

-------------------------------------
author: Brenden Conley
date: 2016-11-28 10:56:56.000000000

Patch Set 5: Verified-1

Build Failed 

https://hudson.eclipse.org/jgit/job/jgit.gerrit/9465/ : FAILURE

-------------------------------------
author: Brenden Conley
date: 2016-11-28 12:04:32.000000000

Patch Set 5: -Verified

Build Started https://hudson.eclipse.org/jgit/job/jgit.gerrit/9466/

-------------------------------------
author: Brenden Conley
date: 2016-11-28 12:08:07.000000000

Patch Set 5:

Build Started https://hudson.eclipse.org/jgit/job/jgit.gerrit/9467/

-------------------------------------
author: Brenden Conley
date: 2016-11-28 12:16:31.000000000

Patch Set 5: Verified-1

Build Failed 

https://hudson.eclipse.org/jgit/job/jgit.gerrit/9467/ : FAILURE

-------------------------------------
author: Brenden Conley
date: 2016-11-28 12:23:05.000000000

Patch Set 5: -Verified

Build Started https://hudson.eclipse.org/jgit/job/jgit.gerrit/9468/

-------------------------------------
author: Brenden Conley
date: 2016-11-28 12:30:14.000000000

Patch Set 5: Verified-1

Build Failed 

https://hudson.eclipse.org/jgit/job/jgit.gerrit/9468/ : FAILURE

-------------------------------------
author: Brenden Conley
date: 2016-11-28 12:32:25.000000000

Patch Set 5: -Verified

Build Started https://hudson.eclipse.org/jgit/job/jgit.gerrit/9469/

-------------------------------------
author: Brenden Conley
date: 2016-11-28 12:42:20.000000000

Patch Set 5: Verified+1

Build Successful 

https://hudson.eclipse.org/jgit/job/jgit.gerrit/9469/ : SUCCESS

-------------------------------------
author: Gerrit Code Review
date: 2016-11-28 12:44:36.000000000

Change has been successfully merged into the git repository by Douglas Trujillo

-------------------------------------
