DESCRIPTION

CBQE-1884: add registry clean up

registry of windows VMs is not always cleaned up after uninstallation in silent mode
Added clean up registry after uninstall for windows

Change-Id: I3dd3736ca858fd664cd9a7f097186787d4b4d01c


COMMENTS

author: Hugo Blankenship
date: 2014-01-17 11:15:25.455000000

Patch Set 1:

Build Started http://factory.couchbase.com/job/testrunner-Jasmin Rangel-master/165/

-------------------------------------
author: Hugo Blankenship
date: 2014-01-17 12:08:29.783000000

Patch Set 1: Verified-1

Build Failed 

http://factory.couchbase.com/job/testrunner-Jasmin Rangel-master/165/ : FAILURE

-------------------------------------
author: Alex Mcmahon
date: 2014-01-17 18:47:29.452000000

Patch Set 1:

I don't thinks that's enough to remove "UpgradeCodes".

It may also leave something like "HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Microsoft\Windows\CurrentVersion\Uninstall\InstallShield_{22EF5D40-7518-4248-B932-4536AAB7293E}"

And also bunch of other crap.

I wish we could fix installer itself.

-------------------------------------
author: Trevor Santana
date: 2014-01-20 05:56:27.312000000

Patch Set 1:

I asked Bin what can we remove and he gives me this script. so i think this should work

-------------------------------------
author: Alex Mcmahon
date: 2014-01-20 16:52:17.799000000

Patch Set 1:

OK, good luck with that.

-------------------------------------
author: Alex Mcmahon
date: 2014-01-23 22:12:30.056000000

Patch Set 1:

So far I ended up with following keys:

https://raw2.github.com/Alex Mcmahon/perfrunner/master/scripts/clean_2.5.0.reg

-------------------------------------
