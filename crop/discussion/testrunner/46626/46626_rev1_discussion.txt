DESCRIPTION

CBQE-0: added support to verify xdcr-audit event in xdcrnewbasetests.py

Change-Id: I9eba82646520b6e2ab95228b0a19535b00ba942d


COMMENTS

author: Fisher Vargas
date: 2015-02-10 10:07:47.774000000

Uploaded patch set 1.

-------------------------------------
author: Hugo Blankenship
date: 2015-02-10 10:07:55.252000000

Patch Set 1:

Build Started http://factory.couchbase.com/job/testrunner-Jasmin Rangel-sherlock/4130/

-------------------------------------
author: Fisher Vargas
date: 2015-02-10 10:10:58.643000000

Patch Set 1:

(3 comments)

Line:413, pytests/xdcr/xdcrnewbasetests.py -> defintion of functions are empty. Once interface is finalized by Ritam for AuditMain.py then will pass the parameters.

Line:937, pytests/xdcr/xdcrnewbasetests.py -> Moved the functionality of removing remote_cluster and repilcation from restclient.py to this file, in respective class.

Line:1810, pytests/xdcr/xdcrnewbasetests.py -> I changed function name from set_encryption to modify.

-------------------------------------
author: Fisher Vargas
date: 2015-02-10 10:11:20.913000000

Patch Set 1:

Aruna, Please have a look of the skeleton for audit-test support in base.

-------------------------------------
author: Hugo Blankenship
date: 2015-02-10 10:38:26.576000000

Patch Set 1: Verified-1

Build Failed 

http://factory.couchbase.com/job/testrunner-Jasmin Rangel-sherlock/4130/ : ABORTED

detect lines like:

suite viewmergetests.ViewMergingTests , pass 38 , fail 1 ( http://factory.couchbase.com//job/testrunner-Jasmin Rangel-sherlock/4130/ )

-------------------------------------
author: Angelina Mayer
date: 2015-02-11 00:25:42.146000000

Patch Set 1:

(3 comments)

Line:179, pytests/xdcr/xdcrnewbasetests.py -> Isn't audit, a cluster level setting? If yes, how is it enabled/disabled per cluster? Should there be a rest call to enable it?

Line:413, pytests/xdcr/xdcrnewbasetests.py -> Can you pls review Ritam's code? If you two work together in India time, this can get done by Friday. Feel free to merge this code.

Line:2115, pytests/xdcr/xdcrnewbasetests.py -> Isn't audit a cluster level setting? Do you need a class for it?

-------------------------------------
author: Angelina Mayer
date: 2015-02-11 00:26:36.517000000

Patch Set 1: Code-Review+1

-------------------------------------
author: Angelina Mayer
date: 2015-02-11 00:39:17.373000000

Patch Set 1:

Pls review Ritam's audit code and agree on the interface. That would help you complete this task on time. Thanks.

-------------------------------------
author: Fisher Vargas
date: 2015-02-11 06:48:46.140000000

Patch Set 1:

(3 comments)

Line:179, pytests/xdcr/xdcrnewbasetests.py -> Audit is enabled by default on the cluster. I am changing the variable name to:

class CheckAuditEvent:
    check = False



CheckAuditEvent.check = self._input.param("check-audit-event", 0)

will pass "check-audit-event=1" is test_params if test need to validate the event.

Line:413, pytests/xdcr/xdcrnewbasetests.py -> Sure. But I think Ritam has targetting for Friday to merge the code. Let me check with him again.

Line:2115, pytests/xdcr/xdcrnewbasetests.py -> Yes, By default audit is enable on cluster. To changing it to param name check-audit-event for test. if True then only we will validate the events.

-------------------------------------
author: Tate Garrett
date: 2015-02-12 21:12:45.019000000

The change could not be merged due to a path conflict.

Please rebase the change locally and upload the rebased commit for review.

-------------------------------------
