DESCRIPTION

CBQE:0 Grab cbcollect before cleanup in xdcr tests

Change-Id: I717c01897dc208fbea2366161da0084ea9eb3c91


COMMENTS

author: Angelina Mayer
date: 2014-08-15 00:01:43.584000000

Uploaded patch set 1.

-------------------------------------
author: Hugo Blankenship
date: 2014-08-15 00:01:50.537000000

Patch Set 1:

Build Started http://factory.couchbase.com/job/testrunner-Jasmin Rangel-master/2369/

-------------------------------------
author: Hugo Blankenship
date: 2014-08-15 00:18:00.100000000

Patch Set 1: Verified+1

Build Successful 

http://factory.couchbase.com/job/testrunner-Jasmin Rangel-master/2369/ : SUCCESS

-------------------------------------
author: Esperanza Cherry
date: 2014-08-15 09:55:36.107000000

Patch Set 1: Code-Review-1

(1 comment)

Line:159, pytests/xdcr/xdcrbasetests.py -> Hi Aruna, I have one question:
if we set get-cbcollect-info=False here, does it mean that next tests will use False already?

-------------------------------------
author: Angelina Mayer
date: 2014-08-15 16:32:28.999000000

Patch Set 1:

(1 comment)

Line:159, pytests/xdcr/xdcrbasetests.py -> Hi Andrei, good question but I don't think so because if you see a job execution, test params are passed in the beginning for every test. Every test is a new run of testrunner so the value we change here will hold good only for one run. Makes sense?

-------------------------------------
author: Angelina Mayer
date: 2014-08-18 19:00:55.129000000

Patch Set 1:

Hi Andrei, can you pls re-review this code? Thanks

-------------------------------------
author: Esperanza Cherry
date: 2014-08-19 18:31:25.576000000

Patch Set 1:

(1 comment)

Line:159, pytests/xdcr/xdcrbasetests.py -> hm, I don't think so, https://github.com/couchbase/testrunner/blob/master/testrunner.py#L278 We read params before execution and use then though all the tests but we are able to change them in any place(override global params). but I'm not 100 percent sure.

-------------------------------------
author: Esperanza Cherry
date: 2014-08-19 18:34:39.035000000

Patch Set 1: Code-Review+1

if you need you can check-in and then we could fix it if it's not so

-------------------------------------
author: Angelina Mayer
date: 2014-08-19 19:28:09.434000000

Patch Set 1:

[8/19/14 11:34:12 AM] Angelina Mayerperumal: yeah, it's best to try when we both are not sure
[8/19/14 11:41:11 AM] Angelina Mayerperumal: actually you are correct, I see ./testrunner.py for every test which means main will have to executed for every test but if I see a job execution, I can see "Global Test input params" printed only once
[8/19/14 11:41:31 AM] Esperanza Cherry: right
[8/19/14 11:42:10 AM] Angelina Mayerperumal: let me try testing this before checking in
[8/19/14 12:06:53 PM] Angelina Mayerperumal: no wonder, we are printing ./testrunner
[8/19/14 12:06:53 PM] Angelina Mayerperumal: print "\n.{3}testrunner -i {0} {1} -t {2}\n"\
              .format(arg_i or "", arg_p or "", name, os.sep)
[8/19/14 12:24:11 PM] Angelina Mayerperumal: https://friendpaste.com/3O0qIwJU1p1dT1JdRvLl6b
[8/19/14 12:24:14 PM] Angelina Mayerperumal: it works because
[8/19/14 12:25:01 PM] Angelina Mayerperumal: https://github.com/couchbase/testrunner/blob/master/testrunner.py#L325-331
[8/19/14 12:25:35 PM] Angelina Mayerperumal: we are initializing TestInputSingleton.input.test_params for every test in the lines above

-------------------------------------
author: Esperanza Cherry
date: 2014-08-19 19:31:32.420000000

Patch Set 1: Code-Review+2

-------------------------------------
author: Angelina Mayer
date: 2014-08-19 19:32:49.001000000

Patch Set 1: Verified+1

Diag is getting collected after tear down, will fix that separately. Thanks.

-------------------------------------
author: Tate Garrett
date: 2014-08-19 19:32:49.409000000

The change could not be merged due to a path conflict.

Please rebase the change locally and upload the rebased commit for review.

-------------------------------------
author: Angelina Mayer
date: 2014-08-19 19:32:54.153000000

Patch Set 2: Patch Set 1 was rebased

-------------------------------------
