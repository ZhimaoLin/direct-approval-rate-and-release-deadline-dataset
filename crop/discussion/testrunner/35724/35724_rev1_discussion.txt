DESCRIPTION

CBQE-0: handle "Unexpected server error" when request nodes/self

this happened after the server has been restarted

http://qa.hq.northscale.net/job/centos_x64--03_02--failover_tests_UPR-P0/10/console
[2014-04-15 02:35:36,103] - [rest_client:709] ERROR - http://10.1.3.116:8091/nodes/self error 500 reason: unknown ["Unexpected server error, request logged."]
ERROR

======================================================================
ERROR: test_30s_timeout_stop (autofailovertests.AutoFailoverTests)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "pytests/autofailovertests.py", line 125, in tearDown
    AutoFailoverBaseTest.common_tearDown(self.servers, self)
  File "pytests/autofailovertests.py", line 46, in common_tearDown
    wait_time=AutoFailoverBaseTest.MAX_FAIL_DETECT_TIME * 10, wait_if_warmup=True)
  File "lib/membase/helper/cluster_helper.py", line 76, in wait_for_ns_servers_or_assert
    rest = RestConnection(server)
  File "lib/membase/api/rest_client.py", line 273, in __init__
    if not http_res or http_res["version"][0:2] == "1.":
TypeError: list indices must be integers, not str

Change-Id: Icb30b7c376d6ee6693d48ab05e22c4126d67060e


COMMENTS

author: Esperanza Cherry
date: 2014-04-15 09:55:46.613000000

Uploaded patch set 1.

-------------------------------------
author: Hugo Blankenship
date: 2014-04-15 10:48:02.070000000

Patch Set 1:

Build Started http://factory.couchbase.com/job/testrunner-Jasmin Rangel-master/1066/

-------------------------------------
author: Hugo Blankenship
date: 2014-04-15 11:27:18.784000000

Patch Set 1: Verified-1

Build Failed 

http://factory.couchbase.com/job/testrunner-Jasmin Rangel-master/1066/ : FAILURE

-------------------------------------
author: Esperanza Cherry
date: 2014-05-05 10:14:49.544000000

Patch Set 2: Patch Set 1 was rebased

-------------------------------------
author: Tate Garrett
date: 2014-05-12 07:52:05.836000000

The change could not be merged due to a path conflict.

Please rebase the change locally and upload the rebased commit for review.

-------------------------------------
author: Tate Garrett
date: 2014-05-13 14:52:53.521000000

The change could not be merged due to a path conflict.

Please rebase the change locally and upload the rebased commit for review.

-------------------------------------
